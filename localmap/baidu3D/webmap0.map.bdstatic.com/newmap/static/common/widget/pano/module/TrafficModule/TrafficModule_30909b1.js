define("common:widget/pano/module/TrafficModule/TrafficModule.js",function(e,t,o){var i=e("common:widget/pano/base/ModuleClass.js"),n=e("common:widget/pano/base/util.js"),a=e("common:widget/pano/module/TrafficModule/NavModule/NavModule.js"),r=e("common:widget/pano/module/TrafficModule/BusModule/BusModule.js"),d=e("common:widget/pano/module/TrafficModule/WalkModule/WalkModule.js"),l=e("common:widget/pano/module/TrafficModule/RouteVideoModule/RouteVideoModule.js"),s=e("common:widget/pano/component/TableView/TableView.js"),c=["pano_changed","layout_changed","show_position","hide_position","add_markers","play_routeVideo"];e.loadCss({content:".traffic-header-bar{position:absolute;top:20px;left:103px;font-size:12px;line-height:40px;height:40px;width:280px;padding:0 16px;background-color:#252525;background-color:rgba(37,37,37,.9);filter:alpha(opacity=90);border-radius:2px;color:#C5CBD6}.traffic-header-wapper{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;_margin-top:10px;width:95%}.traffic-header-icon{width:20px;height:20px;background-position:0 0;margin-top:-2px;margin-right:14px;display:inline-block;vertical-align:middle}.traffic-header-text{}.traffic-container{position:relative;height:113px}.traffic-container .tableview-wapper{left:30px}.traffic-image-item{width:198px;height:110px;position:relative;overflow:hidden}.traffic-image-wapper{position:relative;width:194px;border:1px solid #000;left:2px;overflow:hidden}.tableview-li-hover .traffic-image-wapper{border-color:#3AF}.traffic-image{width:196px;height:100px;filter:alpha(opacity=100)}.traffic-image-desc-bg{height:100%;background-color:#000;opacity:.5;filter:alpha(opacity=50)}.traffic-image-desc-wapper{display:none;position:absolute;left:0;top:0;width:100%;height:100px}.traffic-image-desc{width:96%;position:absolute;bottom:0;left:0;font-size:12px;color:#fff;z-index:3;margin:0 2% 5px;filter:alpha(opacity=100)}.traffic-image-desc-index{float:left;width:13%}.traffic-image-desc-text{color:#fff;float:left;width:87%}.traffic-image-desc-text b{color:#fff;font-weight:400}.traffic-container .tableview-ul{margin-top:3px}.traffic-container .tableview-selected-border{border:3px solid #3AF;left:2px;top:0;width:190px;height:96px}"});var m=315,u=i.extend("TrafficModule",{constructor:function(){this.model=void 0},initialize:function(e,t,o,i,u,f){function h(i){var h=0;i&&(h=155);var w=g.tableView=new s(p,{viewWidth:document.body.clientWidth-m-h,viewHeight:113,margin:0,isHorizontal:!0});switch(o&&o.appendChild(p),g._timer=null,g._resizeHandler=function(){g._timer&&clearTimeout(g._timer),g._timer=setTimeout(function(){p.style.width=document.body.clientWidth-m+"px",w.setViewSize(document.body.clientWidth-m-h)},100)},T.on(window,"resize",g._resizeHandler),u.unshift(w),e){case"nav":g.model=new a;break;case"bus":case"buswalk":g.model=new r;break;case"walk":g.model=new d;break;case"share":window.currentComponent&&"NavTrans"==currentComponent.name||t&&t.TrafficModule?(g.model=new a,g.model.$shareParam=g.$shareParam):window.currentComponent&&"BusTrans"==currentComponent.name||t&&t.TrafficModule?(g.model=new r,g.model.$shareParam=g.$shareParam):(window.currentComponent&&"NavWalk"==currentComponent.name||t&&t.TrafficModule)&&(g.model=new d,g.model.$shareParam=g.$shareParam)}if(g.model){var v=g.model.getName().toLowerCase().replace("module","")+"-tableview-container";p.id=v,g.model.on("ready",function(){!f&&i&&"NavModule"===g.model.getName()&&(g.routeVideoModule=new l,g.routeVideoModule.initialize(g.container,g.getSteps()),g.routeVideoModule.addEventListener("play_routeVideo",function(e,t){g.dispatchEvent(e.type,t)})),g.fire("ready")}),n.each(c,function(e){g.model.addEventListener(e,function(e,t){g.dispatchEvent(e.type,t)})}),g.model.initialize.apply(g.model,u)}else g.ready()}try{this.headerContainer=document.createElement("div"),i.appendChild(this.headerContainer);var p=this.container=document.createElement("div");p.className="traffic-container",p.style.left=m+"px",p.style.width=document.body.clientWidth-m+"px";var g=this;n.hasRouteVideo().then(function(e){h(e)})}catch(w){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/pano/module/TrafficModule/exception.fire","catch",{msg:w.message||w.description,path:"common:widget/pano/module/TrafficModule/TrafficModule.js",ln:147})}},getContainer:function(){return this.container},setHeaderVisible:function(e){this.headerContainer.style.display=e?"block":"none"},isNav:function(){return this.model&&"NavModule"===this.model.getName()},isBus:function(){return this.model&&"BusModule"===this.model.getName()},isWalk:function(){return this.model&&"WalkModule"===this.model.getName()},isEnable:function(){return this.isNav()||this.isBus()||this.isWalk()},getClosestPoint:function(e,t,o){return this.model&&this.model.getClosestPoint(e,t,o)},getRoutParam:function(){return this.model&&this.model.getRoutParam()},getRoutPoints:function(){return this.model&&this.model.getRoutPoints()},getStartEndPoint:function(){return this.model&&this.model.getStartEndPoint()},getSteps:function(){return this.model&&this.model.getSteps&&this.model.getSteps()},getMarkers:function(){return this.model&&this.model.getMarkers()},show:function(){return this.model&&this.model.show(this.headerContainer)},dispose:function(){return this.model&&this.model.dispose()},getShareParam:function(){if(!this.model)return void 0;var e=this.model.getShareParam();return e.model=this.model.getName(),e},event_panoChanged:function(e){return this.model?this.model.event_panoChanged(e):void 0},event_layoutChanged:function(){},isAsync:function(){return!0},getSupportEvents:function(){return c}});o.exports=u});