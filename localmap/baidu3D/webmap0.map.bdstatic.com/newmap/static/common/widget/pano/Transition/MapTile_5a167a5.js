define("common:widget/pano/Transition/MapTile.js",function(){var t={unload:"unload",loading:"loading",loaded:"loaded"},i={tiles:new Array(19),get:function(t,i,e){var n=this.tiles,a="p_"+t+"_"+i;return n&&n[e]&&n[e][a]?n[e][a]:null},set:function(t,i,e,n){var a=this.tiles,r="p_"+t+"_"+i;a[e]||(a[e]={}),a[e][r]=n}},e="http://online{port}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=pl&udt=20140927",n=function(n,a,r,s){var o;if(2===arguments.length){o=arguments[0],s=arguments[1];var h=o.match(/x=(\d+).+y=(\d+).+z=(\d+)/);n=h[1],a=h[2],r=h[3]}var u=i.get(n,a,r);if(u)return u;this.context=s,this.status=t.unload;var d=.5+2*Math.random()+1|0;o=o||e.replace("{port}",d).replace("{x}",n).replace("{y}",a).replace("{z}",r),this.url=o,this.x=n,this.y=a,this.z=r},a=n.prototype;return a.getImage=function(){return this.image},a.setOpacity=function(t){this.opacity=t},a.setSize=function(t,i){return i=i||t,(this.width!==t||this.height!==i)&&(this.width=t,this.height=i),this},a.redraw=function(){this.context.draw(this)},a.setDrawPosition=function(t,i){return this.drawX=t,this.drawY=i,this},a.fetch=function(i){if(this.status===t.loaded)return this.redraw(),void(i&&i());if(this.status===t.unload){var e=this.url,n=this.image=document.createElement("img");this.status=t.loading;var a=this;n.onload=n.onerror=function(){a.status=t.loaded,a.redraw(),i&&i()},n.src=e}},n});