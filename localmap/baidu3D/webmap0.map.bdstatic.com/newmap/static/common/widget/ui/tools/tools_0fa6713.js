define("common:widget/ui/tools/tools.js",function(o,n,t){function e(){for(var o=T.g("tool_container_con"),n=o.childNodes,t=[],e=0,i=n.length;i>e;e++)1==n[e].nodeType&&t.push(n[e]);return t}function i(){_.addEventListener("onFullScreen",function(){V.resetWidth()}),_.addEventListener("onExitFull",function(){V.resetWidth()})}function s(){if(window.searchInViewCtrl){var n=window.searchInViewCtrl;0==n.isOpen?(addStat("indextool.searchinview.opensearchinview"),n.prepare()):n.setStatus(),n.hasClickButton=!0}else o.async("common:widget/ui/searchInViewControl/SearchInViewControl.js",function(o){var n=window.searchInViewCtrl=new o;n.prepare(),n.hasClickButton=!0}),addStat("indextool.searchinview.opensearchinview")}function a(o){var n=o&&1==o.nodeType?o:this;n._opened||(T.rc(n,"span_focus"),T.ac(n,"span_over"))}function u(o){var n=o&&1==o.nodeType?o:this;T.rc(n,"span_over"),n._opened||T.rc(n,"span_focus")}function r(o){var n=o&&1==o.nodeType?o:this,t=1;T.browser.ie||(t=0),o&&o.button!=t||(T.rc(n,"span_over"),T.ac(n,"span_focus"))}var c=(o("common:widget/ui/stat/CodeStat.js"),o("common:widget/ui/config/config.js")),l=o("common:widget/ui/constant/Constant.js"),d=o("common:widget/ui/indexUtil/IndexUtil.js"),p=o("common:widget/com/componentManager.js"),m=(o("common:widget/ui/mapInfo/mapInfo.js"),o("common:widget/ui/toolShare/ToolShare.js")),f=c.modelConfig,g=o("common:widget/ui/signMgr/signMgr.js"),_=o("common:widget/ui/fullScreen/fullScreen.js"),w=(o("common:widget/ui/AQIMgr/AQIMgr.js"),T.g("curCity")),h=T.g("tool_sehInView"),v=T.g("tool_traffic"),C=T.g("tool_tollCon"),S=T.g("tool_fullScr"),M=T.g("tools_box"),b=(T.g("boxBtn"),T.g("specialBtn")),x=(T.g("favBtn"),T.g("measure")),y=T.g("capwrap"),I=T.g("signwrap"),E=T.g("link"),L=T.g("print"),j=T.g("tool_pano_share"),k=T.g("tool_event"),B=T.g("tool_street_view_share"),D=T.g("tool_panoClose"),O=(T.g("air_quality_btn"),function(){M.style.top="23px"}),P=function(){M.style.top="-2000px"},V={init:function(){this.bindEvent(),this.resetWidth(),i()},bindEvent:function(){var n=this;T.on(C,"mouseenter",O),T.on(C,"mouseleave",P),T.on(h,"mouseover",a),T.on(v,"mouseover",a),T.on(S,"mouseover",a),T.on(b,"mouseover",a),T.on(x,"mouseover",a),T.on(y,"mouseover",a),T.on(I,"mouseover",a),T.on(E,"mouseover",a),T.on(L,"mouseover",a),T.on(j,"mouseover",a),T.on(k,"mouseover",a),T.on(B,"mouseover",a),T.on(D,"mouseover",a),T.on(h,"mouseout",u),T.on(v,"mouseout",u),T.on(S,"mouseout",u),T.on(b,"mouseout",u),T.on(x,"mouseout",u),T.on(y,"mouseout",u),T.on(I,"mouseout",u),T.on(E,"mouseout",u),T.on(L,"mouseout",u),T.on(j,"mouseout",u),T.on(k,"mouseout",u),T.on(B,"mouseout",u),T.on(D,"mouseout",u),T.on(h,"mousedown",r),T.on(v,"mousedown",r),T.on(S,"mousedown",r),T.on(j,"mousedown",r),T.on(k,"mousedown",r),T.on(B,"mousedown",r),T.on(D,"mousedown",r),baidu(w).on("click",function(o){d.selectCity(w,{styleSwitch:!0}),o.preventDefault()}),baidu(h).on("click",function(o){s(),o.preventDefault()}),T.on(x,"click",function(){M.style.top="-2000px",n.doMeasure(this),T.rc(T.g("tool_tollCon"),"span_focus")}),T.on(y,"click",function(){M.style.top="-2000px",n.captureMap(this),T.rc(T.g("tool_tollCon"),"span_focus")}),T.on(I,"click",function(){M.style.top="-2000px",addStat("http://webmap0.map.bdstatic.com/newmap/static/common/widget/ui/tools/indextool.toolbar.mark"),g("mapSign"),T.rc(T.g("tool_tollCon"),"span_focus")}),T.on(E,"click",function(){addStat("indextool.toolbar.toolbarshare"),M.style.top="-2000px",m.open(this),T.rc(T.g("tool_tollCon"),"span_focus")}),T.on(L,"click",function(){_this=this,addStat("indextool.toolbar.print"),M.style.top="-2000px",T.rc(T.g("tool_tollCon"),"span_focus"),o.async("common:widget/ui/PrintMap/PrintMap.js",function(o){o.printMap(_this)})}),T.on(j,"click",function(){m.open(this)}),T.on(k,"click",function(){addStat("indextool.toolbar.accident"),T.rc(k,"span_focus"),window.pubEvent&&window.pubEvent.toggle()}),baidu(".search_box .search_input input").on("mousedown",function(){n.closeMeasure()}),baidu("form.tool_form").on("submit",function(o){n.submit(),o.preventDefault()}),baidu("input.tools_search_submit").on("click",function(o){n.submit(),o.preventDefault()})},resetWidth:function(){var o=T.g("tool_container"),n=T.g("tool_container_con"),t=n?e():[],i=0;o.style.width="auto";for(var s=0;s<t.length;s++)t[s]&&(i+=t[s].offsetWidth+4);o.style.width=i+3+"px"},submit:function(){if(""==T.g("ToolPoiSearch").value)return void T.g("ToolPoiSearch").focus();window.PanoMap&&window.PanoMap.isOpen&&PanoMap.hide();var o=T.g("ToolPoiSearch").value,n=f.cityCode||1;p.go("s&wd="+encodeURIComponent(o)+"&c="+n+"&src=0",{cinfo:{}})},doMeasure:function(o){this.endCaptureMap(),g.exituserSign();var n=this;if(!n.distanceControl){BMap.PolylineTItem=BMap.DistanceTool;var t=new BMap.PolylineTItem(map,{styleCodes:{lnCode:l.OVERLAY_STYLE.DIS_LINE,spCode:l.OVERLAY_STYLE.DIS_DOT,slCode:l.OVERLAY_STYLE.DIS_LBL,tlCode:l.OVERLAY_STYLE.DIS_T_LBL}});n.distanceControl=t}this.doMeasure._initialized||(n.distanceControl&&n.distanceControl.addEventListener("drawend",function(){T.rc(o,"span_focus")}),this.doMeasure._initialized=!0),n.distanceControl&&(n.distanceControl._isOpen?this.closeMeasure():(n.distanceControl.open(),T.ac(o,"span_focus"),addStat("indextool.toolbar.ruler")))},closeMeasure:function(){var o=this;o.distanceControl&&o.distanceControl.close(),T.rc(T.g("measure"),"span_focus")},captureMap:function(){var n=this;this.closeMeasure(),g.exituserSign(),o.async("common:widget/com/Capture/Capture.js",function(o){n.startCaptureMap(o)})},startCaptureMap:function(o){o._initialized||(o.initialize(map),o._initialized=!0),o._inUse?(o.endCapture(),T.rc(T.g("capwrap"),"span_focus")):(o.beginCapture(),T.ac(T.g("capwrap"),"span_focus"),addStat("indextool.toolbar.capture"))},endCaptureMap:function(){window.captureCtrl&&window.captureCtrl._initialized&&window.captureCtrl.endCapture()},closeOtherOps:function(){this.closeMeasure(),this.endCaptureMap(),g.exituserSign()}};t.exports=V});