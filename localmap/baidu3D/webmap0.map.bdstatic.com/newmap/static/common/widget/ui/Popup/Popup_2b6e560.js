define("common:widget/ui/Popup/Popup.js",function(t,i,e){function o(t){T.lang.Class.call(this),this.visible=!1,this.config=t,this.config&&(this.config.addDom=this.config.addDom?T.g(this.config.addDom):document.body,this.config.clickClose=null!=t.clickClose&&0==t.clickClose?!1:!0,this.connectDom=new Array)}var n=1,s=2,h=t("common:widget/ui/util/util.js");T.extend(o.prototype,{render:function(){try{var t=this.config,i=this.config.extClass||"";this.main=h.beforeEndHTML(t.addDom,'<div class="map_popup '+i+'" style="width:390px;display:none"></div>');var e=this.popBox=h.beforeEndHTML(this.main,'<div class="popup_main"></div>');0!=t.isTitle&&(this.title=h.beforeEndHTML(e,'<div class="title">系统信息</div>')),this.content=h.beforeEndHTML(e,'<div class="content"></div>'),this.button=this.config.closeButton?h.beforeEndHTML(e,this.config.closeButton):h.beforeEndHTML(e,'<button id="popup_close" title="关闭"></button>'),this.shadow=h.beforeEndHTML(this.main,'<div class="poput_shadow"></div>'),this.addConnectDom(this.main),this.initialize()}catch(o){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/ui/Popup/exception.fire","catch",{msg:o.message||o.description,path:"common:widget/ui/Popup/Popup.js",ln:69})}},initialize:function(){try{var t=this.config;this.setTitle(t.title),this.setContent(t.content),this.setWidth(t.width),this.setHeight(t.height),this.show();var i=this,e=function(t){for(var e=t.srcElement||t.target;e;){for(var o=i.connectDom,n=0;n<o.length;n++)if(e==o[n])return;if(e==document.body)return void i.close();e=e.parentNode}};this.config.clickClose&&T.on(document.body,"mousedown",e),T.on(this.button,"click",function(){i.config.noCloseFun||(i.config.clickClose&&T.un(document.body,"mousedown",e),i.config.closeEffect&&"function"==typeof i.config.closeEffect?i.config.closeEffect():i.main.parentNode&&i.main.parentNode.removeChild(i.main),i.visible=!1,i.config.close&&"function"==typeof i.config.close&&i.config.close(),this.resizeTimer&&(window.clearInterval(this.resizeTimer),this.resizeTimer=null),T.g("imgLogo")&&(T.g("imgLogo").style.display="",T.g("imgLogo").style.display="inline"))}),t.open&&"function"==typeof t.open&&t.open(),this.setPosition()}catch(o){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/ui/Popup/exception.fire","catch",{msg:o.message||o.description,path:"common:widget/ui/Popup/Popup.js",ln:144})}},dialog:function(t){var i=function(){t.getDom().style.left=(h.getClientSize().width-t.config.width)/2+"px",t.getDom().style.top=(h.getClientSize().height-t.config.height)/2+"px"},e=function(){setTimeout(function(){i(),T.g("mapmask")&&(T.g("mapmask").style.width=h.getClientSize().width+"px",T.g("mapmask").style.height=h.getClientSize().height+"px")},20)};i(),T.g("mapmask")?T.g("mapmask").style.display="":baidu(document.body).insertHTML("beforeend",'<div id="mapmask" style="position:absolute;z-index:99996;background:#000;width:'+h.getClientSize().width+"px;height:"+h.getClientSize().height+'px;left:0;top:0;opacity:0.2;filter:alpha(opacity=20);"></div>'),T.on(window,"resize",e),T.on(this.button,"click",function(){T.un(window,"resize",e)})},setPosition:function(){this.config.defaultAnchor&&this.updatePos(this.config.defaultAnchor)},setTitle:function(t){t&&this.title&&(this.title.innerHTML=t,this.config.title=t)},setContent:function(t){t&&("string"==typeof t?this.content.innerHTML=t:(this.content.innerHTML="",this.content.appendChild(t)),this.config.content=t)},setWidth:function(t){t&&(this.main.style.width=t-8+"px",this.config.width=t)},setHeight:function(t){this.resizeTimer&&(window.clearInterval(this.resizeTimer),this.resizeTimer=null),t?(this.main.style.height=this.shadow.style.height=t-9+"px",this.config.height=t,this.content.style.height=0==this.config.isTitle?t-2+"px":t-24-9+"px",this.content.style.overflowY=this.config.contentOverFlow?"hidden":"auto"):(this.content.style.height="auto",this.resize())},hide:function(){this.main.style.display="none",this.visible=!1},show:function(){this.main.style.display="block",this.popBox.scrollTop=0,this.visible=!0},getDom:function(){return this.main},resize:function(){var t=this,i=function(){if(0==t.config.isAddBottomHeight)var i=t.content.offsetHeight;else var i=t.content.offsetHeight+24;t.mainHeight&&t.mainHeight!=i&&(t.mainHeight=i),t.popBox.style.height=t.shadow.style.height=t.main.style.height=i+"px",t.popBox.scrollTop=0};this.resizeTimer&&(window.clearInterval(this.resizeTimer),this.resizeTimer=null),this.resizeTimer=window.setInterval(i,50)},updatePos:function(t){var i=this.main,e=this.config,o=map.getSize(),c=h.getClientSize(),l=e.offset||[],d=l[0]||0,f=l[1]||0,a=c.width<=e.width?0:c.width/2-e.width/2,g=c.height<=e.height?0:c.height/2-e.height/2;switch(t=t||s){case n:a=o.width<=e.width?0:o.width/2-e.width/2,g=o.height<=e.height?0:o.height/2-e.height/2}e&&"undefined"!=typeof e.right?i.style.right=e.right+d+"px":i.style.left=e&&"undefined"http://webmap0.map.bdstatic.com/newmap/static/common/widget/ui/Popup/!=typeof e.left?e.left+d+"px":a+d+"px",i.style.top=e&&"undefined"http://webmap0.map.bdstatic.com/newmap/static/common/widget/ui/Popup/!=typeof e.top?e.top+f+"px":e&&"undefined"!=typeof e.bottom?e.bottom+f+"px":g+f+"px"},close:function(){this.button.click()},addConnectDom:function(t){this.connectDom.push(t)}}),e.exports=o});