define("common:widget/com/Detail/Detail.js",function(require,exports,module){function Detail(t){MapComponent.call(this,t),this.mkr=null,this.pt=null,this.wnd=null,this.name="",this.sCityCode=0,this.sCityName="",this.selected=!1}var comMgr=require("common:widget/com/componentManager.js"),MapComponent=require("common:widget/com/MapComponent.js"),AID=require("common:widget/ui/areaCfg/areaCfg.js"),constant=require("common:widget/ui/constant/Constant.js"),util=require("common:widget/ui/util/util.js"),mapUtil=require("common:widget/ui/mapUtil/mapUtil.js"),searchBox=require("common:widget/ui/searchBox/searchBox.js"),BShare=require("common:widget/ui/toolShare/ToolShare.js"),Share=require("common:widget/ui/mapShare/MapShare.js"),BoxContainer=require("common:widget/ui/BoxContainer/BoxContainer.js"),PanoUtil=require("common:widget/ui/PanoUtil/PanoUtil.js"),config=require("common:widget/ui/config/config.js"),modelConfig=config.modelConfig,MapConfig=config.mapConfig,style=".detail_container{margin-top:10px}.detail_container .title{font-weight:700}.hasTB{border-top:1px solid #bfd0f5}.substop_detail{overflow:hidden;zoom:1}.substop_detail table{border-collapse:collapse;margin-left:45px}.ss_round,.ss_busstop{width:25px;vertical-align:top}.ss_round div,.ss_busstop div{width:25px;height:25px;overflow:hidden;background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/substa_detail_5ef5121.gif) no-repeat}.ss_round div{background-position:0 -44px}.ss_busstop div{background-position:-50px -44px}.ss_busstop_t{color:#68c}.ss_time_info{border-collapse:collapse;border:0;padding:0;text-align:center}.ss_time_info .col_dir{width:140px;text-align:left}.ss_time_info .col_dirt{padding-top:2px;text-align:left}.nsupport img{display:none}.ext_ptbl{margin:5px 5px 0 0;width:100%;text-align:center;border-collapse:collapse;border:1px solid #dcdcdc}.ext_ptbl td,.ext_ptbl th{border:1px solid #dcdcdc;height:22px}.ext_ptbl th{background:#f2f2f2;font-weight:400}.ext_ptbl sup{font-size:10px}.subway_bj img,.subway_shh img,.subway_gzh img,.subway_szh img,.subway_hk img,.subway_nj img,.subway_chd img,.subway_chq img,.subway_tj img,.subway_shy img,.subway_hzh img,.subway_wh img,.subway_suz img,.subway_dl img,.subway_chc img,.subway_xian img,.subway_km img,.subway_fsh img,.subway_zhzh img,.subway_hrb img,.subway_nbo img,.subway_wuxi img,.subway_taibei img,.subway_gaoxiong img{display:inline;width:12px;height:11px;margin:3px 6px -1px 1px}.subway_bj img{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/subways/bj_sqr_lines_631db6a.gif) no-repeat}.subway_bj .l_1{background-position:0 0}.subway_bj .l_2{background-position:0 -30px}.subway_bj .l_4{background-position:0 -240px}.subway_bj .l_5{background-position:0 -60px}.subway_bj .l_6{background-position:0 -468px}.subway_bj .l_7{background-position:0 -517px}.subway_bj .l_8{background-position:0 -90px}.subway_bj .l_9{background-position:0 -428px}.subway_bj .l_10{background-position:0 -120px}.subway_bj .l_13{background-position:0 -150px}.subway_bj .l_8t{background-position:0 -180px}.subway_bj .l_air{background-position:0 -210px}.subway_bj .l_15{background-position:0 -270px}.subway_bj .l_cp{background-position:0 -300px}.subway_bj .l_dx{background-position:0 -330px}.subway_bj .l_yz{background-position:0 -360px}.subway_bj .l_fs{background-position:0 -390px}.subway_bj .l_14{background-position:0 -496px}.subway_shh img{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/subways/sh_sqr_lines_5df1c17.gif) no-repeat}.subway_shh .l_1{background-position:0 0}.subway_shh .l_2{background-position:0 -30px}.subway_shh .l_3{background-position:0 -60px}.subway_shh .l_4{background-position:0 -90px}.subway_shh .l_5{background-position:0 -120px}.subway_shh .l_6{background-position:0 -150px}.subway_shh .l_8{background-position:0 -180px}.subway_shh .l_9{background-position:0 -210px}.subway_shh .l_cxf{background-position:0 -240px}.subway_shh .l_7{background-position:0 -270px}.subway_shh .l_11{background-position:0 -300px}.subway_shh .l_11z{background-position:0 -330px;width:23px}.subway_shh .l_13{background-position:0 -360px}.subway_shh .l_10{background-position:0 -390px}.subway_shh .l_12{background-position:0 -416px}.subway_shh .l_16{background-position:0 -439px}.subway_gzh img{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/subways/gz_sqr_lines_0f5746b.gif) no-repeat}.subway_gzh .l_1{background-position:0 0}.subway_gzh .l_2{background-position:0 -30px}.subway_gzh .l_3{background-position:0 -60px}.subway_gzh .l_4{background-position:0 -90px}.subway_gzh .l_3zx{background-position:0 -120px;width:23px}.subway_gzh .l_5{background-position:0 -150px}.subway_gzh .l_8{background-position:0 -180px}.subway_gzh .l_gf{background-position:0 -213px;width:23px}.subway_gzh .l_apm{background-position:0 -240px;width:24px}.subway_gzh .l_6{background-position::0 -264px}.subway_szh img{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/subways/sz_sqr_lines_92c35e0.gif) no-repeat}.subway_szh .l_lb{background-position:0 0}.subway_szh .l_sk{background-position:0 -34px}.subway_szh .l_lg{background-position:0 -71px}.subway_szh .l_lh{background-position:0 -108px}.subway_szh .l_hz{background-position:0 -147px}.subway_hk img{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/subways/hk_sqr_lines_7c11619.gif) no-repeat}.subway_hk .l_qw{background-position:0 -63px}.subway_hk .l_gd{background-position:0 -94px}.subway_hk .l_jja{background-position:0 -162px}.subway_hk .l_dsn{background-position:0 -229px}.subway_hk .l_jc{background-position:0 -262px}.subway_hk .l_dt{background-position:0 -298px}.subway_hk .l_xt{background-position:0 0}.subway_hk .l_mas{background-position:0 -197px}.subway_hk .l_gt{background-position:0 -31px}.subway_hk .l_dy{background-position:0 -130px}.subway_nj img{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/subways/nj_sqr_lines_132f3bf.gif) no-repeat}.subway_nj .l_1{background-position:0 0}.subway_nj .l_2{background-position:0 -30px}.subway_nj .l_1ny{background-position:0 0}.subway_nj .l_10{background-position:0 -82px}.subway_nj .l_jch{background-position:0 -60px}.subway_chd img{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/subways/chd_sqr_lines_e87e428.gif) no-repeat}.subway_chd .l_1{background-position:0 0}.subway_chd .l_2{background-position:0 -30px}.subway_chq img{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/subways/chq_sqr_lines_d81baf2.gif) no-repeat}.subway_chq .l_1{background-position:0 0}.subway_chq .l_2{background-position:0 -30px}.subway_chq .l_3{background-position:0 -60px}.subway_chq .l_6{background-position:0 -90px}.subway_chq .l_gb{background-position:0 -112px}.subway_tj img{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/subways/tj_sqr_lines_e976a19.gif) no-repeat}.subway_tj .l_1{background-position:0 0}.subway_tj .l_2{background-position:0 -30px}.subway_tj .l_3{background-position:0 -60px}.subway_tj .l_9{background-position:0 -90px}.subway_shy img{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/subways/shy_sqr_lines_88ea8f9.gif) no-repeat}.subway_shy .l_1{background-position:0 0}.subway_shy .l_2{background-position:0 -30px}.subway_hzh img{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/subways/hzh_sqr_lines_2de38bd.gif) no-repeat}.subway_hzh .l_1{background-position:0 0}.subway_hzh .l_2{background-position:0 -37px}.subway_hzh .l_1zx{background-position:0 0}.subway_hzh .l_4{background-position:0 -57px}.subway_wh img{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/subways/wh_sqr_lines_1fca313.gif) no-repeat}.subway_wh .l_1{background-position:0 0}.subway_wh .l_2{background-position:0 -30px}.subway_suz img{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/subways/suz_sqr_lines_31cd12f.gif) no-repeat}.subway_suz .l_1{background-position:0 0}.subway_suz .l_2{background-position:0 -19px}.subway_dl img{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/subways/dl_sqr_lines_75bb795.gif) no-repeat}.subway_dl .l_qg{background-position:0 0}.subway_dl .l_kg{background-position:0 -30px}.subway_dl .l_bsq{background-position:0 -60px}.subway_dl .l_9zx{background-position:0 -90px}.subway_chc img{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/subways/chc_sqr_lines_e5e4a17.gif) no-repeat}.subway_chc .l_3{background-position:0 0}.subway_chc .l_4{background-position:0 -30px}.subway_xian img{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/subways/xian_sqr_lines_1eb79cf.gif) no-repeat}.subway_xian .l_2{background-position:0 0}.subway_xian .l_1{background-position:0 -24px}.subway_km img{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/subways/km_sqr_lines_82c961a.gif) no-repeat}.subway_km .l_6{background-position:0 0}.subway_fsh img{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/subways/fsh_sqr_lines_6779bfb.gif) no-repeat}.subway_fsh .l_gf{background-position:0 0}.subway_hrb img{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/subways/hrb_sqr_lines_d158215.gif) no-repeat}.subway_hrb .l_1{background-position:0 0}.subway_zhzh img{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/subways/zhzh_sqr_lines_313a06a.gif) no-repeat}.subway_zhzh .l_1{background-position:0 0}.subway_nbo img{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/subways/nbo_sqr_lines_3533041.gif) no-repeat}.subway_nbo .l_1{background-position:0 0}.subway_wuxi img{background:url(/static/images/subways/wuxi_sqr_lines.gif) no-repeat}.subway_wuxi .l_1{background-position:0 0}.subway_wuxi .l_2{background-position:0 -21px}.ss_time_info .col_time{width:50px}.ss_exit_0,.ss_exit_1,.ss_exit_2,.ss_exit_3,.ss_exit_4,.ss_exit_5,.ss_exit_6,.ss_exit_7,.ss_exit_0_0,.ss_exit_0_1,.ss_exit_2_0,.ss_exit_2_1,.ss_exit_5_0,.ss_exit_5_1,.ss_exit_9_0,.ss_exit_9_1{margin-top:5px;float:left;width:37px;height:38px;background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/substa_detail_5ef5121.gif) no-repeat}.ss_exit_1{background-position:-40px 0}.ss_exit_2{background-position:-80px 0}.ss_exit_3{background-position:-120px 0}.ss_exit_4{background-position:-160px 0}.ss_exit_5{background-position:-200px 0}.ss_exit_6{background-position:-240px 0}.ss_exit_7{background-position:-280px 0}.ss_exit_0_0{background-position:0 -80px}.ss_exit_0_1{background-position:0 -118px}.ss_exit_2_0{background-position:-80px -80px}.ss_exit_2_1{background-position:-80px -118px}.ss_exit_5_0{background-position:-200px -80px}.ss_exit_5_1{background-position:-200px -118px}.ss_exit_9_0{background-position:-360px -80px}.ss_exit_9_1{background-position:-360px -118px}";require.loadCss({content:style,name:"Detail"}),T.lang.inherits(Detail,MapComponent,"Detail"),T.object.extend(Detail.prototype,{render:function(){try{var template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="mapinfo_con">  <p class="detail_title">    ',"undefined"==typeof result_title?"":result_title,'  </p>  <p>    <a class="toHereSwitch" href=" javascript:void(0)" onclick="return Instance(&#39;',"undefined"==typeof guid?"":guid,'&#39;).switchTab(0)">到这里去</a> -     <a class="fromHereSwitch" href=" javascript:void(0)" onclick="return Instance(&#39;',"undefined"==typeof guid?"":guid,'&#39;).switchTab(1)">从这里出发</a> -     <a class="rangeSwitch" href="javascript:void(0)" onclick="return Instance(&#39;',"undefined"==typeof guid?"":guid,'&#39;).switchTab(2)">在附近找</a>  </p>  <div class="detail_container">    <p>',"undefined"==typeof detail_addr?"":detail_addr,"</p>    <p>","undefined"==typeof detail_cate?"":detail_cate,"</p>    ","undefined"==typeof ext_info?"":ext_info,"    ","undefined"==typeof aladin_info?"":aladin_info,"  </div></div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],templateObj={guid:this.guid},json=this.json,_this=this;this.setShareInfo(json);var j=json;if(!j)return;var c=json.content;if(!c)return;j.current_city?(this.sCityCode=j.current_city.code,this.sCityName=j.current_city.name):(this.sCityCode=modelConfig.cityCode,this.sCityName=modelConfig.cityName);var title=c.name;templateObj.result_title=title;var addr=c.addr;(c.poiType==constant.POI_TYPE_BUSSTOP||c.poiType==constant.POI_TYPE_SUBSTOP)&&(addr=T.array.unique(addr.split(";")).join("; "));var cate=this._getCate(c.cla);if(c.poiType!=constant.POI_TYPE_SUBSTOP&&c.poiType!=constant.POI_TYPE_BUSSTOP){var htmls=['<table cellspacing="0" class="table_addr_tel">'];addr&&htmls.push('<tr><th style="font-weight:bold">地址：&nbsp;</th><td>'+addr+"&nbsp;</td></tr>"),c.tel&&htmls.push('<tr><th style="font-weight:bold">电话：&nbsp;</th><td>'+c.tel.replace(/,/g,", ")+"</td></tr>"),htmls.push("</table>"),templateObj.detail_addr=htmls.join(""),templateObj.detail_cate=""}else c.poiType==constant.POI_TYPE_BUSSTOP?(templateObj.detail_addr=addr?"<span class='title'><span class='poi_bustrans'>途经公交车：</span></span>"+addr:"",templateObj.detail_cate=cate?"<span class='title'>类别：</span>"+cate:""):c.poiType==constant.POI_TYPE_SUBSTOP&&(templateObj.detail_addr="",templateObj.detail_cate="");templateObj.ext_info=this._renderExt(c.ext);var moUrl=this.modelQuery;if(moUrl&&moUrl.indexOf("all=1")>-1){var aldStr=[];aldStr.push("<div style='margin-top:8px;'><a href='javascript:void(0)' onclick='Instance(\""+this.guid+'").sendGResult("'+json.result.wd+'", '+json.current_city.code+");return false;'>"),aldStr.push("查看在<b>"+json.current_city.name+"</b>搜索“<b>"+json.result.wd+"</b>”的全部结果»"),aldStr.push("</a></div>"),templateObj.aladin_info=aldStr.join("")}else templateObj.aladin_info="";var geo=util.parseGeo(c.geo);1==geo.type&&(this.pt=util.getPointByStr(geo.points),this.name=c.name,this.mkr=mapUtil.addDetailPoi(this.pt,this.name));var me=this,tel=c.tel;tel&&(tel=tel.replace(/,/g,", ")),this.createInfoWnd(c,addr,tel,cate);var zoomlv=BMap.MapType[map.mapType].zoomLevelMax-3;return c.poiType==constant.POI_TYPE_SUBSTOP&&(zoomlv=BMap.MapType[map.mapType].zoomLevelMax),me.cinfo&&me.cinfo._maplevel&&me.cinfo._centerPoint||setTimeout(function(){map.centerAndZoom(util.getPointByStr(geo.points),zoomlv)},60),template(templateObj)}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/Detail/Detail.js",ln:156})}},initialize:function(){try{var t=this;this.mkr.addEventListener("click",function(){t.select()}),this.mkr.addEventListener("mouseover",function(){t._setTop(this,!0)}),this.mkr.addEventListener("mouseout",function(){map.temp.infoWin&&1==map.temp.infoWin.isOpen()&&map.temp.infoWin.overlay===this||t._setTop(this,!1)}),setTimeout(function(){t.cinfo&&t.cinfo._maplevel&&t.cinfo._centerPoint&&map.centerAndZoom(t.cinfo._centerPoint,t.cinfo._maplevel),t.cinfo&&"undefined"!=typeof t.cinfo._index&&0==t.cinfo._index&&t.select({focusId:"iw_ssn",notMove:!0})},60),BoxContainer&&BoxContainer.resetStatus(),this.json.content&&PanoUtil.isPanoStatus()&&PanoUtil.closePano()}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/Detail/Detail.js",ln:195})}},createInfoWnd:function(t,e,i,a){var s=this;util.loadSearchInfo(function(n){s.wnd=n.createSearchInfoWnd({title:t.name,addr:e,tel:i,uid:t.uid,cate:a,poiType:t.poiType,ext:t.ext,cp:t.cp,cla:t.cla},{cityCode:s.sCityCode,hideDetail:!0,x:s.pt.lng,y:s.pt.lat}),s.wnd.addEventListener("close",function(){s.selected=!1,s._setTop(s.mkr,!1),Share.listIndex=-1})})},unload:function(){this.mkr=null,this.pt=null,this.wnd=null,MapComponent.prototype.unload.apply(this)},_getCate:function(t){for(var e="",i=0,a=t.length;a>i;i++)e+=t[i][1],a-1>i&&(e+=", ");return e},select:function(t){if(window.searchInViewCtrl&&window.searchInViewCtrl.exit(),(this.mkr&&!this.mkr.isVisible()||this.mkr&&this.mkr.isVisible()&&!this.mkr.getDom().parentNode)&&(this.mkr=null,this.mkr=addDetailPoi(this.pt,this.name),this.mkr.addEventListener("click",function(){e.select()}),this.mkr.addEventListener("mouseover",function(){e._setTop(this,!0)}),this.mkr.addEventListener("mouseout",function(){map.temp.infoWin&&1==map.temp.infoWin.isOpen()&&map.temp.infoWin.overlay===this||e._setTop(this,!1)}),this.mkr._l=this.mkr.iconDom.style.left,this.mkr._t=this.mkr.iconDom.style.top),!this.selected){var e=this;t&&t.focusId&&map.addEventListener("moveend",function(){try{T.G(t.focusId).focus()}catch(e){setTimeout(function(){try{T.G(t.focusId).focus()}catch(e){}},300)}map.removeEventListener("moveend",arguments.callee)}),this.selected=!0,setTimeout(function(){e._setTop(e.mkr,!0)},200),Share.listIndex=0;var i=this;util.loadSearchInfo(function(e){e.openSearchInfoWnd(i.wnd,i.mkr,t)})}},switchTab:function(t){var e=["iw_ssn","iw_esn","rangekw"];if(e[t]){if(map.temp&&map.temp.infoWin&&map.temp.infoWin.isOpen()&&map.temp.infoWin.overlay===this.mkr){var i=map.pointToPixel(this.pt);i.x>map.width-160||i.x<110||i.y>map.height||i.y<220?(map.closeInfoWindow(),this.select({focusId:e[t]}),util.loadSearchInfo(function(e){e.switchInfoWndTab(t,null,!1,!0)})):util.loadSearchInfo(function(i){i.switchInfoWndTab(t,e[t])})}else(map.temp&&!map.temp.infoWin||map.temp.infoWin&&!map.temp.infoWin.isOpen()||map.temp.infoWin&&1==map.temp.infoWin.isOpen()&&map.temp.infoWin.overlay!=this.mkr)&&(this.select({focusId:e[t]}),util.loadSearchInfo(function(e){e.switchInfoWndTab(t,null,!0,!0)}));return!1}},_renderExt:function(t){try{if(!t||!t.src_name)return"";var e=this;switch(t.src_name){case"general_ext":return e._renderGExt(t);case"dt_stop":return e._renderDtStop(t);case"ctrip_hotel":return e._renderExtCtripHotel(t);case"ctrip_site":return e._renderExtCtripSite(t);case"dianping":return e._renderExtDianping(t);case"house_new":return e._renderExtHouseNew(t);case"house_ershou":return e._renderExtHouseErshou(t);default:return""}}catch(i){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:i.message||i.description,path:"common:widget/com/Detail/Detail.js",ln:366})}},_renderGExt:function(t){try{var e=[];if(t.detail_info)for(var i=0,a=t.detail_info.length;a>i;i++){if(e.push("<p"),i%2==0&&e.push(" class='mt10'"),e.push("><span class='title'>"+t.detail_info[i].title+"：</span>"),"网址"==t.detail_info[i].title){var s=t.detail_info[i].info;0!=s.indexOf("http://")&&(s="http://"+s),e.push('<a style="word-break:break-all" href="'+s+'" target="_blank"  >'+t.detail_info[i].info+"</a>")}else e.push(t.detail_info[i].info);e.push("</p>")}return e.join("")}catch(n){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:n.message||n.description,path:"common:widget/com/Detail/Detail.js",ln:391})}},_renderDtStop:function(t){try{for(var e=[],i=[],a=0;a<t.line_info.length;a++){var s=t.line_info[a];""==s.first_time&&""==s.last_time&&i.push("0")}if(t.line_info.length===i.length)return"";if(t.line_info){e.push('<table cellpadding="0" cellspacing="0" class="ss_time_info '+this._getCCode()+'">'),e.push('<tr><th class="col_dir">行驶方向</th><th class="col_time">首班车</th><th class="col_time">末班车</th></tr>');for(var a=0,n=t.line_info.length;n>a;a++){var o=t.line_info[a],p=o.line_name,r=o.first_time,l=o.last_time;(""!=r||""!=l)&&(e.push('<tr><td class="col_dirt"><img src="../../../../../../../webmap1.map.bdstatic.com/newmap/static/common/images/blank.gif"/*tpa=http://webmap1.map.bdstatic.com/newmap/static/common/images/blank.gif*/ class="l_'+this._getLCode(p)+'" />'),e.push("到"+o.terminals+"</td>"),e.push("<td>"+(r||"&minus;&minus;:&minus;&minus;")+"</td><td>"+(l||"&minus;&minus;:&minus;&minus;")+"</td></tr>"))}e.push("</table>")}if(t.around_info)for(var a=0,c=!0,n=t.around_info.length;n>a;a++)if(t.around_info[a].constructor==Object&&t.around_info[a].exit_name){if(e.push("<div class='substop_detail mt"+(1==c?"10":"5 hasTB")+"'>"),e.push("<div class='ss_exit_"+a+"'></div>"),e.push("<table cellspacing='0' cellpadding='2'>"),t.around_info[a].exit_round&&e.push("<tr><td class='ss_round'><div></div></td><td>"+t.around_info[a].exit_round.replace(/,/g,"<br />")+"</td></tr>"),t.around_info[a].bs_info){var _=t.around_info[a].bs_info.replace(/;/g,"<br />").replace(/,/g,", ");e.push("<tr><td class='ss_busstop'><div></div></td><td class='ss_busstop_t'>"+_+"</td></tr>")}e.push("</table></div>"),c=!1}else if(t.around_info[a].constructor==Array)for(var d=0,u=t.around_info[a].length;u>d;d++)if(t.around_info[a][d].exit_name){if(e.push("<div class='substop_detail mt"+(1==c?"10":"5 hasTB")+"'>"),e.push("<div class='ss_exit_"+a+"_"+d+"'></div>"),e.push("<table cellspacing='0' cellpadding='2'>"),t.around_info[a][d].exit_round&&e.push("<tr><td class='ss_round'><div></div></td><td>"+t.around_info[a][d].exit_round.replace(/,/g,"<br />")+"</td></tr>"),t.around_info[a][d].bs_info){var _=t.around_info[a][d].bs_info.replace(/;/g,"<br />").replace(/,/g,", ");e.push("<tr><td class='ss_busstop'><div></div></td><td class='ss_busstop_t'>"+_+"</td></tr>")}e.push("</table></div>"),c=!1}return e.join("")}catch(b){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:b.message||b.description,path:"common:widget/com/Detail/Detail.js",ln:461})}},_renderExtCtripHotel:function(t){try{var e=[];if(t.detail_info)for(var i=0,a=t.detail_info.length;a>i;i++){if(e.push("<p"),i%2==0&&e.push(" class='mt10'"),e.push("><span class='title'>"+t.detail_info[i].title+"：</span>"),"网址"==t.detail_info[i].title){var s=t.detail_info[i].info;0!=s.indexOf("http://")&&(s="http://"+s),e.push('<a style="word-break:break-all" href="'+s+'" target="_blank" >'+t.detail_info[i].info+"</a>")}else e.push("酒店特色"==t.detail_info[i].title?"</p><p style='text-indent:2em'>"+t.detail_info[i].info.replace(/^[\s\t\xa0]+/,""):t.detail_info[i].info);e.push("</p>")}if(t.title_link){e.push("<p class='mt10'>");for(var i=0,a=t.title_link.length;a>i;i++)e.push("<a style='word-break:break-all' href='"+t.title_link[i].link+"' target='_blank' >"+t.title_link[i].title+"</a>"),i<t.title_link.length-1&&e.push("&nbsp;&nbsp;");e.push("</p>")}return e.join("")}catch(n){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:n.message||n.description,path:"common:widget/com/Detail/Detail.js",ln:503})}},_renderExtCtripSite:function(t){try{return this._renderExtCtripHotel(t)}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/Detail/Detail.js",ln:506})}},_renderExtDianping:function(t){try{var e=[];if(t.detail_info)for(var i=0,a=t.detail_info.length;a>i;i++){if(e.push("<p"),i%2==0&&e.push(" class='mt10'"),e.push("><span class='title'>"+t.detail_info[i].title+"：</span>"),"网址"==t.detail_info[i].title){var s=t.detail_info[i].info;0!=s.indexOf("http://")&&(s="http://"+s),e.push('<a style="word-break:break-all" href="'+s+'" target="_blank" >'+t.detail_info[i].info+"</a>")}else e.push(t.detail_info[i].info);i==a-1&&"简介"==t.detail_info[i].title&&t.title_link&&e.push("&nbsp;&nbsp;<a style='word-break:break-all' href='"+t.title_link[0].link+"' target='_blank' >"+t.title_link[0].title+"</a>"),e.push("</p>")}return t.title_link&&(e.push("<p class='mt10'>"),e.push("<span class='title'>评论：</span><a  style='word-break:break-all' href='"+t.title_link[1].link+"' target='_blank' >"),e.push(t.title_link[1].title),e.push("</a></p>")),e.join("")}catch(n){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:n.message||n.description,path:"common:widget/com/Detail/Detail.js",ln:547})}},_renderExtHouseNew:function(t){try{var e=[];if(t.detail_info)for(var i=0,a=t.detail_info.length;a>i;i++){if(e.push("<p"),i%2==0&&e.push(" class='mt10'"),e.push("><span class='title'>"+t.detail_info[i].title+"：</span>"),"网址"==t.detail_info[i].title){var s=t.detail_info[i].info;0!=s.indexOf("http://")&&(s="http://"+s),e.push('<a style="word-break:break-all" href="'+s+'" target="_blank" >'+t.detail_info[i].info+"</a>")}else e.push("交通状况"==t.detail_info[i].title?"<p style='margin-left:24px'>"+t.detail_info[i].info+"</p>":t.detail_info[i].info);e.push("</p>")}if(t.around_info){e.push("<p class='title mt10'>周边设施：</p>"),e.push("<table cellspacing='0' cellpadding='1'>");for(var i=0,a=t.around_info.length;a>i;i++)e.push("<tr><td class='title' width='40' style='vertical-align:top'>"+t.around_info[i].title+"：</td>"),e.push("<td>"+t.around_info[i].info+"</td></tr>");e.push("</table>")}if(t.price){e.push("<p class='title mt10'>销售价格：</p>");var n=t.price.split(";");if(n.length>0){e.push("<table class='ext_ptbl' >"),e.push("<th>日期</th><th>建筑类别</th><th>均价（元/m<sup>2</sup>）</th>");for(var i=0,a=n.length;a>i;i++){e.push("<tr>");for(var o=n[i].split(" "),p=0,a=o.length;a>p;p++)e.push("<td>"+o[p]+"</td>");e.push("</tr>")}e.push("</table>")}}if(t.title_link){e.push("<p class='mt10'>");for(var i=0,a=t.title_link.length;a>i;i++)e.push("<a style='word-break:break-all' href='"+t.title_link[i].link+"' target='_blank' >"+t.title_link[i].title+"</a>"),i<t.title_link.length-1&&e.push("&nbsp;&nbsp;");e.push("</p>")}return e.push('<p class="mt10">以上信息由 <a href="http://www.snifast.com/" target="blank" >狙房网</a> 提供</p>'),e.join("")}catch(r){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:r.message||r.description,path:"common:widget/com/Detail/Detail.js",ln:618})}},_renderExtHouseErshou:function(t){try{var e=[];if(t.detail_info)for(var i=0,a=t.detail_info.length;a>i;i++){if(e.push("<p"),i%2==0&&e.push("  class='mt10'"),e.push("><span class='title'>"+t.detail_info[i].title+"：</span>"),"网址"==t.detail_info[i].title){var s=t.detail_info[i].info;0!=s.indexOf("http://")&&(s="http://"+s),e.push('<a style="word-break:break-all" href="'+s+'" target="_blank" >'+t.detail_info[i].info+"</a>")}else e.push(t.detail_info[i].info);e.push("</p>")}if(t.around_info){e.push("<p class='title mt10'>周边设施：</p>"),e.push("<table cellspacing='0' cellpadding='1'>");for(var i=0,a=t.around_info.length;a>i;i++)e.push("<tr><td class='title' width='40' style='vertical-align:top'>"+t.around_info[i].title+"：</td>"),e.push("<td>"+t.around_info[i].info+"</td></tr>");e.push("</table>")}if(t.price){e.push("<p class='title mt10'>二手房行情：</p>");var n=t.price.split(";");if(n.length>0){e.push("<table class='ext_ptbl'>"),e.push("<th>户型</th><th>面积</th><th>价格链接</th>");for(var i=0,a=n.length;a>i;i++){e.push("<tr>");for(var o=n[i].split(" "),p=0,a=o.length;a>p;p++)e.push(2==p?"<td><a href='"+o[p]+"' target='_blank' >查看价格行情</td>":"<td>"+o[p]+"</td>");e.push("</tr>")}e.push("</table>")}}if(t.title_link){e.push("<p class='mt10'>");for(var i=0,a=t.title_link.length;a>i;i++)e.push("<a style='word-break:break-all' href='"+t.title_link[i].link+"' target='_blank' >"+t.title_link[i].title+"</a>"),i<t.title_link.length-1&&e.push("&nbsp;&nbsp;");e.push("</p>")}return e.push('<p  class="mt10">以上信息由 <a href="http://www.mysupa.com/" target="blank" >超级经纪人</a> 提供</p>'),e.join("")}catch(r){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/com/Detail/exception.fire","catch",{msg:r.message||r.description,path:"common:widget/com/Detail/Detail.js",ln:693})}},_getLCode:function(t){var e="",i=(this.sCityName||"",this.sCityCode||1);if(t=t.replace("地铁","").replace(/\(.+\)$/,""),t.match(/\d+/)&&t.match(/\d+/).length>0)return e=t.match(/\d+/)[0];switch(i){case parseInt(AID["北京"]):t.indexOf("八通")>-1?e="8t":t.indexOf("昌平")>-1?e="cp":t.indexOf("亦庄")>-1?e="yz":t.indexOf("房山")>-1?e="fs":t.indexOf("机场")>-1&&(e="air");break;case parseInt(AID["上海"]):t.indexOf("磁悬浮")>-1?e="cxf":t.indexOf("支")>-1&&t.indexOf("11")>-1&&(e="11z");break;case parseInt(AID["广州"]):t.indexOf("apm")>-1?e="apm":t.indexOf("支")>-1&&t.indexOf("3")>-1?e="3zx":t.indexOf("广佛")>-1&&(e="gf");break;case parseInt(AID["深圳"]):t.indexOf("罗宝")>-1?e="lb":t.indexOf("蛇口")>-1?e="sk":t.indexOf("龙岗")>-1?e="lg":t.indexOf("龙华")>-1?e="lh":t.indexOf("环中")>-1&&(e="hz");break;case parseInt(AID["香港特别行政区"]):t.indexOf("荃湾")>-1?e="qw":t.indexOf("港岛")>-1?e="gd":t.indexOf("将军澳")>-1?e="jja":t.indexOf("迪士尼")>-1?e="dsn":t.indexOf("机场")>-1?e="jc":t.indexOf("东铁")>-1?e="dt":t.indexOf("西铁")>-1?e="xt":t.indexOf("马鞍山")>-1?e="mas":t.indexOf("观塘")>-1?e="gt":t.indexOf("东涌")>-1&&(e="dy");break;case parseInt(AID["南京"]):t.indexOf("机场线")>-1&&(e="jch");break;case parseInt(AID["杭州"]):t.indexOf("支线")>-1&&(e="1zx");break;case parseInt(AID["大连"]):t.indexOf("轻轨3号线")>-1?e="qg":t.indexOf("九里线")>-1?e="kg":t.indexOf("保税区线")>-1?e="bsq":t.indexOf("九里支线")>-1&&(e="9zx");break;case parseInt(AID["佛山"]):t.indexOf("广佛")>-1&&(e="gf");break;case parseInt(AID["重庆"]):t.indexOf("国博")>-1&&(e="gb")}return e},_getCCode:function(){var t=(this.sCityName||"",this.sCityCode||1),e="nsupport";switch(t){case parseInt(AID["北京"]):e="bj";break;case parseInt(AID["上海"]):e="shh";break;case parseInt(AID["广州"]):e="gzh";break;case parseInt(AID["深圳"]):e="szh";break;case parseInt(AID["香港特别行政区"]):e="hk";break;case parseInt(AID["南京"]):e="nj";break;case parseInt(AID["成都"]):e="chd";break;case parseInt(AID["重庆"]):e="chq";break;case parseInt(AID["天津"]):e="tj";break;case parseInt(AID["沈阳"]):e="shy";break;case parseInt(AID["杭州"]):e="hzh";break;case parseInt(AID["武汉"]):e="wh";break;case parseInt(AID["苏州"]):e="suz";break;case parseInt(AID["大连"]):e="dl";break;case parseInt(AID["长春"]):e="chc";break;case parseInt(AID["西安"]):e="xian";break;case parseInt(AID["昆明"]):e="km";break;case parseInt(AID["佛山"]):e="fsh";break;case parseInt(AID["哈尔滨"]):e="hrb";break;case parseInt(AID["郑州"]):e="zhzh";break;case parseInt(AID["宁波"]):e="nbo";break;case parseInt(AID["无锡"]):e="wuxi"}return e="subway_"+e},_setTop:function(t,e){if(t&&t.setTop){if(e&&!t._isTop){var i={offset:constant.A_J_MARKER_BLUE_OFFSET,imageOffset:new BMap.Size(0,-156),infoWindowOffset:constant.A_J_MARKER_INFOWND_OFFSET},a=new BMap.Icon(constant.A_J_MARKER_IMG,constant.A_J_MARKER_BLUE_SIZE,i);return t.setIcon(a),void(t._isTop=!0)}if(!e){var i={offset:constant.A_J_MARKER_OFFSET,imageOffset:new BMap.Size(0,-116),infoWindowOffset:constant.A_J_MARKER_INFOWND_OFFSET},a=new BMap.Icon(constant.A_J_MARKER_IMG,constant.A_J_MARKER_RED_SIZE,i);t.setIcon(a),delete t._isTop}}},sendGResult:function(t,e){comMgr.go("con&contp=1&on_gel=1&wd="+encodeURIComponent(t)+"&c="+e)},setShareInfo:function(t){var e=this;BShare.getMInfo=function(){var i="",a=t,s="single";if(a&&a.content){var n=a.content;if(n){var o=n.name||"",p=n.addr||"",r=n.tel||"";switch(n.poiType){case constant.POI_TYPE_BUSLINE:break;case constant.POI_TYPE_SUBLINE:break;case constant.POI_TYPE_BUSSTOP:o=BShare.fixName(o+"-公交车站"),p=p?"途经公交："+T.array.unique(p.split(";")).join("; "):"";break;case constant.POI_TYPE_SUBSTOP:o=BShare.fixName(o+"-地铁站"),p=p?"途经地铁："+T.array.unique(p.split(";")).join("; "):"";break;default:o=BShare.fixName(o),r=r.replace(/,/g,", ")}i=[o,p,r].join(" ")}else i=a.result.wd+"的搜索结果 "}return{text:i,className:e._className,type:s}}}}),module.exports=Detail});