function strlen(e){for(var t=0,n=0;n<e.length;n++)e.charCodeAt(n)>255||e.charCodeAt(n)<0?t+=2:t++;return t}function textEvent(){var e=printUtil.JS("textarea");if(e.value)e.parentNode.className="notes";else{var t=e.parentNode.className;-1===t.indexOf("none")&&(e.parentNode.className+=" none")}e.onchange=e.onblur=e.onfocus=function(){if(!this.value){var e=this.parentNode.className;return void(-1===e.indexOf("none")&&(this.parentNode.className+=" none"))}this.parentNode.className="notes"}}function textareaChange(){var e=strlen(textarea.value),t=18*Math.ceil(e/42);textarea.style.height=36>t?36:t+"px"}function isShowAllMap(){var e=T.g("mapDisplay");return e&&"Selected"==e.className?!0:!1}function getNumOpenedMap(){for(var e=printUtil.JS.getElementByClassName("smallMap"),t=0,n=0,a=e.length;a>n;n++)"block"==e[n].style.display&&t++;return t}function getModelName(){}function isMainMapVisible(){var e=T.g("btnToggleMMap");return e&&"Selected"==e.className?!0:!1}function isShowDetailText(){return printUtil.JS.getElementByClassName("detailsClose").length>0}function getMapOpCount(){return window._mMapOpCount}function isShowDetailMap(){for(var e=printUtil.JS.getElementByClassName("displayDetailsMap"),t=0,n=e.length;n>t;t++)if(e[t].innerHTML.indexOf("收起")>-1)return!0;return!1}function hideGeolocation(){var e=printUtil.JS.getElementByClassName("BMap_geoLoc")[0];e&&(e.style.display="none");var t=stdMapCtrl.getDom();t.style.height="226px",t.childNodes[1].style.top=""}function mousedownPrint(e){e.style.backgroundPosition="0 -66px"}function mouseupPrint(e){e.style.backgroundPosition="0 -33px"}function mouseoverClose(e){e.style.backgroundPosition="0 -132px"}function mouseoutClose(e){e.style.backgroundPosition="0 -99px"}function mousedownClose(e){e.style.backgroundPosition="0 -165px"}function mouseupClose(e){e.style.backgroundPosition="0 -132px"}var util=require("common:widget/ui/util/util.js"),mapUtil=require("common:widget/ui/mapUtil/mapUtil.js"),printUtil=require("common:widget/print/printUtil/printUtil.js");window.disableNavDragging=!0,window.disableBusDragging=!0;var paramExt=util.getParam(location.href),mapType=paramExt.tn||paramExt.mt,textarea=printUtil.JS("textarea");textarea.onkeyup=textarea.onchange=textareaChange,window.onload=function(){textEvent(),printUtil.textMapDisplay(),textarea.onkeyup()};for(var mods=printUtil.JS.getElementByClassName("mod"),i=mods.length;i--;){var hd=printUtil.JS.getElementByClassName("hd",mods[i]);if(hd.length){var links=printUtil.JS.getElementByClassName("controlDisplay",hd[0])[0].getElementsByTagName("A");links.length&&!function(e){e&&(links[0].onclick=function(){return"Selected"===this.className?(e.style.display="none",this.className="noSelected",this.innerHTML="显示"):"noSelected"===this.className&&(e.style.display="block",this.className="Selected",this.innerHTML="隐藏"),!1})}(printUtil.JS.getElementByClassName("bd",mods[i])[0])}}window.printWithStat=function(){var e=isShowAllMap(),t=getNumOpenedMap(),n=getModelName(),a=isMainMapVisible();switch(n){case"BusTrans":addStat(STAT_PRNT_TOTAL_BUS,{mmaphidden:a?0:1,showall:e?1:0,openedmap:t,opcount:getMapOpCount(),openedmap:t});break;case"NavTrans":var i={mmaphidden:a?0:1,showall:e?1:0,openedmap:t,opcount:getMapOpCount(),openedmap:t};ModelMgr.mainModel.isCrossCity()&&(i.detailtext=isShowDetailText()?1:0,i.detailmap=isShowDetailMap()?1:0),addStat(STAT_PRNT_TOTAL_DRV,i)}window.print()},window._mMapOpCount=0;var addMapOpCount=function(){window._mMapOpCount++};window.mouseoverPrint=function(e){e.style.backgroundPosition="0 -33px"},window.mouseoutPrint=function(e){e.style.backgroundPosition="0 0"},map.addEventListener("dragend",addMapOpCount),map.addEventListener("moveend",addMapOpCount),map.addEventListener("zoomend",addMapOpCount);