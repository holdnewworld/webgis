define("common:widget/com/SMS/SMS.js",function(require,exports,module){function SmS(e){window.SMSInst=this,BaseComponent.call(this,e),this.query=null,this.container=null,this.warnMsg={PHONE_NUM_INVALID:"抱歉，您输入的手机号验证失败。",SMS_USER_SHIELD:"您的帐号由于异常操作，已暂停其使用发送短信的功能，如有问题，请和我们联系。",SMS_LACK:"抱歉，您今日发送的短信已达到5次的上限。",SMS_POI_SHIELD:"抱歉，该地点由于异常操作，已被屏蔽，如有问题，请和我们联系。",SMS_SEND_FAIL:"发送失败，请重试",SMS_SEND_SUCCESS:"发送成功，两秒后窗口将关闭",INTERNAL_ERROR:"抱歉，连接失败，请稍候重试！",PARAM_INVALID:"抱歉，无法找到该兴趣点!",SYS_ERROR:"系统错误！",SEND_ING:"短信正在发送中，请稍候！",UNKNOWN:"抱歉，未知错误，请稍候重试！"},this.txtMsg="备注（最大支持30个字） 举例：亲，6点下班后在这个地点聚哦。",this.errorMsg={PHONE_ERROR:"手机号码错误",PHONE_REPEAT:"请勿输入重复手机号",CODE_ERROR:"验证码错误",CODE_EMPTY:"请输入验证码",SMS_LACK:"已达每日5次短信上限",PHONE_LIMIT:"该手机号达到今日接收上限"},this.staData={phones:[],idnum:0,errorDelay:null,vcode:""},this.selectedPnl=0,this.isBMWDataLoaded=!1,this.uid="",this.bmwData="",this.bmwVCode="",this.userName=""}var BaseComponent=require("common:widget/com/BaseComponent.js"),constants=require("common:widget/ui/constant/Constant.js"),smsMgr=require("common:widget/ui/sms/sms.js"),UserMgr=require("common:widget/ui/userMgr/userMgr.js"),vCode=function(){function e(t){a.push(t),t.onclick=e.refresh}var t="/v",a=[];return e.refresh=function(){T.ajax(t+"&t="+(new Date).getTime(),{dataType:"json",success:function(i,s){if(s.slow?ErrorMonitor("vcode","req_slow"+s.slow,t,void 0,{xhr:s,url:t,type:"slow"}):ErrorMonitor("vcode","succ",t,void 0,{xhr:s,url:t,type:"succ"}),i){e.code=i.captcha_vcode_str;for(var n=0;n<a.length;n++)a[n].src=t+"/genimg/"+e.code+"&t="+(new Date).getTime()}},error:function(e){ErrorMonitor("vcode","req_fail",e.status,!0,{xhr:e,url:t,type:"fail"})}}),ErrorMonitor("vcode","BASE","",!0)},e}(),Placeholder=function(){function e(e,t){function a(){T.dom.hasClass(e,"placeholder")&&(e.value="",T.rc(e,"placeholder"))}function i(){""==e.value&&(e.value=t,T.ac(e,"placeholder"http://webmap1.map.bdstatic.com/newmap/static/common/widget/com/SMS/))}document.all?(i(),e.attachEvent("onblur",i),e.attachEvent("onfocus",a)):T(e).attr("placeholder",t)}return e}(),smsUtil={isMobilePhone:function(e){return/^(18|13|15|14|17)\d{9}/.test(e)},isBMWPhone:function(e){return/^((86)|(\+86))?(18|13|15|14)\d{9}/.test(e)},isEmpty:function(e){return!/\S+/.test(e)},isWord:function(e){return/^[a-zA-Z0-9]{4}$/.test(e)}};T.lang.inherits(SmS,BaseComponent,"SmS"),T.object.extend(SmS.prototype,{render:function(){try{var template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="stmp" id="sms_',"undefined"==typeof guid?"":guid,'">    <div class="sms_tab_container">        <div id="sms_tab_app" class="sms_tab_app sms_tab_selected" onclick="SMSInst.selectPnl(0)"><span class="sms_icon_phone"></span><span class="sms_word_app">发送到手机</span></div>        <div id="sms_tab_bmw" class="sms_tab_bmw" onclick="SMSInst.selectPnl(2)"><span class="sms_icon_bmw"></span><span class="sms_word_bmw">发送到汽车</span></div>    </div>    <div class="sms_pnl_app" id="sms_pnl_app">        <div id="app_sms_part">            <div class="ap app_phone_left">                <div class="line"><h6 class="direction">发送手机短信：</h6></div>                <div class="line"><input type="text" class="txt phone" id="phoneNumber" maxlength="11" tabindex="1"/><label id="lCheckPhone" for="chkPhone"><input type="checkbox" class="chkPhone" />记住此号</label></div>                <div class="line"><input type="text" id="txtVer" maxlength="4" class="txt verify" tabindex="5"/><img id="imgVer" class="verify" alt="点击更换数字" title="点击更换数字" src=""></div>                <div class="sms_content_small">                    <p id="msgContent" class="msgContent"></p>                </div>                <div class="line"><input id="App_btnSubmit" class="btn" type="button" tabindex="6" value="免费发送到手机"/></div>            </div>            <div id="sms_info_tip"><div class="sms_lack_tip_back"></div><span class="sms_lack_tip_in">免登陆用完，需要登录</span></div>            <div class="sms_lack_tip"><div class="sms_lack_tip_back"></div><span class="sms_lack_tip_in">已达每日5次短信上限</span></div>            <div id="sms_unlogin_tip0"></div>        </div>    </div>    <div id="sms_pnl_bmw" class="sms_pnl_bmw">        <div class="ap">            <dl>                                  <dd class="navigation_sel">                    <label id="bmw_lbl_addrname">地点：</label>                    <span id="bmw_poiName">&nbsp;</span>                </dd>                <dd class="navigation_sel" id="navigation_sel">                     <span onclick="SMSInst.selNavType(0)"><input type="radio" name="pertype" value ="原厂导航" checked="true" id="factory"><label for="factory">原厂导航</label></span><span onclick="SMSInst.selNavType(1)"><input type="radio" name="pertype" value ="自装导航" id="self_loading"><label for="self_loading">自装导航</label></span>                </dd>                <dd>                    <label class="bmw_lbl_type">品牌</label>                    <select id="bmw_type" onchange="SMSInst._selectCarType(this)">                          <option value="-1" selected="selected">请选择汽车品牌</option>                        <option value="1" id="iwangwh_bmw">宝马</option>                        <option value="101" id="iwangwh_byd">比亚迪</option>                        <option value="103" id="iwangwh_vw">大众进口</option>                        <option value="107" id="iwangwh_toyota">雷克萨斯/丰田(G-BOOK)</option>                        <option value="2" id="iwangwh_benz">梅赛德斯-奔驰</option>                        <option value="106" id="iwangwh_mini">MINI</option>                        <option value="109" id="iwangwh_qr">奇瑞</option>                        <option value="102" id="iwangwh_kia">起亚</option>                        <option value="108" id="iwangwh_wew">沃尔沃</option>                        <option value="102" id="iwangwh_hyundai">现代</option>                        <option value="105" id="iwangwh_infiniti">英菲尼迪</option>                    </select>                    <select id="bmw_type_self" style="display:none" onchange="SMSInst._selectCarType(this)">                          <option value="-1" selected="selected">请选择品牌</option>                        <option value="100" id="iwangwh_tm">钛马</option>                        <option value="104" id="iwangwh_kt">TCL康钛</option>                    </select>                    <span id="sms_car_logo"></span>                                    </dd>                <dd id="car_type_panel">                            <label id="bmw_lbl_phone">车友号</label>                    <input id="bmw_id" maxlength="50" />                    <input type="checkbox" checked="true" class="bmw_chk_remeber" id="bmw_remeber" style="display:none;"/>                    <label for="bmw_remeber" style="display:none;">设为默认</label>                </dd>                        <dd id="car_type_warn" style="display:none;">                    <span id="car_type_warntxt"></span>                </dd>                   <dd>                      <label id="bmw_lbl_intro">说明</label>                    <textArea id="bmw_txtArea" class="cbmw_txtArea qr_color" onkeyup="SMSInst.limitWords(this, event)" onkeydown="SMSInst.limitWords(this, event)" onblur="SMSInst.addAttachment()" maxlength="30">备注（最大支持30个字） 举例：亲，6点下班后在这个地点聚哦。</textArea>                </dd>                <dd>                       <label id="bmw_lbl_veri">验证码</label>                    <input id="bmw_txtVer" maxlength="4" class="txt verify"/><img id="bmw_imgVer" class="verify" alt="点击更换数字" title="点击更换数字" src="">                </dd>                <dd>                    <input id="bmw_Submit" onclick="SMSInst.sendToCar()" type="button" class="btn" value="免费发送到汽车"/>                </dd>            </dl>        </div>        <div class="sms_content_big">                 <p class="headline">发送内容：</p>            <p id="bmw_msgContent" class="msgContent bmw_msgContent"></p>        </div>    </div>    <div class="sms_download_phone" id="sms_download_phone">        <div class="smsLogo"><img src="',"../../../images/mapLogo50_631ca06.jpg"/*tpa=http://webmap1.map.bdstatic.com/newmap/static/common/images/mapLogo50_631ca06.jpg*/,'" width="50" height="50"/></div>        <div class="smsWord">            <div class="smsWordTop">下载手机地图</div>        </div><div class="smsBtnContainer"><a onclick="addStat(\'busscheme.blscheme.sendtombbyandroid\');PcToMobile.open(\'BTN\', \'短信窗口安卓按钮\', {qudao: \'1009177q\'});" class="smsPc2MoAndriod" href="http://www.baidu.com/search/error.html" alt="点击将安装包下载到电脑，通过数据线安装到手机" target="andriodApk"></a>&nbsp;&nbsp;<a onclick="addStat(\'busscheme.blscheme.sendtombbyios\');PcToMobile.open(\'BTN\', \'短信窗口ios按钮\');" class="smsPc2MoIphone" href="http://itunes.apple.com/cn/app/id452186370?ls=1&mt=8" alt="点击前往苹果官方商店下载" target="_blank"></a></div>    </div>    <div id="tipError" class="tip fail">        <span id="tipText"></span>        <a href="javascript:void(0)" id="tipClose" class="cut"></a>    </div>    </div><div id="shadeWarn" class="shade"></div><div id="tipWarn" class="tip warn"></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],style='.sms_tab_container{height:35px;background:#FCFCFC;position:relative;z-index:20}.sms_tab_bmw,.sms_tab_app{float:left;position:relative;height:35px;line-height:35px;text-align:center;cursor:pointer;font-size:14px;padding:0 12px;border-right:solid 1px #F2F2F2;_height:10px;_line-height:10px;_padding-top:10px;_padding-bottom:10px}.sms_tab_bmw{border-right:0}.sms_pnl_app{position:relative;z-index:10;height:281px;padding:30px 20px 10px 75px;border-top:solid 1px #F2F2F2}.sms_pnl_bmw{display:none;position:relative;zoom:1;z-index:10;height:281px;padding:28px 20px 10px;border-top:solid 1px #F2F2F2;zoom:1}.sms_download_phone{position:relative;margin:7px 20px 0;height:80px;zoom:1;border-top:#e5e5e5 1px solid}.sms_download_phone .smsLogo{float:left;padding:15px 15px 15px 24px}.sms_download_phone .smsWord{float:left;padding:28px 0 0}.sms_download_phone .smsWord .smsWordTop{font-family:"宋体";font-size:14px;line-height:24px}.sms_download_phone .smsWord .smsWordBottom{padding:0 0 0 14px;font-family:"宋体";font-size:12px;line-height:16px;color:#999;list-style:square}.smsPc2MoAndriod{display:inline-block;background-image:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pc2mo-btn_4a7761b.png);background-position:0 -54px;width:84px;height:26px}.smsPc2MoAndriod:hover{display:inline-block;background-image:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pc2mo-btn_4a7761b.png);background-position:-85px -54px;width:84px;height:26px}.smsPc2MoIphone{display:inline-block;background-image:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pc2mo-btn_4a7761b.png);background-position:0 -81px;width:84px;height:26px}.smsPc2MoIphone:hover{display:inline-block;background-image:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pc2mo-btn_4a7761b.png);background-position:-85px -81px;width:84px;height:26px}.sms_download_phone .smsBtnContainer{float:left;padding:27px 0 0 28px}.smsMoGoBtn{position:absolute;right:0;bottom:30px;background-image:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pcmoindex_d9f6cab.png);background-position:-1px -69px;width:16px;height:16px}.smsMoGoBtnTip{position:absolute;right:21px;bottom:30px;font-family:"宋体";font-size:12px;color:#e6e6e6}.smsMoGoBtnTip a{text-decoration:none;color:#3d6dcc}.smsMoGoBtnTip a:hover{text-decoration:underline;color:#3d6dcc}#sms_hLineContainer{padding:0 20px}.sms_baidu_logo{position:absolute;width:36px;height:36px;left:25px;top:15px;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -165px -296px}.sms_baidu_word{font-size:14px}.sms_baidu_download{padding-top:3px}.sms_icon_phone{display:inline-block;width:20px;height:18px;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -163px -333px;vertical-align:middle}.sms_icon_bmw{display:inline-block;width:20px;height:18px;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -183px -333px;vertical-align:middle}.sms_word_phone{vertical-align:middle}.sms_word_bmw{vertical-align:middle}.sms_tab_selected{background:#fff;height:36px;border:solid 1px #F2F2F2;border-top:0;border-bottom:0;font-weight:700;_height:10px}#bmw_id{width:150px;height:18px;line-height:18px;padding:0;padding-left:4px;margin:0;width:148px\\9;width:148px\\0;+width:148px;_width:148px}#bmw_type{width:158px;height:21px;line-height:21px;padding-left:2px}#bmw_type_self{width:158px;height:21px;line-height:21px;padding-left:6px}.stmp{overflow:hidden;position:relative}.stmp .ap{width:310px;position:absolute}.stmp .ap dt{margin-bottom:2px;_margin-bottom:0}.stmp .ap dd{position:relative;zoom:1;padding-left:85px;margin-bottom:5px;padding-top:5px}.stmp .ap dd.add{margin-bottom:6px}.stmp .ap input{vertical-align:middle}.stmp .ap input.txt{height:20px;line-height:20px;border:1px solid #a5acb2;font:400 13px/18px Arial,Helvetica,sans-serif;padding-left:1px}.stmp .ap input.phone{width:79px;ime-mode:disabled}.stmp .ap input.error{border-color:#eabb00}.stmp .ap input.verify{width:73px;height:20px;line-height:20px;ime-mode:disabled;padding-left:6px}#lCheckPhone{margin-left:2px}.stmp input.btn{width:158px;height:27px;padding:0;border:0;cursor:pointer;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) 0 -353px no-repeat;color:#fff;font-weight:500;font-family:"微软雅黑";font-size:13px;letter-spacing:2px;line-height:27px;_padding-top:3px;_margin:3px 0}.stmp input.btn:active{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -158px -353px no-repeat}.stmp .ap a.cut{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/bgs_6dbfd12.gif) -271px -48px no-repeat;width:11px;height:11px;display:inline-block;display:-moz-inline-stack;zoom:1;vertical-align:middle;margin-left:4px;overflow:hidden;*display:inline}.stmp .ap img.verify{vertical-align:middle;width:69px;height:20px;padding:1px 0;border:1px solid #a5acb2;margin-left:5px}.stmp .ap label{color:#4d4d4d;vertical-align:middle;width:79px;text-align:right}.stmp .ap dd label input{_vertical-align:baseline}.stmp .ap p{color:#707070}.stmp .ap dd.navigation_sel{padding:5px 0 5px 80px}.stmp .ap dd.navigation_sel input{vertical-align:-2px;*vertical-align:-1px}.stmp .ap dd.navigation_sel label{margin-right:10px}.sms_plane_sprite{position:absolute;left:66px;top:148px;width:131px;height:69px;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -192px -207px;z-index:-1;zoom:1}#bmw_poiName{height:15px;line-height:15px;padding-left:6px}.bmw_lbl_type,#bmw_lbl_phone,#bmw_lbl_intro,#bmw_lbl_veri{position:absolute;left:0;height:20px;line-height:20px}#bmw_lbl_addrname{position:absolute;left:5px;height:15px;line-height:15px;width:80px}#bmw_txtArea{width:146px;height:45px;margin:0;padding:5px;font-size:12px}#sms_car_logo{position:relative;top:2px;display:inline-block;width:16px;height:16px}#sms_car_logo.bmw{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -206px -280px;width:16px}#sms_car_logo.mini{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -230px -280px;width:37px}#sms_car_logo.vw{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -270px -325px;width:16px}#sms_car_logo.benz{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -204px -300px}#sms_car_logo.wew{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -292px -325px}#sms_car_logo.qr{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -268px -280px;width:43px}#sms_car_logo.byd{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -137px -333px;width:27px}#sms_car_logo.hyundai{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -137px -295px;width:27px}#sms_car_logo.tm{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -204px -326px}#sms_car_logo.kia{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -137px -312px;width:27px}#sms_car_logo.kt{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -224px -326px;width:37px}#sms_car_logo.infiniti{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -224px -300px;width:33px}#sms_car_logo.toyota{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png) -260px -300px;width:53px}#car_type_panel{display:none}.sms_lack_tip,#sms_info_tip{display:none;position:absolute;width:100%;height:100%;left:0;top:0;z-index:10}.sms_lack_tip_in{position:absolute;left:95px;top:120px;border:solid 1px #EABB00;background:#FDFDDD;color:#9C4200;padding:5px;width:150px;text-align:center}.sms_lack_tip_back{width:100%;height:100%;position:absolute;left:0;top:0;background:#fff;opacity:.8;filter:alpha(opacity=80)}#app_sms_part{display:block;position:absolute;left:50%;top:50%;margin-left:-228px;margin-top:-140.5px;width:444px;height:287px}.sms_pnl_app .qrimg{width:154px;height:241px;position:absolute;border-right:1px dotted #f0f0f0;margin-top:18px}.qrimg img{border:2px solid #eee;display:block;margin:auto;height:140px;width:140px;margin-bottom:9px}h6.direction{margin:0;color:#ff7200;font-family:微软雅黑;font-weight:700;font-size:14px}.qrimg h6.direction{margin-left:5px;margin-bottom:4px;position:relative;top:-4px}.qrtip{text-align:center;line-height:1.6;font-family:微软雅黑}.app_phone_left .line{margin-left:20px;margin-top:7px}.app_phone_left .line label.lbline{width:153px;display:block}.app_phone_left h6.direction{margin-top:15px}#sms_unlogin_tip0{background:#fff;position:relative}#pnl_phone_show{position:absolute;top:18px;left:234px}.sms_content_small{position:relative;left:20px;top:10px;width:242px;height:80px;padding:10px;padding-right:5px;padding-bottom:20px;background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/sms_content_bg_2bdcfb8.png) no-repeat}#msgContent{width:100%;height:66px;overflow-y:auto;overflow-x:hidden;white-space:normal}.sms_content_small .scrollbar-y{background:0 0}.sms_content_small .tangram-scrollbar-track{background:0 0}.sms_content_small .smsbacktrack{height:100%;width:2px;background:#cbdcdd;position:absolute;top:0;left:4px}.sms_content_big{margin-left:319px;margin-top:24px;width:198px;height:154px;zoom:1;padding:20px;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/sms_98b5dcf.png);_height:140px}.sms_content_big .headline{font-weight:bolder;margin-bottom:10px}#pnl_phone_left{margin-left:40px}.sms_pnl_bmw .ap{margin-left:11px;*margin-left:-300px}.qr_color{color:#999}#car_type_warn{height:12px;line-height:12px;padding-top:0}#car_type_warn span{color:#f21000}';require.loadCss({content:style,name:"SMS"});var templateObj={guid:this.guid};return template(templateObj)}catch(e){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/com/SMS/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/SMS/SMS.js",ln:177})}},initialize:function(){try{var e=this,t=smsMgr.config.READY_URL+e.cinfo.tplUrl+encodeURIComponent("&smsf=1")+e.cinfo.curUrl+"&t="+(new Date).getTime();e.uid=e.cinfo.uid,window.currentComponent.removeTipOnResultPage&&window.currentComponent.removeTipOnResultPage(T.G("defCityTip")),T("#pnl_phone_show .caseBus,#pnl_phone_show .caseNav,#pnl_phone_show .casePoi0,#pnl_phone_show .casePoi1").hide(),"bt"http://webmap1.map.bdstatic.com/newmap/static/common/widget/com/SMS/==e.uid?(T(".caseBus").show(),e.type="bt"):"nav"http://webmap1.map.bdstatic.com/newmap/static/common/widget/com/SMS/==e.uid?(T(".caseNav").show(),e.type="nav"):e.cinfo.uidType?(T(".casePoi1").show(),e.type="poi"):(T(".casePoi0").show(),e.type="poi_poor");var a=e.cinfo.type;T.g("sms_tab_bmw").style.display="bt"==e.uid||"nav"==e.uid||a==constants.POI_TYPE_BUSLINE||a==constants.POI_TYPE_SUBLINE?"none":"block",T.ajax(t,{dataType:"json",success:function(a,i){a&&(i.slow?ErrorMonitor("sms","req_slow"+i.slow,t,!0,{xhr:i,type:"slow",url:t}):ErrorMonitor("sms","succ",t,!0,{xhr:i,type:"succ",url:t}),e._exeData(a),e.cinfo&&e.cinfo.target&&"发至汽车"==e.cinfo.target.title&&e.selectPnl(2))},error:function(a){ErrorMonitor("sms","req_fail",a.status,!0,{xhr:a,type:"fail",url:t}),e._exeData({error:"INTERNAL_ERROR"})}}),ErrorMonitor("sms","BASE","",!0),e.userName=T.g("username")?T.g("username").innerHTML:"";var i=T("#bmw_txtArea");i.val(e.txtMsg),i.focus(function(){i.val()==e.txtMsg&&(i.val(""),i.removeClass("qr_color"))}),i.blur(function(){i.val()||(i.addClass("qr_color"),i.val(e.txtMsg))})}catch(s){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/com/SMS/exception.fire","catch",{msg:s.message||s.description,path:"common:widget/com/SMS/SMS.js",ln:278})}},_exeData:function(e){if(!e.error){this.cinfo.infoWin.show();var t=this;switch(e.type){case"LOGIN_NEED":var a=e.short_url||this.cinfo.oldUrl;e.app_free||(T.g("sms_info_tip").style.display="block",setTimeout(function(){T.g("sms_unlogin_tip0").style.display="block",T.g("sms_info_tip").style.display="none",UserMgr.login(T.g("sms_unlogin_tip0"),a)},1e3)),T.g("lCheckPhone").style.display="none",this.onReady(e);break;case"SMS_USER_SHIELD":this._showWarn("SMS_USER_SHIELD");break;case"SMS_LACK":e.res_sms&&"0"!=e.res_sms?this._showError(this.staData.phones[this.staData.phones.length-1],!0,"今日剩余短信数量"+e.res_sms+"次，请减少发送数量"):(T("img.verify").hide(),T(".sms_lack_tip").show());break;case"SMS_POI_SHIELD":this._showWarn("SMS_POI_SHIELD");break;case"PHONE_NUM_INVALID":this._showWarn("PHONE_NUM_INVALID");break;case"VCODE_VERITY_FAIL":this._showError(T.G("txtVer"),!0,"CODE_ERROR"),T.G("txtVer").focus();break;case"OK":this._showWarn("OK"),this.onReady(e);break;case"SMS_SEND_FAIL":this._showWarn("SMS_SEND_FAIL");break;case"SMS_SEND_SUCCESS":this._showWarn("SMS_SEND_SUCCESS"),addStat("sendtodevice.sendtomb.sendtombsucess"),window.setTimeout(function(){t.cinfo.infoWin.config.close(),t.cinfo.infoWin.close()},2e3);break;case"PHONE_LIMIT":this._showError(T.g("phoneNumber"),!0,"PHONE_LIMIT");default:return}}},onReady:function(e){addStat("sendtodevice.sendtomb.sendtombready");var t=this;vCode(T.g("imgVer")),vCode(T.g("bmw_imgVer")),vCode.refresh(),T("#msgContent").text(e.sms_content_new);new baidu.ui.ScrollPanel({container:"msgContent",overflow:"overflow-y",autoUpdate:!0,margin:[0,0,0,0]});T(".sms_content_small .tangram-scrollbar-slider").prepend('<div class="smsbacktrack"></div>'),T(".sms_content_small")[0].onmousewheel=function(e){e.stopPropagation()},e.phone&&(T.g("phoneNumber").value=e.phone,T(".chkPhone")[0].checked=!0),Placeholder(T.g("phoneNumber"),"手机号码"),Placeholder(T.g("txtVer"),"验证码"),T.G("App_btnSubmit").onclick=function(){t._checkInfo()&&t._sendInfo()}},_checkInfo:function(){return this._checkPhone(T.G("phoneNumber"))&&this._checkCode(T.G("txtVer"))?!0:!1},_checkCode:function(e){return this._showError(e,smsUtil.isEmpty(e.value),"CODE_EMPTY")&&this._showError(e,!smsUtil.isWord(e.value),"CODE_ERROR")},_checkPhone:function(e){return this._showError(e,!smsUtil.isMobilePhone(e.value),"PHONE_ERROR")},_showWarn:function(e){T.G("shadeWarn").style.display=e&&"OK"==e?"none":"block",T.G("tipWarn").style.display=e&&"OK"==e?"none":"block",T.G("tipWarn").innerHTML=e&&"OK"==e?"":this.warnMsg[e]},_showError:function(e,t,a){var i=this,s=T.G("tipError"),n=T.G("tipText"),o=T.G("tipClose");if(t){"SMS_LACK"!=a&&T.ac(e,"error");var p=i.calcDisFromParent(e,T(".stmp")[0]);return s.style.display="block",s.style.left=p.width+"px",s.style.top=p.height+24+"px",n.innerHTML=this.errorMsg[a]?this.errorMsg[a]:a,i.staData.errorDelay&&window.clearTimeout(i.staData.errorDelay),this.staData.errorDelay=window.setTimeout(o.onclick=function(){s.style.display="none",i.staData.errorDelay&&window.clearTimeout(i.staData.errorDelay)},3e3),window.setTimeout(function(){e.focus()},10),!1}return s.style.display="none",T.rc(e,"error"),!0},_getPost:function(){var e="url="+this.cinfo.tplUrl+"&smsf=1&";return 0==this.selectedPnl&&(e+="phone[0]="+T.g("phoneNumber").value+"&"),e+=T(".chkPhone")[0].checked?"remember=true&":"",e+="vcode="+vCode.code+"&code_input="+T.g("txtVer").value,e+="&tuan=false"},_sendInfo:function(){var e=this;T.ajax(smsMgr.config.NEWSEND_URL,{method:"post",dataType:"json",data:e._getPost(),success:function(t){t=t||{},window.setTimeout(function(){e._showWarn("OK"),e._exeData(t)},1e3)},error:function(){e._showWarn("SEND_ING")}})},selectPnl:function(e){if(this.selectedPnl!=e){this.selectedPnl=e;var t=T("#sms_tab_app").removeClass("sms_tab_selected"),a=T("#sms_tab_bmw").removeClass("sms_tab_selected"),i=T("#sms_pnl_app").hide(),s=T("#sms_pnl_bmw").hide();0==e?(t.addClass("sms_tab_selected"),i.show()):(a.addClass("sms_tab_selected"),s.show(),this.isBMWDataLoaded||(this.loadBMWPnlData(),this.isBMWDataLoaded=!0))}},loadBMWPnlData:function(){var e=this;if(UserMgr.userState&&"s2ctest"===UserMgr.userState.displayname){var t=new Option("s2ctest",102);t.id="iwangwh_s2ctest",baidu.G("bmw_type").options.add(t)}var a=baidu.cookie.get("bmwPhoneInfo");if(a&&"-1"!=a){{var i,s=a.split(";"),n=s[0],o=s[1];baidu.G("bmw_type")}i=baidu.G("iwangwh_"+n),i&&(i.selected="selected",e._selectCarType(baidu.G("bmw_type")),baidu.G("bmw_id").value=o,baidu.G("bmw_remeber").checked=!0)}var p=smsMgr.config.BMW_INFO+"&uid="+this.uid+"&t="+(new Date).getTime();baidu.ajax(p,{dataType:"json",success:function(t){t=t||{};var a,i,s,n=t.content,o="";a=n.name?n.name:"",i=n.addr?n.addr:"",s=n.tel?n.tel:"",a&&(o+=a+"<br/>"),i&&(o+="地址: "+i+"<br/>"),s&&(o+="电话: "+s+"<br/>"),e.bmwData=o,baidu.G("bmw_poiName").innerHTML=a,baidu.G("bmw_msgContent").innerHTML=o},error:function(){}})},_selectCarType:function(e){var t=baidu.G("sms_car_logo"),a=baidu.G("bmw_lbl_phone"),i=(T("#bmw_id"),e.options[e.selectedIndex]),s=parseInt(i.value);if(s&&-1!=s)switch(baidu.G("car_type_panel").style.display="block","iwangwh_qr"http://webmap1.map.bdstatic.com/newmap/static/common/widget/com/SMS/==i.id?(T("#car_type_warntxt").html("仅限Cloudrive用户"),T("#car_type_warn").show()):"block"==T("#car_type_warn").css("display")&&T("#car_type_warn").hide(),i.id){case"iwangwh_bmw":t.className="bmw",a.innerHTML="手机";break;case"iwangwh_wew":t.className="wew",a.innerHTML="邮箱/VIN";break;case"iwangwh_qr":t.className="qr",a.innerHTML="手机";break;case"iwangwh_benz":t.className="benz",a.innerHTML="手机";break;case"iwangwh_byd":t.className="byd",a.innerHTML="车牌号";break;case"iwangwh_hyundai":t.className="hyundai",a.innerHTML="BlueLink ID";break;case"iwangwh_kia":t.className="kia",a.innerHTML="UVO ID";break;case"iwangwh_s2ctest":t.className="s2ctest",a.innerHTML="carid";break;case"iwangwh_tm":t.className="tm",a.innerHTML="手机";break;case"iwangwh_kt":t.className="kt",a.innerHTML="车友号/手机";break;case"iwangwh_infiniti":t.className="infiniti",a.innerHTML="邮箱";break;case"iwangwh_toyota":t.className="toyota",a.innerHTML="车主ID/电话";break;case"iwangwh_mini":t.className="mini",a.innerHTML="手机";break;case"iwangwh_vw":t.className="vw",a.innerHTML="手机"}else t.className="",baidu.G("car_type_panel").style.display="none"},limitWords:function(e,t){if(e.value.length>70){e.value=e.value.substr(0,70);var a=window.event||t;a.returnValue=!1}},addAttachment:function(){if(baidu.trim(baidu.G("bmw_txtArea").value).length>0){var e="说明: "+T.string.encodeHTML(baidu.G("bmw_txtArea").value),t=this.bmwData+e;baidu.G("bmw_msgContent").innerHTML=t}else baidu.G("bmw_msgContent").innerHTML=this.bmwData},remeberBMWNo:function(){if(1==baidu.G("bmw_remeber").checked){var e=baidu.G("bmw_type"),t=e.options[e.selectedIndex].id.split("_")[1],a=baidu.trim(baidu.G("bmw_id").value),i=t+";"+a;baidu.cookie.set("bmwPhoneInfo",i,{expires:2592e3})}else baidu.cookie.set("bmwPhoneInfo","-1",{expires:-2592e3})},sendToCar:function(){var e=baidu.G("bmw_type"),t=baidu.G("bmw_type_self"),a=e.options[e.selectedIndex].value,i=t.options[t.selectedIndex].value;if(-1==a&&-1==i)return void this.showBMWError(e,"请选择汽车品牌");var s=baidu.G("bmw_id"),n=baidu.G("bmw_lbl_phone").innerHTML,o="";if(smsUtil.isEmpty(s.value))return"手机"==n?o="请输入手机号":n&&(o="请输入"+n),void this.showBMWError(s,o);baidu.rc(s,"error");var p=baidu.G("bmw_txtVer");if(smsUtil.isEmpty(p.value))return void this.showBMWError(p,"请输入验证码");if(!smsUtil.isWord(p.value))return void this.showBMWError(p,"验证码错误");baidu.rc(p,"error");var r=this.uid,l=T.string.encodeHTML(s.value),d=baidu.G("bmw_type"),c=d.options[d.selectedIndex].value;"sent2carbmw"==this.userName.substr(0,11)?c="99":"s2ctest"==this.userName.substr(0,7)&&(c="88");var m;m=baidu.G("bmw_txtArea").value==this.txtMsg?"":T.string.encodeHTML(baidu.trim(baidu.G("bmw_txtArea").value))||"";var _=p.value,h=smsMgr.config.BMW_DATA_URL,b="",g=T("#bmw_type_self option");if(b=1==T.g("factory").checked?"":"self",1==T.g("self_loading").checked)for(var u=0,w=g.length;w>u;u++)g[u].selected&&(c=g[u].value);this.carType=c;var x="uid="+r+"&carid="+l+"&cartype="+c+"&atta="+m+"&usercode="+_+"&vcode="+vCode.code+"&navType="+b+"&t="+(new Date).getTime();this.sendBMWData(h,x),this.remeberBMWNo()},loadXMLString:function(e){var t,a;try{return a=new ActiveXObject("Microsoft.XMLDOM"),a.async=!1,a.loadXML(e),a}catch(i){try{return t=new DOMParser,a=t.parseFromString(e,"text/xml")}catch(i){}}},sendBMWData:function(e,t){var a=this;a.showWarn("发送中，请稍候！"),T.ajax(e,{method:"post",data:t,dataType:"xml",success:function(e,t){if(""!==t.responseText)var i=a.loadXMLString(t.responseText);a.sendBMWCallback(t.responseXML||i)},error:function(){a.showWarn("抱歉，连接失败，请稍候重试"),window.setTimeout(function(){a.closeWarn()},2e3)}})},sendBMWCallback:function(e){var t,a=this;switch(t=e?a.parseStatus(e):200){case 200:this.showWarn("发送成功，两秒后窗口将关闭"),window.setTimeout(function(){addStat("sendtodevice.sendtocar.sendtocarsucess","show",{da_par:a.carType}),a.closeWarn(),a.closePnl()},2e3);break;case 440:var i=baidu.G("bmw_txtVer");this.closeWarn(),this.showBMWError(i,"验证码错误!");break;default:this.showWarn("发送失败，请重试"),window.setTimeout(function(){a.closeWarn()},2e3)}},parseStatus:function(e){var t=200;try{if(0==e.getElementsByTagName("response").length)return 200;t=this.isIE()>0?e.getElementsByTagName("response")[0].text:e.getElementsByTagName("response")[0].textContent}catch(a){return 450}return parseInt(t)},selNavType:function(e){0==e?(T("#bmw_type").show(),T("#bmw_type_self").hide(),this._selectCarType(T("#bmw_type")[0])):(T("#bmw_type").hide(),T("#bmw_type_self").show(),this._selectCarType(T("#bmw_type_self")[0]),T("#car_type_warn").hide())},showBMWError:function(e,t){var a=this,i=T.g("tipError"),s=T.g("tipText"),n=T.g("tipClose"),o=a.calcDisFromParent(e,T(".stmp")[0]);i.style.display="block",i.style.left=o.width+"px",i.style.top=o.height+24+"px",baidu.ac(e,"error"),s.innerHTML=t,a.staData.errorDelay&&window.clearTimeout(a.staData.errorDelay),this.staData.errorDelay=window.setTimeout(n.onclick=function(){i.style.display="none",a.staData.errorDelay&&window.clearTimeout(a.staData.errorDelay)},3e3),window.setTimeout(function(){e.focus()},10)},closePnl:function(){this.cinfo.infoWin.config.close(),this.cinfo.infoWin.close()},showWarn:function(e){baidu.G("shadeWarn").style.display="block",baidu.G("tipWarn").style.display="block",baidu.G("tipWarn").innerHTML=e},closeWarn:function(){baidu.G("shadeWarn").style.display="none",baidu.G("tipWarn").style.display="none",baidu.G("tipWarn").innerHTML=""},isIE:function(){return/MSIE (\d+(\.\d+)?)/.test(navigator.userAgent)?RegExp.$1:0},calcDisFromParent:function(e,t){for(var a=0,i=0;;)if(a+=e.offsetTop,i+=e.offsetLeft,e=e.offsetParent,e==t)break;return{height:a,width:i}}}),module.exports=SmS});