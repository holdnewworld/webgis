define("common:widget/pano/module/PanoOverviewModule/PanoIndoorPlanComponent/PanoIndoorOverlayComponent/PanoIndoorOverlayComponent.js",function(e,t,n){function o(e){this._position={x:e.x,y:e.y},this._angle=this._direction=e.angle||190,this._dom=e.dom,this._zIndex=e.zIndex,this._moving=!1,this._arrowDirection="-168px -72px",this._rotating=!1;var t=baidu.dom.getPosition(this._dom);this._domTop=t.top,this._domLeft=t.left,this._opts={enableDragging:!0,anchor:{width:-52,height:-52}},this.DIV_ROTATE_DIRECTION=[[0,-19,-64],[22.5,-203,-59],[45,-391,-59],[67.5,-581,-58],[90,-778,-55],[112.5,-979,-50],[135,-1178,-55],[157.5,-1387,-51],[180,-1611,-60],[202.5,-1821,-61],[225,-2030,-65],[247.5,-2243,-73],[270,-2457,-62],[292.5,-2685,-65],[315,-2901,-70],[337.5,-3120,-70]],this.initialize()}baidu.lang.inherits(o,baidu.lang.Class,"PanoIndoorOverlayComponent"),baidu.object.extend(o.prototype,{initialize:function(){try{var e=this,t=e._container=document.createElement("div"),n=document.createElement("div"),o="url(http://webmap1.map.bdstatic.com/newmap/static/common/images/panorama/pano_markers_1f7469f.png)";e._div=t,e._arrow=n,e._bgu=o,e._setDefCursor(),baidu.extend(t.style,{position:"absolute",zIndex:e._zIndex,backgroundRepeat:"no-repeat",cursor:"pointer",backgroundPosition:"-560px -36px",height:"104px",width:"104px"}),baidu(t).addClass("pano-fan"),baidu.extend(n.style,{position:"absolute",backgroundRepeat:"no-repeat",cursor:"pointer",backgroundPosition:"0 0",height:"24px",width:"24px",left:"34px",marginTop:"32px"}),baidu(n).addClass("pano-overlay-ie"),t.appendChild(n),e._dom.appendChild(t),e.draw(),e.setDirection(e._direction)}catch(i){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/pano/module/PanoOverviewModule/PanoIndoorPlanComponent/PanoIndoorOverlayComponent/exception.fire","catch",{msg:i.message||i.description,path:"common:widget/pano/module/PanoOverviewModule/PanoIndoorPlanComponent/PanoIndoorOverlayComponent/PanoIndoorOverlayComponent.js",ln:102})}},draw:function(){var e=this._opts.anchor,t=this._position;void 0==t.x&&(t.x=0),void 0==t.y&&(t.y=0),this._container.style.left=t.x+e.width+"px",this._container.style.top=t.y+e.height+"px"},enableDragging:function(){this._opts.enableDragging=!0},disableDragging:function(){this._opts.enableDragging=!1},getPosition:function(){return this._position},setPosition:function(e){this._position=e,this.draw()},getDirection:function(){return this._direction},setDirection:function(e){if(!isNaN(e)){var t=this._direction=e;this._getRotateDirection(t)}},remove:function(){me._dispatchEvent(this,"onremove"),this._container&&_purge(this._container),this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container)},_setDefCursor:function(){T.browser.firefox?(this.defaultCursor="-moz-grab",this.draggingCursor="-moz-grabbing"):T.browser.chrome||T.browser.safari?(this.defaultCursor="url(http://webmap0.map.bdstatic.com/newmap/static/common/images/api/openhand.cur) 8 8, default",this.draggingCursor="url(http://webmap1.map.bdstatic.com/newmap/static/common/images/api/closedhand.cur) 8 8, default"):(this.defaultCursor="url(http://webmap0.map.bdstatic.com/newmap/static/common/images/api/openhand.cur)",this.draggingCursor="url(http://webmap1.map.bdstatic.com/newmap/static/common/images/api/closedhand.cur)")},_getRotateDirection:function(e){if(!isNaN(e)){var t=this.DIV_ROTATE_DIRECTION,n=0,o=e-31.75,i=t.length;if(o>t[i-1][0])this._div.style.backgroundPosition=t[i-1][1]+"px "+d[i-1][2]+"px";else for(var n=0;i>n;n++)if(o<t[n][0]){this._div.style.backgroundPosition=t[n][1]+"px "+t[n][2]+"px";break}}},_getMoveDirection:function(e,t){if(!isNaN(e)&&!isNaN(t)){var n=-1,o=e-this.preX;return this.preX>5&&0>o?n=0:this.preX>5&&o>0&&(n=1),this.preX=e,this.preY=t,n}},_setEventDispath:function(){function e(e){var e=window.event||e,t=e.pageX||e.clientX||0,n=e.pageY||e.clientY||0,o={x:t,y:n};return{point:o}}var t=this,n=t._container,o=t._arrow,i=t._dom,a=(t._angle,!1),r=!1,s=null;o.onmousedown=function(a){var u=e(a);return o.setCapture?(baidu.on(o,"onmousemove",d),baidu.on(o,"onmouseup",p)):(baidu.on(i,"onmousemove",d),baidu.on(i,"onmouseup",p)),t._opts.enableDragging?(s=u.point,t._dispatchEvent(t,"ondragstart",{point:t._position}),r=!0,o.style.cursor=t.draggingCursor,baidu(n).removeClass("pano-overlay-ie"),o.setCapture&&o.setCapture(),i.style.MozUserSelect="none",i.style.KhtmlUserSelect="none",i.style.WebkitUserSelect="none",i.unselectable="on",i.onselectstart=function(){return!1},void t._stopAndPrevent(a)):void t._stopAndPrevent(a)},n.onmousedown=function(e){i.style.MozUserSelect="none",i.style.KhtmlUserSelect="none",i.style.WebkitUserSelect="none",i.unselectable="on",i.onselectstart=function(){return!1},t._stopAndPrevent(e)};var p=function(u){e(u);return o.releaseCapture?(baidu.un(o,"onmousemove",d),baidu.un(o,"onmouseup",p)):(baidu.un(i,"onmousemove",d),baidu.un(i,"onmouseup",p)),t._opts.enableDragging?(o.releaseCapture&&o.releaseCapture(),o.style.backgroundPosition=t._arrowDirection,baidu(n).addClass("pano-overlay-ie"),o.style.cursor="pointer",clearInterval(t._viewtypetimer),t._dispatchEvent(t,"ondragend",{point:t._position}),r=!1,a=!1,s=null,i.style.MozUserSelect="",i.style.KhtmlUserSelect="",i.style.WebkitUserSelect="",i.unselectable="off",i.onselectstart=function(){},void t._stopAndPrevent(u)):void t._stopAndPrevent(u)},d=function(n){if(t._opts.enableDragging&&r){var o=e(n),i=t._position,a=o.point.x-s.x+i.x,p=o.point.y-s.y+i.y;s=o.point,t._position={x:a,y:p},t.draw(),t._dispatchEvent(t,"ondragging",{point:t._position}),t._stopAndPrevent(n)}}},_dispatchEvent:function(e,t,n){0!=t.indexOf("on")&&(t="on"+t);var o=new baidu.lang.Event(t);if(n)for(var i in n)o[i]=n[i];e.dispatchEvent(o)},_purge:function(e){if(e){var t=e.attributes,n="";if(t)for(var o=0,i=t.length;i>o;o++)n=t[o].name,"function"==typeof e[n]&&(e[n]=null);var a=e.childnodes;if(a)for(var o=0,i=a.length;i>o;o++)me._purge(e.childnodes[o])}},_stopAndPrevent:function(e){var e=window.event||e;baidu.event.preventDefault(e),baidu.event.stopPropagation(e)}}),n.exports=o});