define("common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",function(require,exports,module){var util=require("common:widget/pano/base/util.js"),ModuleClass=require("common:widget/pano/base/ModuleClass.js"),Animation=require("common:widget/ui/Animation/Animation.js"),LAYER_TEMPLATE=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="photo-container" class="">    <div id="photo-return-btn">        <a class="pano_button" href="javascript:void(0);">            <span></span><em>返回</em>        </a>    </div>    <div id="photo-photo-wrapper"></div>    <div id="photo-expand-wrapper" style="display: none">        <ul id="photo-sidebar" style="bottom: 20px;">            <li id="photo-share-btn" class="pano_share_btn"><a class="pano_button" title="点击分享该场景照片游" href="javascript:void(0);"><span></span></a></li>             <!--<li id="photo-fold-btn">            <a class="pano_button" title="折叠功能区" href="javascript:void(0)"><span></span></a>            </li>  收起按钮, 默认是禁止的 -->        </ul>        <div id="photo-overview-wrapper"></div>                <div id="photo-footer">            <div id="photo-funcarea"  isinit=\'1\' class="clearfix pano_funcarea_hide" style="bottom: -120px;">                                            </div>            <div id="photo-tips">                <div class="pano-copyright">                        <span id="tourNameTip">北京市故宫</span>                        <span>|</span>                                <span><a target="_blank" class="pano-feedback" href="../../../../../../../../map.baidu.com/pano/feedback/index.html"/*tpa=http://map.baidu.com/pano/feedback/index.html*/ style="display:inline;">反馈问题</a></span>                    <span>拍摄日期：2014.05.21</span>                </div>            </div>        </div>    </div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];require.loadCss({content:"#photo-container{position:absolute;overflow:hidden;top:0;left:0;width:100%;height:100%;background-color:#eee;z-index:100100;min-width:960px}#photo-photo-wrapper{position:absolute;width:100%;height:100%;z-index:100102;background-color:#000}#photo-sidebar{position:absolute;right:12px;width:34px;z-index:100110;line-height:0;bottom:140px}.pano_unfold_func{font-size:0}#photo-footer{position:absolute;width:100%;bottom:0;background-color:#000;z-index:100105}#photo-footer .photo-func-item{position:absolute}#photo-funcarea{padding-left:0;width:100%;background-color:#000;font-size:0;position:absolute;height:120px;bottom:15px}.pano_unfold_func{font-size:12px}.pano_funcarea_hide{}#photo-tips{width:100%;text-align:right;overflow:hidden;line-height:20px;font-size:12px;color:#797979;background-color:#000;position:absolute;bottom:0}#photo-tips span{font-size:12px}#photo-overview-wrapper{position:absolute;left:10px;bottom:20px;width:300px;height:106px;z-index:100110;visibility:hidden;border:2px solid #3D4145}#photo-overview-holder{width:300px;margin-right:10px}.photo-ui-layer{width:0;height:0;position:absolute;left:0;top:0;z-index:100111}#photo-return-btn{position:absolute;top:13px;left:13px;z-index:200002}#photo-return-btn .pano_button{background-color:#000;width:auto;text-decoration:none}#photo-return-btn .pano_button em{line-height:34px;height:34px;vertical-align:top;color:gray;font-style:normal;display:inline-block;text-decoration:none;margin-right:12px;font-size:12px}#photo-return-btn .pano_button span{background-image:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/album_aae0aec.png);width:11px;height:18px;background-position:-98px -80px}#photo-return-btn .pano_button:hover span{background-position:-79px -80px}#photo-return-btn .pano_button:hover em{color:#3af}.pano-copyright{text-align:right;padding-right:30px;display:inline-block}.pano-copyright span{margin-left:10px}.pano-copyright a{text-decoration:none;color:#797979}.pano-copyright .pano-feedback{text-decoration:underline;color:#3af}.pano_share_btn{margin-top:3px}.pano_share_btn .pano_button span{background-position:-108px 1px}.pano_share_btn .pano_button:hover span{background-position:-127px 1px}#photo-fold-btn .pano_button{height:25px;border-radius:2px 2px 0 0}#photo-fold-btn .pano_button span{width:18px;height:18px;margin:3px 8px}#photo-fold-btn .pano_button span{background-position:-72px -18px}#photo-fold-btn .pano_button:hover span{background-position:-90px -18px}.pano_unfold_sidebar #photo-fold-btn .pano_button span{background-position:-36px -18px}.pano_unfold_sidebar #photo-fold-btn .pano_button:hover span{background-position:-54px -18px}#photo-fold-btn{margin-top:3px}"});var layeroutResizeTimer=null,isUserHideAlbum=!1,PhotoTourLayoutManager=ModuleClass.extend("PhotoTourLayoutManager",{constructor:function(){},initialize:function(o){try{this._container=o,this.render()}catch(t){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/pano/PhotoTour/PhotoTourLayout/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:28})}},render:function(){try{var o=LAYER_TEMPLATE();this._tourLayoutContainer=T(o)[0],T(this._container).append(this._tourLayoutContainer),this.appendFoldBtn(T.g("photo-sidebar")),T.g("photo-container").onselectstart=function(){return!1}}catch(t){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/pano/PhotoTour/PhotoTourLayout/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:39})}},appendFoldBtn:function(o){var t=T.dom.create("li",{id:"photo-fold-btn","class":"fold_btn"});t.innerHTML='<a class="pano_button" title="折叠功能区" href="javascript:void(0)"><span></span></a>',o.appendChild(t);var n=this;T.on(t,"click",function(o){o.stopPropagation();o.target;n._toggleFoldArea(),n.dispatchEvent("fold_state_changed",{data:T("#photo-sidebar").hasClass("pano_unfold_sidebar")})}),T.on(T.g("photo-expand-wrapper"),"mouseup",function(o){o.stopPropagation()}),T.on(T.g("photo-expand-wrapper"),"mousedown",function(o){o.stopPropagation()})},getContainer:function(o){switch(o){case"tour":return T.g("photo-photo-wrapper");case"guide":return T.g("photo-funcarea");case"return":return T.g("photo-return-btn");case"expand":return T.g("photo-expand-wrapper");case"share":return T.g("photo-share-btn");default:return null}},updateCopyRight:function(o){var t=T.g("tourNameTip");t.innerHTML=o},showExpandArea:function(){this.getContainer("expand").style.display="block",this._toggleFoldArea(!0)},hideExpandArea:function(){this.getContainer("expand").style.display="none"},_toggleFoldArea:function(o){var t=T("#photo-fold-btn .pano_button"),n=T("#photo-funcarea"),a=T("#photo-sidebar"),e=n.hasClass("pano_funcarea_hide");if(!(o===!0&&!e||o===!1&&e)){var i=new Animation.Animation,p={duration:400,fps:40,delay:Animation.Animation.INFINITE,transition:Animation.Transitions.easeOutQuad,finish:function(){},render:function(){try{}catch(o){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/pano/PhotoTour/PhotoTourLayout/exception.fire","catch",{msg:o.message||o.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:120})}}},r=(T("#pano-footer"),parseInt(n.css("height"))),s=parseInt(T("#photo-tips").css("height")),d=n.children();util.each(d,function(o){util.setOpacity(o,0)});var u,h;o===!0||void 0===o&&e?(n.removeClass("pano_funcarea_hide"),a.addClass("pano_unfold_sidebar"),t.attr("title","折叠功能区"),u=r,p.render=function(o){try{a.css("bottom",s+o*u+"px"),n.css("bottom",s+(o-1)*u+"px"),util.each(d,function(t){util.setOpacity(t,o)})}catch(t){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/pano/PhotoTour/PhotoTourLayout/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:146})}}):(n.addClass("pano_funcarea_hide"),a.removeClass("pano_unfold_sidebar"),t.attr("title","展开功能区"),h=r+s,u=h-s,p.render=function(o){try{a.css("bottom",h-o*u+"px"),n.css("bottom",-o*r+"px"),util.each(d,function(t){util.setOpacity(t,1-o)})}catch(t){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/pano/PhotoTour/PhotoTourLayout/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:161})}},p.finish=function(){util.each(d,function(o){util.setOpacity(o,1)})}),i.build(p),i.start()}},dispose:function(){this._container.removeChild(this._tourLayoutContainer)}});module.exports=PhotoTourLayoutManager});