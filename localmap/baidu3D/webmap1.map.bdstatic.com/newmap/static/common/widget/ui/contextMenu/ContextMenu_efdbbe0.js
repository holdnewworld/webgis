define("common:widget/ui/contextMenu/ContextMenu.js",function(n,e,t){function o(){var e=function(n){i.loadTPMAsync("RouteAddr"==window.currentComponent._className?1==s._curSelIndex||2==s._curSelIndex?function(){i.load("BusTrans",{dom:["a"],cinfo:{isPos:!0,destFlag:0,point:n},record:!1,isMainRequest:"no"})}:function(){i.load("NavTrans",{dom:["a"],cinfo:{isPos:!0,destFlag:0,point:n},record:!1,isMainRequest:"no"})}:s._curSelIndex<3?function(){i.load("BusTrans",{dom:["a"],cinfo:{isPos:!0,destFlag:0,point:n},record:!1,isMainRequest:"no"})}:function(){i.load("NavTrans",{dom:["a"],cinfo:{isPos:!0,destFlag:0,point:n},record:!1,isMainRequest:"no"})}),addStat("poiinfowin.rightmenu.starthere")},t=function(e){addStat("poiinfowin.rightmenu.passthroughhere"),s._curSelIndex<3&&s.setSwitchTab(3),n.async("common:widget/ui/throughpoint/Throughpoint.js",function(n){n.addTPointByPoint(e)})},o=function(n){if(addStat("poiinfowin.rightmenu.goinghere"),"RouteAddr"==window.currentComponent._className){var e=n.lng+","+n.lat,t=window.currentComponent||{};i.go("sd&pt="+e+"&r=5000",t.getCMEnd,n)}else s._curSelIndex<3?i.load("BusTrans",{dom:["a"],cinfo:{isPos:!0,destFlag:1,point:n},record:!1,isMainRequest:"no"}):i.load("NavTrans",{dom:["a"],cinfo:{isPos:!0,destFlag:1,point:n},record:!1,isMainRequest:"no"})},d=function(e){n.async("common:widget/ui/searchInfoWindow/searchInfoWindow.js",function(n){var t=e,o=n.addRangeSearchCenterPoi(t),a=n.createRangeInfoWnd(t);a.addEventListener("close",function(){n.exitRangeSearch(),a.overlay&&a.overlay.remove()}),a.addEventListener("open",function(){window.GRControll&&window.GRControll.setGRequestFlg(1500),map.addEventListener("moveend",function(){setTimeout(function(){if(T.g("rangekw"))try{T.g("rangekw").focus()}catch(n){}},100),map.removeEventListener("moveend",arguments.callee)})}),n.openSearchInfoWnd(a,o,{pano:!0,panoPoint:t})}),addStat("poiinfowin.rightmenu.searchnb")},r=function(n){map.zoomIn(n),addStat("poiinfowin.rightmenu.zoomin")},c=function(n){map.zoomOut(n),addStat("poiinfowin.rightmenu.zoomout")},m=function(n){map.panTo(n),addStat("poiinfowin.rightmenu.centrehere")},u=a([{text:"<span id='cmitem_start'> 以此为起点</span>",callback:e,width:90},{text:"<span id='cmitem_pass'> 以此为途经点</span>",callback:t,width:90},{text:"<span id='cmitem_end'> 以此为终点</span>",callback:o,width:90},{separator:!0},{text:"<span id='cmitem_nsearch'> 在此点附近找...</span>",callback:d,width:90},{separator:!0},{text:"<span id='cmitem_zoomin'>放大</span>",callback:r,width:70},{text:"<span id='cmitem_zoomout'>缩小</span>",callback:c,width:70},{text:"<span id='cmitem_center'>居中</span>",callback:m,width:70}]);return map.addEventListener("maptypechange",function(){this.getMapType()==BMAP_NORMAL_MAP?u.enable():this.getMapType()==BMAP_PERSPECTIVE_MAP&&u.disable()}),u.addEventListener("open",function(){if(!window.currentComponent||"RouteAddr"!=window.currentComponent._className){var e=this;this.getItem(0)&&this.getItem(0).enable(),this.getItem(2)&&this.getItem(2).enable(),map.getZoom()<10?this.getItem(3).disable():this.getItem(3).enable(),map.getZoom()==map.config.zoomLevelMax?this.getItem(4).disable():this.getItem(4).enable(),map.getZoom()==map.config.zoomLevelMin?this.getItem(5).disable():this.getItem(5).enable(),n.async("common:widget/ui/throughpoint/Throughpoint.js",function(n){n.onContextMenu()?e.getItem(1).enable():e.getItem(1).disable()})}}),u}function a(n,e,t){var o=new BMap.ContextMenu({container:e});e&&e!==map?o.initialize(map):map.addContextMenu(o);for(var a=0,i=n.length;i>a;a++){var s=n[a];s.separator?o.addSeparator():o.addItem(new BMap.MenuItem(s.text,s.callback||function(){},{width:s.width||100,id:s.id}))}return o.setCursor(t),o}var i=n("common:widget/com/componentManager.js"),s=(n("common:widget/ui/mapInfo/mapInfo.js"),n("common:widget/ui/searchBox/searchBox.js")),d={init:function(){var n=o();return n},create:function(n,e,t){var o=a(n,e,t);return o},destroy:function(n){n&&n.destroy&&(n.destroy(),n=null)}};t.exports=d});