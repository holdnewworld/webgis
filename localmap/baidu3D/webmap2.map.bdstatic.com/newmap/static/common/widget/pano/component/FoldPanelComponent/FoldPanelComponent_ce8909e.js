define("common:widget/pano/component/FoldPanelComponent/FoldPanelComponent.js",function(t,e,i){function n(t,e,i){T.lang.Class.call(this);var n=this._opts=s.merge(f,i);this._parentNode=e,this._titleNode=t,this._anim=null,this.status=u.folded;var o=this._panelContainer=document.createElement("div");o.className="fold-panel-container";var l=this._contentContainer=document.createElement("div");l.setAttribute("role","contentContainer"),l.className="fold-panel-content",l.style.cssText=["position:absolute","padding:"+p].join(";");var a=this._contentHeader=document.createElement("div");a.style.cssText=["position: relative","z-index: 2"].join(";"),l.appendChild(a);var r=this._contentWapper=document.createElement("div");r.className="content-wapper",l.appendChild(r);var h=this._bgDom=document.createElement("div");h.className="fold-panel-bg";var d=[("left"==n.align?"left":"right")+":0"];s.isIE()?(d.push("filter:alpha(opacity=90)"),d.push("_filter:alpha(opacity=90)"),d.push("background-color:rgb("+n.backgroundColor+")")):d.push("background-color:rgba("+n.backgroundColor+", "+n.backgroundOpacity+")"),h.style.cssText=d.join(";"),l.appendChild(h);var m=this;s.each(c,function(t){T.on(o,t,function(e){m.dispatchEvent(t,e)})}),this._autoFoldTimer=null;var g=!1,y=function(){m.cancelDelayAction(),g||m.expand()},_=function(){m.cancelDelayAction(),g||(m._autoFoldTimer=setTimeout(function(){m.fold()},m._opts.foldDelay))};this.ignoreMouseEvent=function(t){g=!!t},m.addEventListener("mouseenter",y),m.addEventListener("mouseleave",_),T.on(t,"mouseenter",y),T.on(t,"mouseleave",_),o.appendChild(l),e.appendChild(o),this._titleNode.style.display="none"}var o=t("common:widget/ui/Animation/Animation.js"),s=t("common:widget/pano/base/util.js"),l=t("common:widget/pano/component/ScrollView/ScrollView.js");t.loadCss({content:".fold-panel-container{overflow:hidden;height:0;position:absolute;border-top:1px solid #53565d}.fold-panel-bg{z-index:0;position:absolute;width:100%;top:0;border-bottom-right-radius:2px;border-bottom-left-radius:2px}.content-wapper{z-index:10;position:relative}.fold-panel-content .scrollbar-y,.fold-panel-content .scrollbar-y-thumb-prev,.fold-panel-content .scrollbar-y-thumb-next,.fold-panel-content .scrollbar-y-prev,.fold-panel-content .scrollbar-y-next{background-image:none}.fold-panel-content .scrollbar-y-prev,.fold-panel-content .scrollbar-y-next{width:14px}.fold-panel-content .tangram-scrollbar-slider{margin:0 auto;border-radius:20px;background-color:#292c2f;opacity:.95;width:6px}.fold-panel-content .scrollbar-y-thumb-btn{margin:0 auto;width:4px;background:#B3B9C3;opacity:.3;border-radius:10px}",name:"FoldPanelComponent"});var a=150,r=100,h=300,d=40,c=["mouseenter","mouseleave","mouseover","mouseout","click"],p="6px 0",u={expanded:2,folded:-2,playing:1},f={backgroundColor:"37,37,37",backgroundOpacity:"0.9",foldDelay:1500,panelWidth:"auto",maxHeight:400,align:"right"},m=function(){},g=function(t,e,i,n,s){var l,c,p,u=t._titleNode,f=20,g=u.clientWidth,y=t._bgDom,_=y.clientHeight,b=y.clientWidth,v=n>i,C=!v,x=function(){v?(y.style.width=b+"px",y.style.height=_+"px",y.style.top=""):(y.style.width=b+"px",y.style.height="0",y.style.top="",y.parentNode.firstChild.style.visibility=""),s&&s()},w=function(){var e=new o.Animation,i=(t._bgDom.clientWidth,-f);return v&&(y.style.width=g+"px",y.style.height=f+"px",i=parseInt(_)+i,y.style.top=i+"px"),e.build({onStop:v?x:m,fps:d,delay:o.Animation.INFINITE,duration:a,render:function(t){try{C&&(t=1-t),y.style.top=i+f*t+"px"}catch(e){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/component/FoldPanelComponent/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/pano/component/FoldPanelComponent/FoldPanelComponent.js",ln:101})}},finish:function(){C&&(y.style.width=b+"px",y.style.height=_+"px",y.style.top="",y.parentNode.firstChild.style.visibility="")}}),e},D=function(){var t=new o.Animation,e=b-g;return t.build({delay:o.Animation.INFINITE,fps:d,duration:r,render:function(t){try{C&&(t=1-t),y.style.width=g+e*t+"px"}catch(i){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/component/FoldPanelComponent/exception.fire","catch",{msg:i.message||i.description,path:"common:widget/pano/component/FoldPanelComponent/FoldPanelComponent.js",ln:128})}},finish:function(){v?(y.style.width=b+"px",y.style.height=_+"px",y.style.top=""):y.parentNode.firstChild.style.visibility="hidden"}}),t},N=function(){var s=new o.Animation,l=t._contentContainer,a=n-i;return s.build({onStop:C?x:m,delay:o.Animation.INFINITE,fps:d,transition:o.Transitions["ease-out"],duration:h,render:function(t){try{C||(T(l).find(".tangram-scrollpanel").css("visibility","visible"),T(l).find(".pano_poi_content").css("visibility","visible")),l.style[e]=i+a*t+"px"}catch(n){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/component/FoldPanelComponent/exception.fire","catch",{msg:n.message||n.description,path:"common:widget/pano/component/FoldPanelComponent/FoldPanelComponent.js",ln:159})}},finish:function(){T(l).find(".tangram-scrollpanel").css("visibility","hidden"),T(l).find(".pano_poi_content").css("visibility","hidden")}}),s};return y.parentNode.firstChild.style.visibility="","top"===t._opts.align?(p=N(),p.setFinishCallback(s),p.start(),p):v?(i+=f,l=w(),c=D(),p=N(),l.add(c),l.add(p),l.setFinishCallback(s),l.start(),l):(n+=f,l=w(),c=D(),p=N(),p.add(c),p.add(l),p.setFinishCallback(s),p.start(),p)};baidu.lang.inherits(n,baidu.lang.Class),T.object.extend(n.prototype,{setTitle:function(t){var e=this._titleNode;if(!t)return void(e.style.display="none");for(;e.lastChild;)e.removeChild(e.lastChild);if("string"==typeof t){var i=t;t=document.createElement("div"),t.innerHTML=i}e.style.display="",this._testTitle=t,e.appendChild(t)},setContentHeader:function(t){"string"==typeof t&&(t=s.trim(t),t=T(t)[0]);for(var e=this._contentHeader;e.lastChild;)e.removeChild(e.lastChild);e.appendChild(t)},setContent:function(t,e){for(var i=(this._contentWapper,this._contentWapper);i.lastChild;)i.removeChild(i.lastChild);"string"==typeof t&&(t=s.trim(t),t=T(t)[0]),t&&i.appendChild(t),i.style.height="auto",this._contentContainer.style.height="auto";var i=this._contentWapper,n=i.offsetHeight;if(0===n){var o=s.getDomSize(i);n=o.height}var a=e||this._opts.maxHeight,r=s.getDomSize(this._contentHeader);if(a-=r.height,n>a){if(i.style.height=a+"px",!this._scrollView){this._scrollView=new l(i,{overflow:"overflow-y",autoUpdate:!1});var h=T(this._contentContainer).find(".tangram-scrollpanel-main")[0];h.style.zIndex="1",h.style.position="relative"}}else i.style.height=n;this._scrollView&&this._scrollView.update(),this._panelContainer.style.height=this._bgDom.style.height=this._contentContainer.offsetHeight+"px",this.resize(),this._testContent=i.children[0]},setPosition:function(t,e){this._panelContainer.style.left=t+"px",this._panelContainer.style.top=e+"px"},toggle:function(){return this.status>0?this.fold():this.expand()},expand:function(t){this.cancelDelayAction();var e=this,i=this._contentContainer,n=this._ch,o=-n;t&&(e._autoFoldTimer=setTimeout(function(){e.fold()},t)),this.status>0||-1!==this.status&&(this.status=u.playing,this._panelContainer.style.height=this._bgDom.style.height=n+"px",this._panelContainer.style.width=this._bgDom.style.width=i.offsetWidth+"px",this._panelContainer.style.borderTop="1px solid #53565d",this.dispatchEvent("before_expand"),this._contentContainer.style.top=-n+"px",this._anim=g(this,"top",o,0,function(){e.status=u.expanded,e.dispatchEvent("after_expand")}))},fold:function(t){this.cancelDelayAction();var e=0;if(t)return this._anim&&this._anim.stop(!0),this.status=u.folded,this._panelContainer.style.height=this._bgDom.style.height="0",this._panelContainer.style.border="0",this.dispatchEvent("before_fold"),void this.dispatchEvent("after_fold");if(!(this.status<0)&&1!==this.status){var i=this;this.status=-u.playing,this.dispatchEvent("before_fold"),this._anim=g(this,"top",e,-this._panelContainer.clientHeight,function(){i.status=u.folded,i._panelContainer.style.height=i._bgDom.style.height="0",i._panelContainer.style.border="0",i.dispatchEvent("after_fold")})}},setAlign:function(t){var e=this._bgDom;e.style.left="",e.style.right="","left"===t||"top"===t?this._bgDom.style.left="0":this._bgDom.style.right="0",this._opts.align=t},resize:function(){this._scrollView&&this._scrollView.update();var t=s.getDomSize(this._contentContainer);this._cw=t.width,this._ch=t.height,this._scrollView&&(this._cw+=this._scrollView.getScrollBarWidth())},cancelDelayAction:function(){this._autoFoldTimer&&clearTimeout(this._autoFoldTimer)},scrollTo:function(t){this._scrollView&&this._scrollView.scrollTo(t)},getScrollValue:function(){return this._scrollView?this._scrollView.getScrollValue():void 0},getViewSize:function(){return{width:this._contentWapper.clientWidth,height:this._contentWapper.clientHeight}},$:function(t){return T(t,this._contentWapper)},dispose:function(){this.cancelDelayAction(),this._anim&&this._anim.stop(!0),T.dom(this._panelContainer).off(),y=null,T.lang.Class.prototype.dispose.call(this)},save:function(){y={contentDom:this._testContent.cloneNode(!0),titleDom:this._testTitle.cloneNode(!0)}},restore:function(){this.cancelDelayAction(),this._anim&&this._anim.stop(!0),y?(this.setTitle(y.titleDom),this.setContent(y.contentDom)):(this.setTitle(""),this.setContent("")),this.fold(!0)}});var y=null;i.exports=n});