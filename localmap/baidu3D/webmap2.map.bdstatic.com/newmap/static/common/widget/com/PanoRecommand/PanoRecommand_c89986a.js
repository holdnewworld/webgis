define("common:widget/com/PanoRecommand/PanoRecommand.js",function(require,exports,module){function PanoRecommand(e){MapComponent.call(this,e),this.cinfo=this.cinfo||{},this.panel=null,this.indexRecLoaded=!1,this.isOpen=!1}var config=require("common:widget/ui/config/config.js"),MapComponent=require("common:widget/com/MapComponent.js"),mapInfoScrollPanel=require("common:widget/ui/mapInfoScroll/mapInfoScroll.js"),Animation=require("common:widget/ui/Animation/Animation.js"),PanoUtil=require("common:widget/ui/PanoUtil/PanoUtil.js"),PanoInterface=require("common:widget/pano/PanoInterface/PanoInterface.js"),comMgr=require("common:widget/com/componentManager.js");T.lang.inherits(PanoRecommand,MapComponent,"PanoRecommand"),T.object.extend(PanoRecommand.prototype,{render:function(){try{var me=this,template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push('<div id="street_recommend">    '),recomData.ad){_template_fun_array.push("                ");for(var index=0;index<recomData.ad.length;index++)_template_fun_array.push('                    <div id="recomAd">                        <a href="',"undefined"==typeof recomData.ad[index].linkUrl?"":recomData.ad[index].linkUrl,'" target="_blank" class="recom_ad">                            <img src="',"undefined"==typeof recomData.ad[index].imageUrl?"":recomData.ad[index].imageUrl,'" alt="',"undefined"http://webmap2.map.bdstatic.com/newmap/static/common/widget/com/PanoRecommand/==typeof recomData.ad[index].name?"":recomData.ad[index].name,'"  width="318" height="88" />                                            </a>                    </div>                ');_template_fun_array.push("    ")}if(_template_fun_array.push('    <p class="title">推荐城市</p>    <div id="recomCont-wraper">        <div id="recomCont">            '),recomData.cityList){_template_fun_array.push("                ");for(var index=0;index<recomData.cityList.length;index++)_template_fun_array.push('                    <div class="site_city ',"undefined"==typeof(index%2==0?"even":"odd")?"":index%2==0?"even":"odd",'">                        <div class="inner" data-value=',"undefined"==typeof index?"":index,'>                            <img src="',"undefined"==typeof recomData.cityList[index].imageUrl?"":recomData.cityList[index].imageUrl,'" width="144" height="80" />                            <div></div>                            <p class="pano_cname">',"undefined"http://webmap2.map.bdstatic.com/newmap/static/common/widget/com/PanoRecommand/==typeof recomData.cityList[index].name?"":recomData.cityList[index].name,"</p>                            "),1==recomData.cityList[index].isNew&&1!=recomData.cityList[index].isBeta&&_template_fun_array.push('                                <span class="pano_new"></span>                            '),_template_fun_array.push("                            "),1==recomData.cityList[index].isBeta&&_template_fun_array.push('                                <span class="pano_beta"></span>                            '),_template_fun_array.push("                                                            </div>                               </div>                ");_template_fun_array.push("            ")}_template_fun_array.push('        </div>    </div>    <div class="bottom_link">        <a href="http://nlbc.baidu.com/lbs-lbc/?from=mappano" target="_blank">商户全景上传</a>        <span>|</span>        <a href="http://developer.baidu.com/map/jshome.htm" target="_blank">全景API</a>        <span>|</span>        <a href="http://pai.baidu.com/" target="_blank">用户全景上传</a>    </div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],style="#street_recommend{z-index:1000;width:350px;_width:346px;margin:0 auto;overflow:hidden;position:absolute;top:0;left:-350px;display:block!important;font-family:'微软雅黑'}#street_recommend #recomCont-wraper{position:relative}#street_recommend #recomCont{width:330px;_width:328px;padding-left:12px}#street_recommend .title{font-size:14px;line-height:14px;color:#5179c4;margin:14px 0 12px 14px}#street_recommend .site_city{float:left;width:150px;border:1px #E6E6E6 solid;cursor:pointer}#street_recommend .even{margin:0 5px 10px 0}#street_recommend .odd{margin:0 0 10px 5px}#street_recommend .site_city .inner{font-size:14px;color:#fff;overflow:hidden;position:relative;margin:3px;width:144px;height:80px}#street_recommend .site_city .inner div{width:144px;height:20px;background-color:#000;opacity:.5;filter:alpha(opacity=40);overflow:hidden;position:absolute;left:0;bottom:0;line-height:20px}#street_recommend .site_city .inner p{width:144px;height:20px;margin-left:10px;font-size:12px;font-family:'宋体';color:#fff;overflow:hidden;position:absolute;left:0;bottom:0;line-height:20px}#street_recommend .bottom_link{text-align:center;padding:14px 0;font-size:12px}#street_recommend a{color:gray;text-decoration:none}#street_recommend a:hover{color:gray;text-decoration:underline}#street_recommend span{padding:0 14px}#street_recommend span.pano_new{display:block;position:absolute;top:-1px;right:-2px;width:45px;height:45px;padding:0;margin:0;z-index:200;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/panorama/pano_theme_c4dbfa7.png) no-repeat 0 0;_background-image:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/panorama/pano_theme_8_20ed703.png)}#street_recommend span.pano_beta{display:block;position:absolute;top:-2px;right:-2px;width:45px;height:45px;padding:0;margin:0;z-index:200;background-image:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/panorama/pano_beta_b049dea.png);_background-image:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/panorama/pano_beta_8_073575f.png)}";return require.loadCss({content:style,name:"PanoRecommand"}),template({recomData:me.cinfo.recomData})}catch(e){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/com/PanoRecommand/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/PanoRecommand/PanoRecommand.js",ln:37})}},initialize:function(){try{var e=this,a=(baidu.g("btn_home"),baidu.g("btn_return"),baidu.g("street_recommend"));if(e.EVENTS={},!a)return;{config.modelConfig,e.cinfo.recomData.cityList,(new Date).getTime()}this.createIndexRec(),this.trans(350,350),this.isOpen=!0}catch(t){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/com/PanoRecommand/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/com/PanoRecommand/PanoRecommand.js",ln:62})}},trans:function(e,a){var t=baidu.g("street_recommend");if(t){var n=new Animation.Animation;n.build({fps:100,transition:Animation.Transitions.linear,duration:300,render:function(n){try{t.style.left=e*n-a+"px"}catch(o){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/com/PanoRecommand/exception.fire","catch",{msg:o.message||o.description,path:"common:widget/com/PanoRecommand/PanoRecommand.js",ln:78})}},finish:function(){}})}},createIndexRec:function(){{var e=this;baidu.g("street_recommend")}mapInfoScrollPanel.hide(),e._setHeight(),e.panel=new baidu.ui.ScrollPanel({container:"recomCont-wraper",overflow:"overflow-y",autoUpdate:!1}),e.panel&&e.panel.render("recomCont-wraper"),e.panel.update(),baidu.on("recomCont","onclick",function(a){var t,n,o=a.target||a.srcElement,i=o.tagName.toLowerCase(),r=o.className;("img"==i||"inner"==r||"pano_cname"==r)&&(o=a.target.parentNode),t=parseInt(baidu(o).data("value")),isNaN(t)||(n=e.cinfo.recomData.cityList[t],e.redirectPano(n))}),e.EVENTS.updateScroller_onresize=function(){e._setHeight(),e.panel.update()},T.on(window,"onresize",e.EVENTS.updateScroller_onresize)},_setHeight:function(){var e=T.g("MapInfo").offsetHeight,a=baidu.g("street_recommend");a&&(a.style.height=e+"px"),T.g("recomCont-wraper")&&(T.g("recomCont-wraper").style.height=T.g("recomAd")?e-205+"px":e-90+"px")},redirectPano:function(e){PanoUtil.closePano();new BMap.Point(e.x/100,e.y/100);baidu.ajax("/?qt=panoReco&code="+e.citycode+"&ie=utf-8&t="+(new Date).getTime(),{dataType:"json",success:function(a){a?comMgr.go("cur&wd="+encodeURIComponent(e.name),{cinfo:{isFromPano:!0},onload:function(){comMgr.load("PanoTheme",{dom:"MapInfo",cinfo:{themeData:a},onload:function(){}})}}):PanoInterface.showPano({panoId:e.sid,panoType:e.type,point:new BMap.Point(e.x/100,e.y/100),panoHeading:e.heading,panoPitch:e.pitch,cityname:e.name})},error:function(){}})}}),module.exports=PanoRecommand});