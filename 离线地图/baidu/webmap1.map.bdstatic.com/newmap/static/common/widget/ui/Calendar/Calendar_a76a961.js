define("common:widget/ui/Calendar/Calendar.js",function(t,e,a){function n(e){var a=function(){},n=this,o=new Date,c=document.createElement("div"),i=o.getTime(),s=864e5,l=new Date(i),r=new Date(i+1*s);if(dateArr=[o.getFullYear(),o.getMonth()+1,o.getDate()],e.element?this.G(e.element).appendChild(c):document.body.appendChild(c),this.op={element:e.element,date:e.date||dateArr,today:e.today||dateArr,count:e.count||1,between:e.between||[0,99999999],input:this.G(e.input)||null,position:this.G(e.position),onStart:e.onStart||a,onShow:e.onShow||a,onHide:e.onHide||a,onSelectDay:e.onSelectDay||a,onChange:e.onChange||a,toInput:e.toInput,formInput:e.formInput,cur_btn:e.cur_btn||!1,cur_day:l,nxt_day:r},this.cache={cal:c,input:this.op.input,position:this.op.position||this.op.input,date:this.date(this.op.date),cur_date:[0,0,1],count:this.op.count,between:this.op.between,iframeHeight:null,iframeWidth:null,cells:[],heads:[],btns:[],tdBtns:[]},this.cache.input){this.addEvent(document.body,"click",function(){n.hide()}),this.addEvent(this.cache.cal,"click",function(){return!1},!0);var a=function(){n.op.formInput?n.op.formInput.call(n,n.cache.input):n.formInput.call(n,n.cache.input)};n.addEvent(n.cache.input,["click"],a,!0),this.hide()}this.op.onStart.call(this,this.cache.cal);var h="table.op_cal{border:1px solid #b5b5b5;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/wcal_tdbg_e97d4b7.gif) repeat-x left -125px;background-color:#f8f8f8}.op_btn_pre_month{cursor:pointer;float:left;display:block;width:15px;height:15px;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/wcal_tdbg_e97d4b7.gif) 2px -5px no-repeat;overflow:hidden;margin:5px 0 0 6px}.op_btn_next_month{cursor:pointer;float:right;display:block;width:15px;height:15px;background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/wcal_tdbg_e97d4b7.gif) 2px -30px no-repeat;overflow:hidden;margin:5px 6px 0 0}table.op_cal .op_mon{float:left;width:222px;padding:2px 5px 10px;display:inline}.op_mon_pre1 .op_mon{border-left:0}table.op_cal td{text-align:center;cursor:pointer;font-family:Arial;font-size:12px;height:20px;line-height:20px;padding:0}table.op_cal .op_mon th{text-align:center;font-size:12px;height:22px;line-height:22px;color:#b3b3b3;font-weight:400}table.op_cal .op_mon h5{margin:0;padding:0;text-align:center;line-height:30px;height:30px;overflow:hidden;font-size:14px;color:#41537b;margin-bottom:2px;overflow:hidden}table.op_cal .op_mon table{border-collapse:collapse}table.op_cal .op_mon table td{font-weight:700}table.op_cal .op_mon td.op_mon_pre_month{color:#999;border:1px solid #efefef}table.op_cal .op_mon td.op_mon_cur_month{color:#000;border:1px solid #efefef}table.op_cal .op_mon td.op_mon_next_month{color:#999;border:1px solid #efefef}table.op_cal .op_mon td.op_mon_day_selected{background:#eb4f03;color:#fff}table.op_cal .op_mon td.op_mon_day_disabled{cursor:not-allowed;color:#ddd;border:0}table.op_cal .op_mon td.op_mon_today{color:red}table.op_cal .op_mon td.op_mon_day_hover{background:#eb4f03;color:#fff}table.op_cal .op_mon td.op_cell_seledted{background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/wcal_tdbg_e97d4b7.gif) repeat-x left -79px;color:#fff}div.btn_day a{width:98px;height:23px;margin:8px 10px;cursor:pointer;border:0;display:inline-block;text-decoration:none;color:#666;line-height:23px}div.btn_day a.btn_today,div.btn_day a.btn_nxtday{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/bus_cal_bg_cc64c3a.png) no-repeat 0 0}div.btn_day a.btn_today:hover{background-position:-103px 0}div.btn_day a.btn_nxtday:hover{background-position:-103px 0}";t.loadCss({content:h,name:"Calendar"}),this.initHtml()}n.prototype={conf:{day_text:["日","一","二","三","四","五","六"],cal_text:["年","月","日"],cal_class:"op_cal",month_class_pre:"op_mon_pre",month_class:"op_mon",day_class:["op_mon_pre_month","op_mon_cur_month","op_mon_next_month","op_mon_today","op_mon_day_hover","op_mon_day_selected","op_mon_day_disabled"],btn_class:["op_btn_pre_month","op_btn_next_month"]},IE:/msie/.test(navigator.userAgent.toLowerCase())&&!/opera/.test(navigator.userAgent.toLowerCase()),G:function(t){return"string"==typeof t?document.getElementById(t):t},hasClass:function(t,e){for(var a=t.className.split(/s+/),n=0;n<a.length;n++)if(e==a[n])return!0;return!1},addClass:function(t,e){this.hasClass(t,e)||(""==t.className?t.className=e:t.className+=" "+e)},removeClass:function(t,e){for(var a=t.className.split(/\s+/),n=0;n<a.length;n++)e==a[n]&&a.splice(n,1);t.className=a.join(" ")},each:function(t,e){for(var a=0,n=t.length;n>a;a++)e.apply(t[a],[a,t[a]])},addEvent:function(t,e,a,n){var o=function(e){e=window.event||e,n&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0),a.call(t,e)},c=[].concat(e);this.each(c,function(e,a){document.attachEvent?t.attachEvent("on"+a,o):t.addEventListener(a,o,!1)})},days:function(t){function e(t){return("0"+t).slice(-2)}t=this.date(t);var a,n,o,c,i,s,l,r,h,d=[[],[],[]];a=t[0],n=t[1],s=new Date(a,n-1,0),l=new Date(a,n,0),r=new Date(a,n,1),h=l.getDate(),o=s.getMonth()+1,c=s.getDate(),i=r.getMonth()+1,a=l.getFullYear(),n=l.getMonth()+1;for(var p=s.getFullYear(),u=r.getFullYear(),f=s.getDay();f>=0;f--,c--)d[0].unshift([p,e(o),e(c)].join(""));for(var f=1;h>=f;f++)d[1].push([a,e(n),e(f)].join(""));for(var f=1,m=l.getDay(),_=d[0].length+d[1].length<36?14-m:7-m;_>f;f++)d[2].push([u,e(i),e(f)].join(""));return d},date:function(t){("string"==typeof t||"number"==typeof t)&&(t=t.toString().match(/^(\d+)(\d\d)(\d\d)$/),t.shift());var e=new Date(t[0],t[1]-1,t[2]);return[e.getFullYear(),e.getMonth()+1,e.getDate()]},initHtml:function(){for(var t=['<iframe src="about:blank" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" style="position:absolute;z-index:-1;left:0;top:0;width:1;height:1;"></iframe><table cellspacing="0" cellpadding="0" border="0" class="',this.conf.cal_class,'"><tr>'],e=this.op.cur_btn?'<div class="btn_day"><a href="javascript:void(0)" class="btn_today">今天</a><a href="javascript:void(0)" class="btn_nxtday">明天</a></div>':"",a=0;a<this.cache.count;a++){t.push('<td class="',this.conf.month_class_pre,a+1,'">',e,'<div class="',this.conf.month_class,'"><h5>',0==a?'<span class="'+this.conf.btn_class[0]+'"></span>':"",a==this.cache.count-1?'<span class="'+this.conf.btn_class[1]+'"></span>':"",'<strong></strong></h5><table width="100%" cellspacing="0"><tr>');for(var n=0;7>n;n++)t.push("<th>",this.conf.day_text[n],"</th>");t.push("</tr>");for(var o=0;6>o;o++){t.push("<tr>");for(var c=0;7>c;c++)t.push('<td week="',c,'"></td>');t.push("</tr>")}t.push("</table></div></td>")}t.push("</tr></table>");var i=this.cache;i.cal.innerHTML=t.join(""),this.each(i.cal.getElementsByTagName("td"),function(t,e){e.getAttribute("week")&&i.cells.push(e)}),this.each(i.cal.getElementsByTagName("strong"),function(t,e){i.heads.push(e)}),this.each(i.cal.getElementsByTagName("span"),function(t,e){i.btns.push(e)}),this.each(i.cal.getElementsByTagName("a"),function(t,e){i.tdBtns.push(e)}),this.setHtml(this.cache.date.concat()),this.setEvent()},setHtml:function(t){var e=[],a=0,n=this.cache,o=this;t=this.date(t),n.cur_date[0]=t[0],n.cur_date[1]=t[1];var c=o.date(o.op.today);c=""+c[0]+("0"+c[1]).slice(-2)+("0"+c[2]).slice(-2);for(var i=0;i<n.count;i++)e.push(this.days([n.cur_date[0],n.cur_date[1]+i,1]));for(var s=0;s<n.count;s++){var l=e[s][1][0].toString().match(/^(\d+)(\d\d)(\d\d)$/);n.heads[s].innerHTML=l[1]+o.conf.cal_text[0]+l[2]+o.conf.cal_text[1];for(var r=0;3>r;r++)for(var h=0;h<e[s][r].length;h++){var d=n.cells[a];d.innerHTML=e[s][r][h].toString().slice(-2)-0,d.setAttribute("date",e[s][r][h].toString()),d.className=this.conf.day_class[r],e[s][r][h]==c&&o.addClass(d,o.conf.day_class[3]),(e[s][r][h]<n.between[0]||e[s][r][h]>n.between[1])&&o.addClass(d,o.conf.day_class[6]),a++}}this.op.onChange.call(this);var p=this.formatDate(n.input);this.setDay(p)},setEvent:function(){function t(t){var e=t.getAttribute("date")-0;return e<=a.cache.between[1]&&e>=a.cache.between[0]?"normal":"disable"}var e=this.conf.day_class,a=this,n={normal:{mouseover:function(){a.addClass(this,e[4])},mouseout:function(){a.removeClass(this,e[4])},click:function(t,n){a.cache.selected&&a.removeClass(a.cache.selected,e[5]),a.cache.selected=this,a.addClass(this,e[5]),a.cache.input&&(a.op.toInput?a.op.toInput.call(a,t,n):a.toInput.call(a,t,n)),a.op.onSelectDay.call(a,t,n)}},disable:{mouseover:function(){return!1},mouseout:function(){return!1},click:function(){return!1}},btn:{0:function(){a.preMonth()},1:function(){a.nextMonth()}},td_btn:{0:function(){a.currentDay()},1:function(){a.nextDay()}}};this.each(this.cache.btns,function(t,e){e.onclick=function(){n.btn[t].call(e)}}),this.each(this.cache.tdBtns,function(t,e){e.onclick=function(){return n.td_btn[t].call(e,this),!1}}),this.each(this.cache.cells,function(e,a){a.onmouseover=function(){n[t(a)].mouseover.call(a)},a.onmouseout=function(){n[t(a)].mouseout.call(a)},a.onclick=function(){var e=a.getAttribute("date")-0,o=a.getAttribute("week")-0;n[t(a)].click.call(a,e,o)}})},show:function(){function t(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null)[e]}this.visible=!0,this.cache.cal.style.display="block";var e=this.cache;if(e.input){for(var a={position:"absolute",zIndex:"900"},n=e.position,o=n.offsetLeft,c=n.offsetTop+n.offsetHeight;n=n.offsetParent;){{t(n,"position")}o+=n.offsetLeft,c+=n.offsetTop}var i=1,s=-1;6==T.browser.ie&&(s=0),a.left=o+i+"px",a.top=c+s+"px";for(var l in a)e.cal.style[l]=a[l];e.iframeHeight=this.cache.cal.offsetHeight,e.iframeWidth=this.cache.cal.offsetWidth;var r=e.cal.getElementsByTagName("iframe")[0];r.style.height=e.iframeHeight+"px",r.style.width=e.iframeWidth+"px"}this.op.onShow.call(this,this.cache.cal);var h=this.formatDate(e.input);this.setHtml(h)},hide:function(){this.visible=!1,this.cache.cal.style.display="none",this.op.onHide.call(this,this.cache.cal)},nextMonth:function(){this.cache.cur_date[1]++,this.setHtml(this.cache.cur_date)},preMonth:function(){this.cache.cur_date[1]--,this.setHtml(this.cache.cur_date)},nextYear:function(){this.cache.cur_date[0]++,this.setHtml(this.cache.cur_date)},preYear:function(){this.cache.cur_date[0]--,this.setHtml(this.cache.cur_date)},setBetween:function(t){this.cache.between=t,this.setHtml(this.cache.cur_date)},isCurMonth:function(t){var t=this.date(t);return this.cache.cur_date[0]==t[0]&&this.cache.cur_date[1]==t[1]?!0:!1},setDay:function(t){var e=null;t=[].concat(t),this.each(t,function(e,a){t[e]=a.toString()});for(var a=this.cache.cells,n=0,o=a.length;o>n;n++)for(var c=0;c<t.length;c++)a[n].getAttribute("date")==t[c]&&this.hasClass(a[n],this.conf.day_class[1])&&(e=a[n],this.addClass(e,"op_cell_seledted"))},toInput:function(t){var e=this.cache.input;t=t.toString().match(/^(\d+)(\d\d)(\d\d)$/);var a=t[1]+"-"+t[2]+"-"+t[3];"input"==e.tagName.toLowerCase()?e.value=a:e.innerHTML=a,this.hide()},formInput:function(t){{var e;this.cache}e="input"==t.tagName.toLowerCase()?t.value:t.innerHTML;var a=e.match(/^(\d+)-(\d\d)-(\d\d)/);a&&4==a.length&&(a.shift(),this.isCurMonth(a)||this.setHtml(a)),this.show()},formatDate:function(){var t=this.cache.input.value.match(/^(\d+)-(\d\d)-(\d\d)/);return t&&4==t.length?parseInt(""+t[1]+t[2]+t[3]):!1},setDateValue:function(t){this.cache.input.value=T.date.format(t,"yyyy-MM-dd")},currentDay:function(){var t=this.op.cur_day;this.setDateValue(t);var e=T.date.format(t,"yyyyMMdd");this.setDay(e),this.op.onSelectDay.call(this,e),this.hide()},nextDay:function(){var t=this.op.nxt_day;this.setDateValue(t);var e=T.date.format(t,"yyyyMMdd");this.setDay(e),this.op.onSelectDay.call(this,e),this.hide()}},a.exports=n});