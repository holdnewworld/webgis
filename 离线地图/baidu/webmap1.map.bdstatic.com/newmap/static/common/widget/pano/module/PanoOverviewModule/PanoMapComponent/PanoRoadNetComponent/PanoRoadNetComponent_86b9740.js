define("common:widget/pano/module/PanoOverviewModule/PanoMapComponent/PanoRoadNetComponent/PanoRoadNetComponent.js",function(e,t,o){function a(e){baidu.lang.Class.call(this),this.map=e.map;var t=e.context.panoContext,o=t.getPanoUrlConfig();this.PANO_URL=o.PANO_ROAD_LAYER_URL,this.udtVersion=o.PANO_UDT_VERSION||"20130929",this.visible=!1,this.layerId=""}baidu.lang.inherits(a,baidu.lang.Class,"PanoRoadNetComponent"),baidu.object.extend(a.prototype,{show:function(){this.addLayer(),this.dispatchEvent("onshow",{visible:!0})},hide:function(){this.removeLayer(),this.dispatchEvent("onhide",{visible:!1})},isVisible:function(){return this.visible},addLayer:function(){var e=this,t=e.map;if(t&&!t.getTileLayer(e.layerId)){var o=!0,a=256,i=t.getMapType()==BMAP_NORMAL_MAP?"il":"sl",n=e.tilelayer=new BMap.TileLayer({transparentPng:o});n.zIndex=1,n.getTilesUrl=function(t,o){var n=BMap.MapType[this.getMapType()];if("object"!=typeof n||!t||0>o)return null;var r=Math.pow(2,18-o)*a,s=parseInt(t.lng/r),d=parseInt(t.lat/r),p=e.PANO_URL+"/tile/?udt="+e.udtVersion+"&qt=tile&styles="+i+"&x="+s+"&y="+d+"&z="+o;return T.browser.ie&&T.browser.ie<=6&&(p+="&color_dep=32"),p},t.addTileLayer(n),e.layerId=n.getMapType(),e.visible=!0,window.isPhotoTourSupported&&this.addPhotoTourLayer()}},addPhotoTourLayer:function(){var e={uid:"d270a38b230b50fced74f8f7",bound:{xmin:12958063,ymin:4826872,ymax:4826984,xmax:12958159},name:"故宫照片游",catalog:"street_1",type:"street",icon:{y:4826928,x:12958111}},t=new BMap.Marker(new BMap.Point(e.icon.x,e.icon.y),{icon:new BMap.Icon("../../../../../../../../../../webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/phototour_indoor_icon_59074d3.png"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/phototour_indoor_icon_59074d3.png*/,new BMap.Size(24,28),{offset:new BMap.Size(10,12),infoWindowOffset:new BMap.Size(5,0)}),zIndexFixed:!0,baseZIndex:3e6});this._photoMarker=t;var o=this;t.addEventListener("click",function(t){o.dispatchEvent("photo_tour_enter",{data:e.uid}),T.event.stopPropagation(t.domEvent)}),this.map.addOverlay(t)},removePhotoTourLayer:function(){this._photoMarker&&(this.map.removeOverlay(this._photoMarker),this._photoMarker=null)},removeLayer:function(){var e=this,t=e.map,o=t.getTileLayer(e.layerId);o&&(t.removeTileLayer(o),e.layerId=""),e.visible=!1,e.removePhotoTourLayer()},getLayerId:function(){return this.layerId},update:function(){this.removeLayer(),this.addLayer()}}),o.exports=a});