define("common:widget/pano/eventImplements.js",function(o,e,a){var n,t,r,i,d,l=o("common:widget/pano/base/MapContext.js"),u=o("common:widget/pano/base/PanoContext.js"),s=o("common:widget/pano/module/PanoShareModule/PanoShareModule.js"),p=(o("common:widget/pano/base/service.js"),o("common:widget/pano/module/PanoModule/PanoModule.js")),g=o("common:widget/pano/module/PanoToolModule/PanoToolModule.js"),P=o("common:widget/pano/module/PanoOverviewModule/PanoOverviewModule.js"),M=o("common:widget/pano/module/PanoGuideModule/PanoGuideModule.js"),c=o("common:widget/pano/module/PanoLayoutManager/PanoLayoutManager.js"),f=o("common:widget/pano/module/PanoCopyrightModule/PanoCopyrightModule.js"),v=o("common:widget/pano/module/PoiInfoPanelModule/PoiInfoPanelModule.js"),h=o("common:widget/pano/module/ClassifySearchModule/ClassifySearchModule.js"),m=(o("common:widget/pano/module/PanoIndoorPoiModule/PanoIndoorPoiModule.js"),o("common:widget/ui/indexUtil/IndexUtil.js"),o("common:widget/pano/model/PanoPoi.js")),y=o("common:widget/pano/base/util.js"),_=o("common:widget/pano/module/PanoLoading/PanoLoading.js"),C=o("common:widget/pano/Transition/Transition.js"),w=o("common:widget/pano/module/PanoShareModule/PanoShareUtil.js"),x=o("common:widget/com/componentManager.js"),I=null,b=1e4,S=function(e,a,n){Z.root.isEnterFromShareLink()&&(a=16);var t=e.currentPoint?new BMap.Point(e.currentPoint.x,e.currentPoint.y):new BMap.Point(e.panoMCPoint.x,e.panoMCPoint.y),r=m.getInstaceByPanoId(e.panoId);r&&(e.uid=r.getUid());var i=Z.root.getModule("PanoIndoorPoiModule");i&&"inter"==e.panoType&&(e.uid=i.getCurrentUid()),window.panoExitMarker?(window.panoExitMarker.show(e,t,a),n&&window.panoExitMarker.set("from",n)):o.async("common:widget/pano/module/PanoExitMarker/PanoExitMarker.js",function(o){var r=new o;r.initialize(e,t,a),window.panoExitMarker=r,n&&window.panoExitMarker.set("from",n)})},k=function(o,e){var a=Z.root.getModule("TrafficModule");L(),n.getCurrentCity(function(t){if(t)if(t.cityId!=n.getPCMapCity().cityId)x.go("cur&wd="+encodeURIComponent(t.cityName),{cinfo:{isFromPano:!0},onload:function(){S(o,e)}});else if(a){var r=null;a.isNav()?r="nav":a.isBus()?r="bus":a.isWalk()&&(r="walk"),S(o,e,r)}else S(o,e)})},O=!1,E=0,V=null,N=null,j=null,U={},A=function(o){U[o.type]?(o.source=U[o.type],U[o.type]=null):o.source="PanoModule"},R=function(o){var e=Z.root.getModule("PanoCopyrightModule"),a=r.getModuleContainer("PanoCopyrightModule");o.panoCopyright&&e&&("inter"===o.panoType?(e.render(a,o),B({uid:null,x:o.panoMCPoint.x,y:o.panoMCPoint.y})):n.getCurrentCity(function(n){n&&(o.panoCopyright.roadName=n.cityName+o.panoCopyright.roadName),e.render(a,o),B({uid:null,x:o.panoMCPoint.x,y:o.panoMCPoint.y})}))},B=function(o){function e(o,e){var a=T.g(o);e||!a?setTimeout(function(){a=T.g(o),a&&a.setAttribute("href",i)},1e3):a.setAttribute("href",i)}if(!o.uid){var a=Z.root.getModule("PanoModule").getPanoOptions();if("inter"==a.panoType){var n=Z.root.getModule("PanoIndoorPoiModule");n&&(o.uid=n.getCurrentUid())}else{var n=Z.root.getModule("PoiInfoPanelModule");if(n){var t=n.getDetailPanoPoi();t&&(o.uid=t.uid)}}}var r={uid:o.uid||"",location:o.x+","+o.y,from:"pcmap"},i=y.getUgcUploadUrl(r);e("pano-upload-link"),e("ugc-upload-item",!0),e("tool-ugc-upload")},D=function(){if(j!=location.hash){if("synchronise"==d)return void(d=null);var o=y.parseUrlParam(location.hash);if(o&&o.panoid&&o.panotype){var e=y.revertStreetView(o);e.panoShareParam&&(e.panoShareParam=decodeURIComponent(e.panoShareParam)),Z.showPano(null,e)}}},L=function(){function o(){var o=Z.root.getModule("PanoModule"),e=Z.root.getModule("PanoOverviewModule"),a={},t=[];if(o&&o.getPanoOptions()){a.data=o.getPanoOptions()||{},e&&(a.iid=e.getInnerId()),a.shareParam=Z.root.getShareParam(),a.level=n.getLevel();var r=w.prepareShareParam(a);for(var i in r)null!=r[i]&&t.push(i+"="+r[i]);j=t.join("&");var l=window.location;if("#"+j!=l.hash)if(d="synchronise",y.isSupportPushStatus()){var u="?"+j;history.replaceState({},0,u)}else l.hash=j}else y.isSupportPushStatus()&&history.replaceState({},0,location.pathname)}N&&clearTimeout(N),N=setTimeout(function(){o()},500)},F={_mask:null,_timouter:null,_init:function(){if(!this._mask){var o=this._mask=document.createElement("div");o.style.cssText=["top:0","left:0","position:absolute","width:100%","height:100%","background-color:black","filter:alpha(opacity=0)","opacity:0","z-index:200001"].join(";")}},dispose:function(){this._mask.parentNode.removeChild(this._mask),this._mask=null},show:function(){this._mask||F._init();var o=document.getElementById("pano-container");o.appendChild(this._mask),this._timouter=setTimeout(function(){F.hide()},8e3)},hide:function(){this._mask&&(null!==this._timouter&&clearTimeout(this._timouter),this._mask.parentNode&&this._mask.parentNode.removeChild(this._mask))}},z=void 0,G=void 0,H=!1,Y=void 0,W=[],Z={_initialize:function(){try{var o=Z.root.getModule();n=new l(o),t=new u(o),y.offHashChange(),y.onHashChange(D)}catch(e){"undefined"!=typeof alog&&alog("http://webmap1.map.bdstatic.com/newmap/static/common/widget/pano/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/pano/eventImplements.js",ln:355})}},showPano:function(o,e){var a=e.panoType;if(z=e.uid||e.poiUid,e.playRouteVideo&&(E=1),e.research===!0){var i=e.searchParam.uid,d=(e.searchParam.index,new m(i));return void d.extend(m.TYPE.pano).then(function(){var o=d.pano,n=void 0,t=e.searchParam.index;n=[{poiuid:i,pid:o.pid,panoIId:o.iid,poiType:o.belonging?"interPoi":"poi",name:o.name,index:void 0!==t?t:-1,heading:o.dir,pitch:o.pitch,x:o.x,y:o.y,px:o.panox,py:o.panoy,rank:o.rank||100,catalog:o.catalog}],o.belonging&&(G=i),Z.showPano(null,{panoMarkers:n,panoId:"street"==a?o.pid:o.belonging?o.pid:void 0,panoIId:"inter"==a?o.iid:void 0,uid:i,panoType:a,point:new BMap.Point(o.x/100,o.y/100),panoHeading:"inter"===a?void 0:o.dir,panoPitch:o.pitch})})}e.panoShareParam&&e.panoShareParam.PanoIndoorPoiModule&&"inter"==e.panoType&&(G=e.panoShareParam.PanoIndoorPoiModule.uid),r||(r=new c,r.initialize(Z.root.getModule(),document.body));var l=r.getModuleContainer("PanoModule"),u=t.getPanoUrlConfig(),s=[{module:p,args:[l,u,n]}],g=e.from;("nav"===g||"bus"===g||"walk"===g||"buswalk"===g||"share"===g)&&s.push({module:"TrafficModule",args:[g,e.panoShareParam,null,r.getModuleContainer("ui-layer"),[e],E]}),e.panoShareParam&&e.panoShareParam.VideoPlayer&&(Y=e.panoShareParam.VideoPlayer),e.panoShareParam&&e.panoShareParam.VideoPlayer&&y.isSupportVideo()&&s.push({module:"VideoPlayer",args:[e.panoShareParam.VideoPlayer]});var P=Z.root.bootstrap(s);P.then(function(){var o=Z.root.getModule("TrafficModule");if("share"!==g&&o&&o.isEnable()){var a=o.getClosestPoint(e.panoId,e.point.lat,e.point.lng);a&&(e.panoId=a.pid,e.point.lat=a.y,e.point.lng=a.x,e.panoHeading=a.dir),e.panoMarkers=[]}Z.root.getModule("PanoModule").showPano(e),r.getModuleContainer("PanoRoot").style.visibility="visible"})},closePano:function(){Z.root.shutdown(),r.getModuleContainer("PanoModule").innerHTML="",r.getModuleContainer("PanoRoot").style.visibility="hidden",r.dispose(),r=null,z=null,G=null,y.stopClock("panoVideoPlayTime"),location.hash="",y.offHashChange()},"PanoModule:pov_changed":function(o){A(o);var e=Z.root.getModule("PanoOverviewModule");e&&e.event_povChanged(o),L()},"PanoModule:zoom_changed":function(o){A(o);var e=Z.root.getModule("PanoToolModule");e&&e.updateFishBone(o.data),L()},"PanoModule:visible_changed":function(o){if(0==o.data.visible){var e=n.getOverviewLevel();o.data.panoOptions&&k(o.data.panoOptions,e),Z.closePano(),I=void 0,E=0}},"PanoModule:indoor_enter":function(o){var e,a=o.data.hasImage,t=!1;G?(e=G,G=null,H=!0,t=!0):e=o.data.poiuid;var i=new m(e);i.extend(m.TYPE.indoorPoi,m.TYPE.pano).then(function(){if(i.indoorPoi){var o=Z.root.getModule("PanoModule"),n=o.getPanoOptions();if(!n||"street"!==n.panoType){Z.root.safeCall("PoiInfoPanelModule","hide");var t=Z.root.getModule("PanoIndoorPoiModule");t?t.event_poi_change(i,e):Z.root.bootstrap({module:"PanoIndoorPoiModule",args:[r.getModuleContainer("PanoIndoorPoiModule"),i.indoorPoi,a,e]})}}}),Z.root.safeCall("PanoOverviewModule","event_indoorEnter",[o]),Z.root.safeCall("PanoToolModule","setClassifySearchVisible",[!1]);var d=Z.root.getModule("PanoGuideModule"),l=Z.root.getModule("TrafficModule"),u=Z.root.getModule("PanoOverviewModule");l&&d&&(l.setHeaderVisible(!1),r.resetFuncAreaModule(d),u&&u.floorWrapper&&r.restoreFuncAreaDoms([u.floorWrapper])),n.getCurrentCity(function(o){addStat(STAT_CODE.STAT_PANORAMA,{item:"indoorview-enter",cityname:o.cityName})})},indoor_exit:function(o,e){U.pano_changed=null,Z.root.shutdown("PanoIndoorPoiModule");var a=e.pano_change_dispatcher,n=Z.root.getModule("PoiInfoPanelModule");if("returnButton"==a)n&&(n.show(),n.expandDetail(2e3),i=e.data.uid);else if("PanoOverviewModule"!=a||z){var t=new m(e.data.uid);t.extend(m.TYPE.pano).then(function(){n&&(i=e.data.uid,z?H?(n.setData(t,!0,!0,I||i,!0),H=!1):n.setData(t,!0,!0,I||z,!0):n.setData(t,!1,!1,I,!0),n.show())})}else n.hide();var d=Z.root.getModule("PanoGuideModule"),l=Z.root.getModule("TrafficModule");l&&d&&l.isEnable()?(l.setHeaderVisible(!0),r.resetFuncAreaModule(l)):Z.root.safeCall("PanoToolModule","setClassifySearchVisible",[!0]),Z.root.safeCall("PanoOverviewModule","event_exitIndoor",[o])},"PanoModule:indoor_plan_id_changed":function(o){var e=Z.root.getModule("PanoOverviewModule");e&&e.event_indoorIdChanged(o)},"PanoModule:indoor_floor_changed":function(o){var e=Z.root.getModule("PanoOverviewModule");e&&e.event_floorChanged(o)},after_pano_changed:function(o,e){var a=Z.root.getModule("PanoModule"),n=a.getPanoCopyright(),t=a.getPanoTimeline();if(n){n.roadName}A(o),Z.root.shutdown("PanoMessageBox"),R(e.data);var r=e.pano_change_dispatcher,i=Z.root.getModule("PanoOverviewModule");if(i)if("inter"!==e.data.panoType){i.event_panoChanged(o);var d=Z.root.getModule("TrafficModule");d&&!d.isNav()&&i.initTrafficLayer()}else i.updateCatalog(e.data.panoId);var l=Z.root.getModule("PanoGuideModule");if(l&&("InterPoi"!=r||"inter"==e.data.panoType&&"street"==e.last_data.panoType)&&l.update(o.data.panoId,o.data.floor,e.last_data.panoType,e.data.panoType,r,t),"inter"==e.data.panoType&&"InterPoi"!=r){Z.root.safeCall("PoiInfoPanelModule","hide");var u=Z.root.getModule("PanoIndoorPoiModule");if(u){var s=Z.root.getModule("PanoModule"),p=s.getPanoIndoorData();if(u.getCurrentUid()!=p.poiuid){var g=new m(p.poiuid);g.extend(m.TYPE.indoorPoi).then(function(){u.event_poi_change(g,p.poiuid)})}}}Z.root.safeCall("TrafficModule","event_panoChanged",[o.data.panoId]),Z.root.safeCall("ClassifySearchModule","updateClassifySearch"),L()},deselect_poi:function(){return i?void(i=null):void Z.root.safeCall("PoiInfoPanelModule","restorePoiInfo")},"PanoModule:pano_error":function(o){var e="",a="";switch(o.data){case"IO_ERROR":e="网络异常，请重新加载!",a="error";break;case"NO_PANO":e="抱歉, 该地方没有全景";break;case"OUTOF_RANGE":e="您已超出导航路线",a="alert";break;default:e="抱歉错误了，请重新加载!",a="error"}F.hide(),Z.root.bootstrap({module:"PanoMessageBox",args:[{container:r.getModuleContainer("PanoMessageBoxModule"),data:{info:e,funtype:a}}]})},"PanoModule:pano_player_error":function(){var o="抱歉错误了，请重新加载",e="error";F.hide(),Z.root.bootstrap({module:"PanoMessageBox",args:[{container:r.getModuleContainer("PanoMessageBoxModule"),data:{info:o,funtype:e}}]})},after_go_to_poi:function(o,e){if(A(o),e.id){var a=e.id,n=new m(a);n.extend(m.TYPE.pano,m.TYPE.indoorPoi).then(function(){var o=Z.root.getModule("PanoGuideModule").getSelectAlbumItem(),e=Z.root.getModule("PanoModule").getPanoOptions();if(o&&o.data.uid===a&&"inter"!=e.panoType?Z.root.getModule("PanoModule").drawLineToPoint(o.data.uid,o.pos.x,o.pos.y,n.pano.x,n.pano.y,n.pano.rank,function(){F.hide()}):F.hide(),"inter"==e.panoType){var t=Z.root.getModule("PanoIndoorPoiModule");t&&t.event_poi_change(n,a)}else{var r=Z.root.getModule("PoiInfoPanelModule");r&&(r.setData(n,z?!0:!1,!0,I,!0),r.show())}L()})}else F.hide()},once_tiles_complete:function(){C.close();var o=Z.root.getModule("PanoModule"),e=o.getPanoOptions(),a=o.getPanoIndoorData(),i=o.getPanoTimeline();e&&(e.panoCopyright=o.getPanoCopyright());var d="street"===e.panoType,l=y.createTask({timeout:1e4});!d&&a&&(a.currentPid=e.panoId);var u=function(){return Z.root.bootstrap({module:P,args:[{context:{mapContext:n,panoContext:t},parent:r.getModuleContainer("PanoOverviewModule"),isStreet:d,data:d?e:a,indoorModel:o.getIndoorModel(),zIndex:b+10,level:Z.root.isEnterFromShareLink()?16:window.map.getZoom()}]})},s=function(){Z.root.bootstrap({module:f,args:[]});var o=new T.Deferred;return"inter"===e.panoType?(Z.root.getModule("PanoCopyrightModule").render(r.getModuleContainer("PanoCopyrightModule"),e),o.resolve()):n.getCurrentCity(function(a){a&&(e.panoCopyright.roadName=a.cityName+e.panoCopyright.roadName),Z.root.getModule("PanoCopyrightModule")&&Z.root.getModule("PanoCopyrightModule").render(r.getModuleContainer("PanoCopyrightModule"),e),o.resolve()}),o};if(1==E)return l.add(u).add(s).start().then(function(){var o=Z.root.getModule("PanoOverviewModule");o&&o.event_disable(),o.initTrafficLayer()}),void T("#pano-return-btn em").text("退出");var p,c,h=function(){return Z.root.bootstrap({module:g,args:[r.getModuleContainer("PanoToolModule")]})},m=function(){return Z.root.bootstrap({module:M,args:[r.getModuleContainer("PanoGuideModule"),{albumImageDomain:t.getPanoUrlConfig().PANO_3DIMAGE_URL,data:e,zIndex:b+10,timeThroughData:i}]})},w=n.getPCMapCity().cityId,x=y.getBusLineInfoFromPCMap(e.panoMCPoint.x,e.panoMCPoint.y),I=!0;x&&(p=x.buslineUid,c=x.closestBusStationUid),z||(I=!1,z=c);var S=function(){Z.root.bootstrap({module:v,args:[r.getModuleContainer("ui-layer"),t,z,d,p,w,I]})},k=Z.root.getModule("TrafficModule");if(k&&k.isEnable()){var O=Z.root.getModule("PanoModule"),V=k.getRoutParam();V&&O.setRoutParam(baidu.json.stringify(V)),O.enableShareMarker(!1),l.add(u).add(s).add(h).add(function(){k.show();var o=Z.root.getModule("PanoOverviewModule");if(k.isBus()||k.isWalk())o.initTrafficLayer();else if(k.isNav()){var e=k.getRoutPoints();o.drawLine(e,3),e=k.getMarkers(),o.addMarkers(e)}d&&r.resetFuncAreaModule(k)}),l.add(d?function(){k.setHeaderVisible(!0),Z.root.bootstrap({module:M,args:[null,{albumImageDomain:t.getPanoUrlConfig().PANO_3DIMAGE_URL,data:{},zIndex:b+10}]})}:function(){return k.setHeaderVisible(!1),m()})}else l.add(u).add(s).add(h).add(m).add(S).add(function(){d&&Z.root.safeCall("PanoToolModule","setClassifySearchVisible",[!0])});if(void 0!==Y){if(y.isSupportVideo()){var N=Y;l.add(function(){Z.root.bootstrap({module:"VideoPlayer",args:[N]})})}else l.add(function(){Z.root.bootstrap({module:"PanoMessageBox",args:[{container:r.getModuleContainer("PanoMessageBoxModule"),data:{info:"您的浏览器版本过低或无法兼容，暂不支持此功能。",funtype:"alert"}}]})});Y=void 0}var j=l.start();j.then(function(){if(W&&W.length>0){var o=W[0],a=Z.root.getModule("PanoOverviewModule");a&&a.addSearchMarker(o.x,o.y,o.name),W=null}var n=z,t=Z.root.getModule("PanoIndoorPoiModule");"inter"==e.panoType&&t&&(n=t.getCurrentUid()),n&&B({uid:n,x:e.panoMCPoint.x,y:e.panoMCPoint.y}),L()}),_.removeMask()},pov_changed:function(o){"PanoModule"!=o.target.getName()&&(Z.root.getModule("PanoModule").setPov(o.data),L())},pano_changed:function(o){"PanoModule"!=o.target.getName()&&(U.pano_changed=o.data.source,o.data.eventSource="external",Z.root.getModule("PanoModule").showPano(o.data,null,o.from),Z.root.safeCall("PoiInfoPanelModule","foldAllPanel"))},inter_poi_changed:function(o){"PoiInfoPanelModule"==o.data.source&&(G=o.data.uid);var e=new m(o.data.uid);e.extend(m.TYPE.indoorPoi).then(function(){var a=Z.root.getModule("PanoIndoorPoiModule");a&&a.event_poi_change(e,o.data.uid)}),U.pano_changed=o.data.source,o.data.eventSource="external",Z.root.getModule("PanoModule").showPano(o.data,null,"InterPoi")},photo_tour_enter:function(e){o.async("common:widget/pano/PhotoTour/PhotoTourMain.js",function(o){var a=new o(e.data.tourId);a.addEventListener("dispose",function(){Z.photo_tour_exit(),a=null})}),r.hide(),Z.root.safeCall("PoiInfoPanelModule","hide"),Z.root.safeCall("PanoOverviewModule","hide"),Z.root.safeCall("PanoToolModule","setItemsEnable",[[!1,!0,!1,!1]]),Z.root.getModule("PanoModule").setVisibility(!1)},photo_tour_exit:function(){Z.root.getModule("PanoModule").setVisibility(!0),r.show(),Z.root.safeCall("PanoToolModule","setItemsEnable",[[!0,!0,!0,!0]]),Z.root.safeCall("PoiInfoPanelModule","show"),Z.root.safeCall("PanoOverviewModule","show")},animate_pano_changed:function(o){var e=Z.root.getModule("PanoModule"),a=e.getPanoOptions();"street"==a.panoType?o.data.source="PanoStreet":(o.from="PanoInterPoi",o.data.source="PanoInterPoi"),U.pano_changed=o.data.source,U.after_go_to_poi=o.data.source,o.data.eventSource="external",F.show();var n=Z.root.getModule("PoiInfoPanelModule");if(n){var t=n.getDetailPanoPoi();t&&t.getUid()==o.data.uid||n.foldDetail()}e.showPano(o.data,!0,o.from)},zoom_changed:function(o){"PanoModule"!=o.target.getName()&&(o.data.eventSource="external",Z.root.getModule("PanoModule").setZoom(o.data))},layout_changed:function(o,e){r.event_layoutChanged(o.target.getName(),e.display)},floor_changed:function(o){"PanoModule"!=o.target.getName()&&(U.pano_changed=o.data.source,o.data.eventSource="external",Z.root.getModule("PanoModule").showPano(o.data,null,o.from))},close_pano:function(){Z.root.getModule("PanoModule").closePano()},show_position:function(o){var e=Z.root.getModule("PanoOverviewModule");e&&e.event_showPosition(o.data.x,o.data.y)},hide_position:function(){var o=Z.root.getModule("PanoOverviewModule");o&&o.event_hidePosition()},interface_ready:function(){if(1==E){var o=Z.root.getModule("TrafficModule"),e=o.getSteps();y.getRouteVideoParamFromPCMap(e).then(function(o){Z.root.getModule("PanoModule").playRouteVideo(E,o)})}},play_routeVideo:function(){E=2;var o=Z.root.getModule("PanoOverviewModule");o&&(V=o.getCurrentPointInfo(),V.panoType="street");var e=Z.root.getModule("TrafficModule"),a=e.getSteps();y.getRouteVideoParamFromPCMap(a).then(function(o){Z.root.getModule("PanoModule").playRouteVideo(E,o),r.event_layoutChanged("PanoGuideModule",!1),r.event_layoutChanged("TrafficModule",!1),r.event_layoutToggle("PanoToolModule",!1),r.event_layoutToggle("TrafficModule",!1),r.event_layoutToggle("RouteVideoModule",!1);var e=Z.root.getModule("PanoOverviewModule");e&&e.event_disable(),T("#pano-return-btn em").text("退出")})},routeVideo_exit:function(){function o(){r.event_layoutToggle("TrafficModule",!0),r.event_layoutToggle("PanoToolModule",!0),r.event_layoutChanged("TrafficModule",!0);var o=Z.root.getModule("PanoOverviewModule");o&&(o.event_panoChanged({data:V}),o&&o.event_enable())}E=0,T("#pano-return-btn em").text("返回"),Z.root.getModule("PanoModule").closeRouteVideo(),setTimeout(o,800)},routeVideo_pano_changed:function(o){var e=Z.root.getModule("PanoOverviewModule");e&&e.event_panoChanged(o)},tool_share_pano:function(o){var e=Z.root.getModule("PanoShareModule");if(!e){var a=Z.root.getShareParam();Z.root.bootstrap({module:s,args:[{context:{mapContext:n,panoContext:t},parent:r.getModuleContainer("PanoToolModule"),data:o.data,zIndex:b+10,shareParam:a}]})}addStat(STAT_CODE.STAT_PANORAMA,{item:"pano-share-click"})},classify_search_panel_visible:function(o){var e=Z.root.getModule("ClassifySearchModule"),a=o.data;e||Z.root.bootstrap({module:h,args:[r.getModuleContainer("PanoToolModule"),a,t]})},remove_markers:function(o,e){Z.root.getModule("PanoModule").removeMarkers(e)},poi_change:function(o,e){var a=Z.root.getModule("PanoModule").getPanoOptions();if(a){var n=e.getUid?e.getUid():e.uid,t=e.pano?e.pano.x:a.panoMCPoint.x,r=e.pano?e.pano.y:a.panoMCPoint.y,i={uid:n,x:t,y:r};B(i)}},add_markers:function(o,e){Z.root.getModule("PanoModule").addMarkers(e)},add_search_marker:function(o){if(o.markers&&o.markers.length>0){var e=Z.root.getModule("PanoOverviewModule");if(e){var a=o.markers[0];e.addSearchMarker(a.x,a.y,a.name)}else W=o.markers}},remove_search_marker:function(){var o=Z.root.getModule("PanoOverviewModule");o&&o.removeSearchMarker()},poi_search_marker_changed:function(o,e){Z.root.getModule("PanoModule").removePanoModuleMarker(),I=e[0].poiuid;var a=e[0],n=Z.root.getModule("PanoOverviewModule");n&&n.addSearchMarker(a.x,a.y,a.name)},"PoiInfoPanelModule:status_changed":function(o,e){var a=e.isExpand,n=Z.root.getModule("PanoOverviewModule");if(n)if(a===!0&&n.isLocked())O=!0,n.unlock(),n.fold();else if(a===!1&&!n.isExpand())return},clear_marker:function(){Z.root.getModule("PanoModule").clearMarker()},dispose:function(o){Z.root.shutdown(o.target)},video_enter:function(o){var e=o.data;if(y.isSupportVideo()){var a=Z.root.getModule("VideoPlayer");a?a.play(e.uid):(Z.root.bootstrap({module:"VideoPlayer",args:[e.uid]}),L())}else Z.root.bootstrap({module:"PanoMessageBox",args:[{container:r.getModuleContainer("PanoMessageBoxModule"),data:{info:"您的浏览器版本过低或无法兼容，暂不支持此功能。",funtype:"alert"}}]})},"PanoShareModule:dispose":function(){Z.root.safeCall("VideoPlayer","onShareClose")},"VideoPlayer:dispose":function(){L()},share_video:function(o,e){var a=Z.root.getModule("PanoShareModule");if(!a){var r=Z.root.getShareParam();Z.root.bootstrap({module:s,args:[{context:{mapContext:n,panoContext:t},parent:e.container,data:o.data,zIndex:b+10,shareParam:r,sharePanelClassName:e.sharePanelClassName}]})}}};a.exports=Z});