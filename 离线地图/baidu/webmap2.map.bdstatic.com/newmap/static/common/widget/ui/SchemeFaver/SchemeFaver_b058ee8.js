define("common:widget/ui/SchemeFaver/SchemeFaver.js",function(t,a,e){var i=t("common:widget/ui/SyncMgr/SyncMgr.js"),n=t("common:widget/ui/config/config.js"),s=n.modelConfig,d=(n.mapConfig,{isRepeat:function(t,a){t=t||{},t.data||(t.data=d.makeData.call(this,t));for(var e=(i.current_tab_index,i.favCloudData),n=0,s=e.length;s>n;n++){var o=e[n];if(d.isSameScheme(t.data,o.data))return t.dom.className="i hasafav",t.dom.title="取消收藏",a&&a({id:o.id,data:o.data,i:n}),!0}return t.dom&&(t.dom.className="i afav",t.dom.title="加入收藏夹"),!1},isSameScheme:function(t,a){if(!t||!a)return!1;{var e=t.sfavnode,i=t.efavnode,n=a.sfavnode,s=a.efavnode;T.json.stringify(t.wp),T.json.stringify(a.wp)}return t.plankind!=a.plankind||t.pathtype!=a.pathtype||t.busidx!=a.busidx?!1:e.name!=n.name||i.name!=s.name?!1:"number"!=typeof t.transkind&&"number"!=typeof a.transkind||t.transkind==a.transkind?"number"==typeof t.pagenumber&&"number"==typeof a.pagenumber&&t.pagenumber!=a.pagenumber?!1:!0:!1},makeData:function(t){var a,e,n=i.pk_dict,d=this.start,o=this.end,p=d.pt.split(","),r=o.pt.split(","),c=parseInt(s.cityCode,10),u=a=e=this.currentCity||c,m=d.bus_stop&&d.uid?0:1,h=o.bus_stop&&o.uid?0:1,f=this.strategy,y=this.dragPoints||"",l=parseInt(t.pathtype||0,10),g=parseInt(this.pagenum||0,10),v=n[t.pathtype].t+d.wd+"-"+o.wd,k=0,b="",x="",C="",I=this.trafType||0,y=[];if(this.dragPoints)for(var w=0;w<this.dragPoints.length;w++)y[w]={n:this.dragPoints[w].n,p:this.dragPoints[w].p};switch(t.pathtype){case 0:case 5:var S=n[t.pathtype];a=parseInt(this.sCity.code,10),e=parseInt(this.eCity.code,10),b=S[f].ck,C=S[f].txt;break;case 1:case 6:case 7:var D=n[t.pathtype];f=1==I?4:f,b=D[f].ck,C=D[f].txt,k=this.schemeIndex;break;case 2:a=parseInt(this.sCity.code,10),e=parseInt(this.eCity.code,10);break;case 9:var D=n[t.pathtype];b=D[this.csy].ck,C=D[this.csy].txt,x=parseInt(this.cty,10),a=parseInt(this.startCity.code,10),e=parseInt(this.endCity.code,10),l=1,k=this.curLineIndex}var T={sfavnode:{cityid:a,geoptx:parseFloat(p[0]),geopty:parseFloat(p[1]),uid:d.uid,name:d.wd,type:m},efavnode:{cityid:e,geoptx:parseFloat(r[0]),geopty:parseFloat(r[1]),uid:o.uid,name:o.wd,type:h},pathname:v+C,pathtype:l,plankind:b,transkind:x,pagenumber:g,wp:y,curcityid:u,busidx:k,type:1};return 1==t.pathtype&&(T.exptype=this.exptype||"dep",T.exptime=this.exptime||"",T.trafType=I),T},deleteRepeat:function(t,a){t&&(i.upload([{id:t.id,action:2,type:1,data:t.data}],function(){i.showTipInfo("已从收藏夹中删除"),a&&a()}),T.array.removeAt(i.favCloudData,t.i))},getIndexById:function(t){for(var a=0,e=i.favCloudData.length;e>a;a++)if(t==i.favCloudData[a].id)return a},toClound:function(t){t=t||{};var a=d.makeData.call(this,t),e={action:0,type:1,data:a},n=d.isRepeat({dom:t.dom,data:a},function(a){d.deleteRepeat(a,function(){t.dom.className="i afav",t.dom.title="添加到收藏夹"})});n||(addStat("http://webmap2.map.bdstatic.com/newmap/static/common/widget/ui/SchemeFaver/oldfav.line.add","click"),i.upload([e],function(a){i.showTipInfo("成功添加到收藏夹"),t.dom.className="i hasafav",t.dom.title="取消收藏";try{e.id=a.content.data[0].id,i.favCloudData.unshift(e)}catch(n){}}))}});e.exports=d});