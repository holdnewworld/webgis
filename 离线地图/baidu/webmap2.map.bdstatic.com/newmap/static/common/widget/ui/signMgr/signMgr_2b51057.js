define("common:widget/ui/signMgr/signMgr.js",function(e,n,a){function o(){var n=arguments;window.MapSignInst?o.fun(n):e.async(["common:widget/com/MapSign/MapSign.js","common:widget/ui/searchInfoWindow/searchInfoWindow.js"],function(e,a){new e({cinfo:{arg:n,searchInfoWindow:a}})})}var t=e("common:widget/com/componentManager.js"),r=e("common:widget/ui/mapShare/MapShare.js"),i=function(e){var n=T.g("shareInupt"),a=T.g("cpShareCon");e&&e.url&&(s=!0,a.style.display="inline",n.value=e.url,n.focus(),n.select(),window._iwUrlCbk&&window._iwUrlCbk(e.url))};o._USERSHARE=1,o._USERFAV=1,o.fun=function(e){1==e.length&&MapSignInst[e[0]](),e.length>1&&MapSignInst[e[0]](e[1])},o.userTagPanl=null,o.exituserSign=function(){o.userTagPanl&&o.userTagPanl.isVisible()&&MapSignInst.exituserSign()},o.mapSign={pointInfo:{list:{}},polylineInfo:{list:{}},remarkInfo:{list:{}}},o.temp={event:{}},o.deCodeShare=function(e){var e=e||"";return e.replace(/&amp;/g,"&").replace(/&lt;br\/&gt;/g,"<br/>")},o.cpShare=function(){var e=T.g("shareInupt").value;return o.cpShare.timer&&clearTimeout(o.cpShare.timer),window.clipboardData&&(window.clipboardData.clearData(),window.clipboardData.setData("Text",e)),T.g("usSharMes")&&(T.g("usSharMes").style.display="block"),o.cpShare.timer=setTimeout(function(){T.g("usSharMes")&&(T.g("usSharMes").style.display="none")},1e3),e},o.cpShareFF=function(){var e=(T.g("shareInupt").value,baidu.swf.createHTML({id:"signLinkBtnFlh",url:"../../../swf/fClipboard.swf"/*tpa=http://webmap2.map.bdstatic.com/newmap/static/common/swf/fClipboard.swf*/,width:"44",height:"24",wmode:"transparent",ver:"9.0.0"}));o.cpShareFF.checkFlash=function(){var e=baidu.swf.getMovie("signLinkBtnFlh");e&&e.flashInit&&e.flashInit()&&(clearInterval(o.cpShareFF.timer),e.setHandCursor(!0),e.setContentFuncName("_sign.cpShareFF.getPasteData"),e.setMEFuncName("_sign.cpShareFF.mouseEventHandler"))},o.cpShareFF.getPasteData=function(){var e=o.cpShare();return e},o.cpShareFF.mouseEventHandler=function(e){var n=T.g("cpShareCon");"mouse_over"==e?n.className="on":"mouse_down"==e?n.className="down":"mouse_up"==e?n.className="on":"mouse_out"==e&&(n.className="")},T.g("cpShareCon").innerHTML=e,o.cpShareFF.timer=setInterval(o.cpShareFF.checkFlash,500)},o.goShare=function(e){T.g("iw_tool_box")?T.g("iw_tool_box").style.top="-2000px":null;var n=T.g("iw_share_con");t.load("SharePanel",{dom:n,cinfo:{from:"iwshare",data:e},onload:function(){n.style.display="",o._goShare(e)}})},o._goShare=function(e){T.g("shareInupt").style.display="block",T.g("cpShareCon_").style.display="none"http://webmap2.map.bdstatic.com/newmap/static/common/widget/ui/signMgr/;var e=e&&e.uid?e:null,n=(T.g("shareInupt"),T.g("cpShareCon")),a="../../../../../../../map.baidu.com/-.htm"/*tpa=http://map.baidu.com/?*/;if(T.browser.chrome&&(T.g("iwBoxShareInput").style.padding="0 93px 0 2px"),T.g("shareInupt").onfocus=function(){this.select()},T.browser.ie){if(n){var t=function(e){0==e.button&&(this.className="down")},c=function(){this.className="on"},p=function(){this.className=""};n.onclick=function(){o.cpShare()},T.on(n,"mouseover",c),T.on(n,"mousedown",t),T.on(n,"mouseup",c),T.on(n,"mouseout",p),o.temp.event.shareCopy=[{obj:n,type:"mouseover",fun:c},{obj:n,type:"mousedown",fun:t},{obj:n,type:"mouseup",fun:c},{obj:n,type:"mouseout",fun:p}]}}else o.cpShareFF();var l=function(){var e=r.SHARE_PROC_URL+"?url="+encodeURIComponent(a)+"&web=true";s=!1,T.jsonp(e,i),clearTimeout(u),u=setTimeout(function(){0==s&&i({url:a})},3e3)};if(e)a+="shareurl=1&poiShareUid="+e.uid+"&cityCode="+e.cityCode+"&tn="+map.mapType,map._isHybirdShow&&(a+="&hb="+BMAP_TYPE_HYBIRD),l();else{var h=MapSignInst.temp.iw.index,g=o.mapSign.pointInfo.list[h];MapSignInst.getSignLink(baidu.json.stringify(g),function(e){if(1!=e.result)return T.g("shareInupt").style.display="none",n.style.display="none",T.g("cpShareCon_").style.display="block",void(T.g("cpShareCon_").innerHTML="有不符合相关法规政策的词，请修改");var o=e.content.shareId;a+="poiShareId="+o,a+="&tn="+map.mapType,map._isHybirdShow&&(a+="&hb="+BMAP_TYPE_HYBIRD),l()},"single")}},o.reShare=function(){if(T.g("iw_share_con").style.display="none",o.temp.event.shareCopy&&o.temp.event.shareCopy.length>0)for(var e=o.temp.event.shareCopy,n=0;n<e.length;n++){var a=e[n];T.un(a.obj,a.type,a.fun)}};var s=!0,u=null;o.parseShare=function(e){var n="/userflag/share.php?act=read_share&shareId="+e+"&t="+(new Date).getTime();baidu.ajax(n,{dataType:"json",success:function(e){if(e=e||{},1==e.result){var n=e.content;o("parseAllShare",n)}else o(),alert("数据已经删除")},error:function(){}})},window._sign=o,a.exports=o});