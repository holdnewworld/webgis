define("common:widget/pano/Root.js",function(e,n,t){var r=e("common:widget/pano/eventImplements.js"),a=!1,o={},i="",s={_handlers:{},on:function(e,n){this._handlers[e]=n},fire:function(e,n){if(n[0]instanceof baidu.lang.Event){var t=n[0].target.getName&&n[0].target.getName(),r=this._handlers[t+":"+e];r&&r.apply(window,n)}var a=this._handlers[e];a&&a.apply(window,n)}},f={},l=[],u=function(e){return"common:widget/pano/module/"+e+"/"+e+".js"},v=function(e,n){e.target.getName&&(e.from=e.target.getName()),s.fire(e.type,[e,n])};v.events={};var d={getModule:function(e){return e?o[e]:o},initialize:function(e){try{e.root=this,e._initialize(o),delete e._initialize;for(var n in e)s.on(n,e[n]);return}catch(t){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/Root.js",ln:76})}},getShareParam:function(){for(var e={},n=0,t=l.length;t>n;n++){var r=l[n],a=r.getShareParam();void 0!==a&&null!==a&&(e[r.getName()]=a)}return e},isEnterFromShareLink:function(){return"share"==i?!0:!1},bootstrap:function(n){n=T.isArray(n)?n:[n];var t,r,a,i,s=[];for(t=0,i=n.length;i>t;t++){var c=n[t],g=c.module;if("string"==typeof g)!function(){var n=new T.Deferred,t=c.args;e.async(u(g),function(e){d.bootstrap({module:e,args:t}).then(function(){n.resolveWith(d)})}),s.push(n)}();else{var h=c.args,p=new g;if(o[p.getName()]){var m=new T.Deferred;return m.resolve(),m}if(p.isAsync()===!0){var m=new T.Deferred;m.name=p.getName(),p.once("ready",function(e){return function(){e.resolveWith(d)}}(m)),s.push(m)}for(var w=p.getSupportEvents(),r=0,a=w.length;a>r;r++){var y=w[r];v.events[y]?v.events[y]++:v.events[y]=1,p.addEventListener(y,v)}var P=f[p.getName()];P&&(p.$shareParam=P,delete f[p.getName()]),p.initialize&&p.initialize.apply(p,h),p.$shareParam=void 0,l.push(p),o[p.getName()]=p}}var m=new T.Deferred;return T.when.apply(T,s).done(function(){m.resolve()}),m},shutdown:function(e){void 0===e?(e=l.slice(),l=[]):T.isArray(e)||(e=[e]);var n,t,r,a,i=0;for(n=0,a=e.length;a>n;n++){var s=e[n];if("string"==typeof s&&(s=o[s]),s){var f=s.getSupportEvents()||[];for(t=0,r=f.length;r>t;t++){var u=f[t];v.events[u]--,0==v.events[u]&&delete v.events[u],s.removeEventListener(u,v)}s.dispose&&s.dispose();for(var d in o)o[d]===s&&delete o[d];i++}}return i},safeCall:function(e,n,t){var r=this.getModule(e);return r&&r[n]?r[n].apply(r,t||[]):void 0}};t.exports={showPano:function(e,n){if(e.panoShareParam)try{var t=decodeURIComponent(e.panoShareParam);e.panoShareParam=f=T.json.parse(t)}catch(o){throw o}a||(d.initialize(r),a=!0),i=e.from,s.fire("showPano",[null,e,n])},closePano:function(){a&&(f={},s.fire("closePano"),d.shutdown())},isRunning:function(){return l.length}}});