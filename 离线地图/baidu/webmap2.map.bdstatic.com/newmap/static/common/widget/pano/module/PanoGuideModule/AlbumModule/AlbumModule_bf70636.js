define("common:widget/pano/module/PanoGuideModule/AlbumModule/AlbumModule.js",function(e,t,a){var n=e("common:widget/pano/component/PanoAlbumComponent/AlbumComponent.js"),i=e("common:widget/pano/base/ModuleClass.js"),o=(e("common:widget/pano/base/service.js"),e("common:widget/pano/base/util.js")),d=198,s=108,c=i.extend("AlbumModule",{initialize:function(e,t,a){try{this.options={albumImageDomain:t},this._maxWidth=document.body.clientWidth,this.container=e;var i=this.album=new n(e,d,s,{zIndex:a.zIndex||1}),o=this;this_AlbumEventHandlers={},i.addEventListener("click",function(e,t){var a=t.index,n=o.data[a];if(9==n.type&&addStat(STAT_CODE.STAT_PANORAMA,{item:"pano-ugc-entrance-click"}),n&&n.data){switch(n=n.data,i.setSelectIndex(a),n.type){case 2:n.source="PanoStreet",o.dispatchEvent("animate_pano_changed",{data:n});break;case 21:n.source="InterPoi",o.dispatchEvent("inter_poi_changed",{data:n});break;case 7:o.dispatchEvent("photo_tour_enter",{data:n});break;case 8:o.dispatchEvent("pano_topic_enter",{data:n});break;case 4:n.source="PanoStreet",o.dispatchEvent("animate_pano_changed",{data:n});break;case 3:o.dispatchEvent("pano_changed",{data:n});break;case 1:case 5:case 6:o.dispatchEvent("pano_changed",{data:n});break;case 10:case 9:o.dispatchEvent("video_enter",{data:n})}o.dispatchEvent("hide_position"),addStat(STAT_CODE.STAT_PANORAMA,{item:"guide_album_click",type:n.type})}}),i.addEventListener("mouseenter",function(e,t){var a=t.index;i.fitImage(a);var n=o.data[a];n&&n.data&&(n=n.data,o.dispatchEvent("show_position",{data:{x:n.x,y:n.y}}))}),i.addEventListener("mouseleave",function(){o.dispatchEvent("hide_position")}),i.addEventListener("show_position",function(e){o.dispatchEvent("show_position",{data:e.data})}),i.addEventListener("hide_position",function(){o.dispatchEvent("hide_position")}),i.addEventListener("floor_changed",function(e){o.dispatchEvent("layout_changed",{data:e.data})})}catch(c){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/module/PanoGuideModule/AlbumModule/exception.fire","catch",{msg:c.message||c.description,path:"common:widget/pano/module/PanoGuideModule/AlbumModule/AlbumModule.js",ln:145})}},update:function(e){var t=this.options.albumImageDomain;this.data=e;var a=o.each(e,function(e){var a={};if(e.photoUrl)a.src=e.photoUrl;else{var n=e.data;if(!n)return;var i=n.panoPitch+(1==n.type?0:6);a.src=o.getImage3DUrl(t,n.panoId,n.panoHeading,i,d,s)}return a.name=e.name,a.icon="i-poi-"+e.type,a},!0);this.album.resize(),this.album.update(a)},setSelectPano:function(e){var t=e,a=void 0;return o.some(this.data,function(e,n){return e.data.panoId+"_"+e.data.uid==t?(a=n,!0):!1}),void 0!==a?(this.setSelectIndex(a),!0):!1},unselect:function(){this.album.unselect()},setSelectIndex:function(e){this.album.setSelectIndex(e)},scrollTo:function(e){this.album.scrollTo(e)},getSelectIndex:function(){return this.album.getSelectIndex()},getSelectItem:function(){var e=this.album.getSelectIndex();if(void 0===e||!this.data[e])return null;var t=this.data[e].data,a=this.album.getCurrentLiPosition(e);return a.x=a.x+this.container.offsetLeft,{name:this.data[e].name,data:t,pos:{x:a.x,y:a.y}}},ignoreMouseEvent:function(e){this.album.ignoreMouseEvent(e)},event_layoutChanged:function(e){this.album&&this.album.resize(e)},dispose:function(){this.album&&this.album.dispose()}});a.exports=c});