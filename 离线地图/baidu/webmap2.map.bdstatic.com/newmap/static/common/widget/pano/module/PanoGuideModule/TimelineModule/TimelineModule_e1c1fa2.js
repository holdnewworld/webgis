define("common:widget/pano/module/PanoGuideModule/TimelineModule/TimelineModule.js",function(require,exports,module){var ModuleClass=require("common:widget/pano/base/ModuleClass.js"),util=require("common:widget/pano/base/util.js"),Animation=require("common:widget/ui/Animation/Animation.js"),config=require("common:widget/ui/config/config.js");require.loadCss({content:".pano_timeline_wrapper{position:relative;width:147px;height:108px;margin-left:4px;border:1px solid #3D4145;font-size:0}.pano_timeline_wrapper img{cursor:pointer;border:0}.pano_timeline_wrapper .photo-desc{position:absolute;bottom:0;left:0;width:147px;height:24px;padding-top:25px;text-align:center;font-size:12px;color:#abb0b2;z-index:3;cursor:pointer;background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/pano_whole/album-title-bg_eeddd16.png) left bottom repeat-x;_background:#000;_padding:0;_height:25px;_line-height:25px;_filter:alpha(opacity=75)}"});var TEMPLATE=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="pano_timeline_wrapper">    <img width="147" height="108" src="',"undefined"==typeof timelineData.pano3DImage?"":timelineData.pano3DImage,'">    <div class="photo-desc">        <span title="',"undefined"==typeof timelineData.timePointName?"":timelineData.timePointName,'">',"undefined"==typeof timelineData.timePointName?"":timelineData.timePointName,"</span>    </div></div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],panoTimelineModuleContainer=null,panoData=null,TIMEPOINT_NAME={day:"日景",night:"夜景"},convertTimelineData=function(e){for(var n=[],i=0,a=e.length;a>i;i++){var o={},t=e[i].data;o.pano3DImage=util.getImage3DUrl(config.urlConfig.PANO_3DIMAGE_URL,t.panoId,t.panoHeading,t.panoPitch,147,109),o.panoData={panoId:e[i].data.panoId,panoHeading:e[i].data.panoHeading,panoPitch:e[i].data.panoPitch},o.timePointName=TIMEPOINT_NAME[e[i].name],n.push(o)}return n},PanoTimelineModule=ModuleClass.extend("PanoTimelineModule",{initialize:function(e){try{panoTimelineModuleContainer=e;var n=this;T(panoTimelineModuleContainer).on("click",function(){panoData&&(panoData.keepPov=!0,n.dispatchEvent("pano_changed",{data:panoData}),addStat(STAT_CODE.STAT_PANORAMA,{item:"panotimeline-click"}))})}catch(i){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/module/PanoGuideModule/TimelineModule/exception.fire","catch",{msg:i.message||i.description,path:"common:widget/pano/module/PanoGuideModule/TimelineModule/TimelineModule.js",ln:64})}},getSupportEvents:function(){return["pano_changed"]},dispose:function(){panoTimelineModuleContainer.innerHTML=""},update:function(e){var n=T.isArray(e)&&e.length>0,i=void 0,a="";n&&""==panoTimelineModuleContainer.innerHTML?i=!0:n||""==panoTimelineModuleContainer.innerHTML||(i=!1),n&&(e=convertTimelineData(e),panoData=e[0].panoData,a=TEMPLATE({timelineData:e[0]}));var o=new Animation.Animation;if(void 0!==i)i===!0?(panoTimelineModuleContainer.innerHTML=a,o.build({fps:60,duration:300,render:function(e){try{util.setOpacity(panoTimelineModuleContainer,e)}catch(n){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/module/PanoGuideModule/TimelineModule/exception.fire","catch",{msg:n.message||n.description,path:"common:widget/pano/module/PanoGuideModule/TimelineModule/TimelineModule.js",ln:112})}},finish:function(){}})):o.build({fps:60,duration:300,render:function(e){try{e=1-e,util.setOpacity(panoTimelineModuleContainer,e)}catch(n){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/module/PanoGuideModule/TimelineModule/exception.fire","catch",{msg:n.message||n.description,path:"common:widget/pano/module/PanoGuideModule/TimelineModule/TimelineModule.js",ln:127})}},finish:function(){panoTimelineModuleContainer.innerHTML=""}});else if(n){var t=panoTimelineModuleContainer.cloneNode(!0);t.style.position="absolute",t.style.top="0",panoTimelineModuleContainer.parentNode.appendChild(t),o.build({fps:60,duration:300,render:function(e){try{e=1-e,util.setOpacity(t,e)}catch(n){"undefined"!=typeof alog&&alog("http://webmap2.map.bdstatic.com/newmap/static/common/widget/pano/module/PanoGuideModule/TimelineModule/exception.fire","catch",{msg:n.message||n.description,path:"common:widget/pano/module/PanoGuideModule/TimelineModule/TimelineModule.js",ln:148})}},finish:function(){t.parentNode.removeChild(t)}}),panoTimelineModuleContainer.innerHTML=a}}});module.exports=PanoTimelineModule});