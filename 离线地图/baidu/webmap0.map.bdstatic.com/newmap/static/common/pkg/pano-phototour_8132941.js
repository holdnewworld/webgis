define("common:widget/pano/PhotoTour/PhotoTourMain.js",function(o,t,i){function e(o,t){T.lang.Class.call(this),this._container=document.body,this._shareParam={tourIId:o,tourId:t},this.initialize(o,t)}var a=o("common:widget/pano/PhotoTour/PhotoTourModule/PhotoTourModule.js"),n=o("common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js"),r=o("common:widget/pano/PhotoTour/PhotoTourGuide/PhotoTourGuide.js"),u=o("common:widget/pano/PhotoTour/PhotoTourShare/PhotoTourShare.js"),s=o("common:widget/pano/base/service.js"),d=o("common:widget/ui/config/config.js"),h=(o("common:widget/pano/base/util.js"),o("common:widget/com/componentManager.js"));T.inherits(e,T.lang.Class,"PhotoTourMain"),T.extend(e.prototype,{initialize:function(o,t){try{var i=this;this._layout=this.initLayout(this._container),this._showMask();var e=this._layout.getContainer("return");this.bindExitEvent(e),s.getTourGuideData(o).then(function(o){t||(t=o.defaultId,i._shareParam.tourId=t),i._guideData=o;var e=i._layout.getContainer("tour");i._tourModule=i.initPhotoTour(e,t);var a=i._layout.getContainer("guide");i._guideModule=i.initGuide(a,o,t),i._layout.updateCopyRight(i._guideModule.getCopyRightName()),i._guideModule.addEventListener("id_selected",function(o){i._layout.updateCopyRight(o.data.name),i._shareParam.addressName=o.data.name,i._shareParam.tourId=o.data.tourId,i._tourModule.setTourid(o.data.tourId),i._showMask()});var n=i._layout.getContainer("share");i.initShare(n),i._tourModule.addEventListener("photoview_complete",function(){i._layout.showExpandArea(),i._hideMask()}),i._tourModule.addEventListener("id_changed",function(o){i._showMask(),i._guideModule.updateByTourId(o.data.id),i._shareParam.tourId=o.data.id,i._shareParam.addressName=o.data.name})})}catch(a){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:a.message||a.description,path:"common:widget/pano/PhotoTour/PhotoTourMain.js",ln:74})}},_showMask:function(){c.show()},_hideMask:function(){c.hide()},bindExitEvent:function(o){var t=this;T.on(o,"click",function(){var o=t.getTourInfoByTourId(t._shareParam.tourId),i=16,e=new BMap.Point(o.X,o.Y),a={panoId:t._shareParam.tourId,uid:t._shareParam.tourIId,panoType:"photo_tour"};131!=d.modelConfig.cityCode?h.go("cur&wd="+encodeURIComponent("北京市"),{cinfo:{isFromPano:!0},onload:function(){t.initPhotoTourExitMarker(a,e,i)}}):t.initPhotoTourExitMarker(a,e,i),t.dispose()})},initPhotoTourExitMarker:function(t,i,e){window.panoExitMarker?window.panoExitMarker.show(t,i,e):o.async("common:widget/pano/module/PanoExitMarker/PanoExitMarker.js",function(o){var a=new o;a.initialize(t,i,e),window.panoExitMarker=a}),l()},getTourInfoByTourId:function(o){for(var t=this._guideData.Paths,i=t.length-1;i>=0;i--)if(t[i].tourId==o)return t[i];return null},initPhotoTour:function(o,t){var i=new a;return i.initialize(o,t),i},initGuide:function(o,t,i){var e=new r;return e.initialize(o,t,i),e},initLayout:function(o){var t=new n;return t.initialize(o),t},initShare:function(o){function t(){var t=o.offsetTop+"px",e=new u;e.initialize(o.parentNode,{positionTop:t,address:i._shareParam.addressName,shareParam:{tourIId:i._shareParam.tourIId,tourId:i._shareParam.tourId}})}T.on(o,"click",t);var i=this},dispose:function(){this.dispatchEvent("dispose"),this._guideModule.dispose(),this._layout.dispose(),this._tourModule.dispose(),this._tourModule=null,this._guideModule=null,this._layout=null,this._container=null}});var l=function(){window.streetViewTool?(window.streetViewTool.resetStatus(),window.streetViewTool.setStatus()):o.async("common:widget/ui/StreetViewTool/StreetViewTool.js",function(o){var t=new o({map:map});map.addControl(t),t.show(),t.setPostion(),t.setStatus(),window.streetViewTool=t})},c={_mask:null,_timouter:null,_init:function(){if(!this._mask){var o=this._mask=document.createElement("div");o.style.cssText=["top:0","left:0","position:absolute","width:100%","height:100%","background-color:black","filter:alpha(opacity=0)","opacity:0","z-index:200001"].join(";")}},dispose:function(){this._mask.parentNode.removeChild(this._mask),this._mask=null},show:function(){this._mask||c._init();var o=T.g("photo-container");o.appendChild(this._mask),this._timouter=setTimeout(function(){c.hide()},8e3)},hide:function(){this._mask&&(null!==this._timouter&&clearTimeout(this._timouter),this._mask.parentNode&&this._mask.parentNode.removeChild(this._mask))}};i.exports=e});
;define("common:widget/pano/PhotoTour/PhotoTourGuide/PhotoTourGuide.js",function(require,exports,module){var ModuleClass=require("common:widget/pano/base/ModuleClass.js"),GUIDE_TEMPLATE=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div>    <div class="pano-func-item" style="z-index: 2;"></div>    <div class="pano-func-item" style="z-index: 1; left: 315px;">        <div id="photoGuideAlbum" style="width: 923px; height: 110px; z-index: 10010;">            <a href="javascript:void(0)" class="l_arrow arrow-disabled" title="上一页">            </a>            <div class="photoAlbum-container" style="width: 863px;">                <div class="photoAlbum-wraper" id="" style="width: 205px; z-index: 1; left: 0px;">                    ');for(var i=0;i<tourGuideData.Paths.length;i++)_template_fun_array.push('                                                <li class="photoAlbum-item" index="',"undefined"==typeof i?"":i,'" style="width: 198px; height: 108px; left: ',"undefined"==typeof(210*i)?"":210*i,'px;">                                    <div class="photoAlbum-item-wraper">                                                            <img src="',"undefined"==typeof tourGuideData.Paths[i].tourImage?"":tourGuideData.Paths[i].tourImage,'" onerror="this.src=&#39;http://webmap0.map.bdimg.com/newmap/static/common/images/pano_whole/img_error_4cffc74.png&#39;" style="width:198px;height:108px;">                                                <div class="photo-desc">                                                                            <i class="icon i-poi-2"></i>                                                        <span title="',"undefined"==typeof tourGuideData.Paths[i].tourName?"":tourGuideData.Paths[i].tourName,'">',"undefined"==typeof tourGuideData.Paths[i].tourName?"":tourGuideData.Paths[i].tourName,"</span>                                      </div>                                                </div>                            "),0===i&&_template_fun_array.push('                                <div id="photo-selected-border" class="selected-item" style="height: 102px; width: 192px; zoom: 1;"></div>                            '),_template_fun_array.push("                        </li>                    ");_template_fun_array.push('                </div>            </div>            <a href="javascript:void(0)" class="r_arrow arrow-disabled" title="下一页"></a>        </div>    </div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];require.loadCss({content:"#photoGuideAlbum{margin-top:5px;height:108px;-moz-user-select:none;-webkit-user-select:none;position:relative}#photoGuideAlbum .left-arrow,#photoGuideAlbum .right-arrow{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pano_whole/pano-icons_249d710.png) no-repeat;_background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/pano-icons-8_0ec7deb.png) no-repeat}#photoGuideAlbum .l_arrow,#photoGuideAlbum .r_arrow{float:left;width:30px;height:108px;text-align:center}#photoGuideAlbum .l_arrow:hover,#photoGuideAlbum .r_arrow:hover{cursor:pointer}#photoGuideAlbum .l_arrow .left-arrow{display:inline-block;width:18px;height:18px;background-position:0 -36px;margin-top:45px}#photoGuideAlbum .r_arrow .right-arrow{display:inline-block;width:18px;height:18px;background-position:-54px -36px;margin-top:45px}#photoGuideAlbum .l_arrow:hover .left-arrow{background-position:-18px -36px}#photoGuideAlbum .r_arrow:hover .right-arrow{background-position:-72px -36px}#photoGuideAlbum .arrow-disabled .left-arrow{background-position:-36px -36px}#photoGuideAlbum .arrow-disabled .right-arrow{background-position:-90px -36px}#photoGuideAlbum .arrow-disabled:hover .left-arrow{background-position:-36px -36px}#photoGuideAlbum .arrow-disabled:hover .right-arrow{background-position:-90px -36px}.photoAlbum-container{float:left;overflow:hidden;height:108px;position:relative}.photoAlbum-wraper{position:absolute}#photoGuideAlbum .photoAlbum-item{position:relative;float:left;border:1px #000 solid;margin-right:5px;font-size:0;position:absolute}#photoGuideAlbum .photoAlbum-item-wraper{left:0;top:0;z-index:4;zoom:1}#photoGuideAlbum .photoAlbum-item img{cursor:pointer;border:0;width:100%;height:100%}#photoGuideAlbum .photoAlbum-item .photo-desc{position:absolute;bottom:0;left:0;width:198px;height:24px;padding-top:25px;font-size:12px;color:#fff;z-index:3;background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/pano_whole/album-title-bg_eeddd16.png) left bottom repeat-x;_background:0 0}#photoGuideAlbum .photoAlbum-item .photo-desc span{display:inline-block;text-indent:4px;vertical-align:middle;width:170px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#photoGuideAlbum .photoAlbum-item .selected-item{position:absolute;top:0;left:0;border:3px solid #3af;z-index:5}#photoGuideAlbum .photoAlbum-item:hover{border:1px #3af solid}.photoAlbum-container{height:110px}#photoAlbum-scrollWraper{height:108px;overflow:hidden;position:relative}#photoGuideAlbum .icon{display:inline-block;width:16px;height:16px;vertical-align:middle;background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/pano_whole/guide_icons_ccb8b9c.png) no-repeat;_background:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/guide_icons-8_00040ae.png) no-repeat}#photoGuideAlbum .i-poi-1,#photoGuideAlbum .i-poi-2,#photoGuideAlbum .i-poi-4{background-position:0 0;margin-left:8px}#photoGuideAlbum .i-poi-3,#photoGuideAlbum .i-poi-6{background-position:-32px 0;margin-left:8px}#photoGuideAlbum .i-poi-5{background-position:-48px 0;margin-left:8px}"});var PhotoTourGuide=ModuleClass.extend("PhotoTourGuide",{initialize:function(e,t,o){try{this._container=e,this._guideData=t,this._render(t),this._bindEvents(),this._seletedIndex=0,this.updateByTourId(o)}catch(i){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:i.message||i.description,path:"common:widget/pano/PhotoTour/PhotoTourGuide/PhotoTourGuide.js",ln:19})}},updateByTourId:function(e){var t=0;if(e)for(var o=this._guideData.Paths.length-1;o>=0;o--)this._guideData.Paths[o].tourId===e&&(t=o);this._seletedItem(t),this._seletedIndex=t},_render:function(e){try{var t=GUIDE_TEMPLATE({tourGuideData:e});this._guideContainer=T(t)[0],this._container.appendChild(this._guideContainer)}catch(o){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:o.message||o.description,path:"common:widget/pano/PhotoTour/PhotoTourGuide/PhotoTourGuide.js",ln:36})}},_bindEvents:function(){var e=this;T.dom("#photoGuideAlbum").delegate("li","click",function(t){for(var o=t.target;"LI"!=o.nodeName&&"photoGuideAlbum"!==o.id;)o=o.parentNode;var i=o.getAttribute("index");e._seletedIndex=i,e._seletedItem(i),e.dispatchEvent("id_selected",{data:{name:e._guideData.name+e._guideData.Paths[i].tourName,tourId:e._guideData.Paths[i].tourId}})})},_seletedItem:function(e){var t=T.g("photo-selected-border"),o=T(".photoAlbum-item");o[e].appendChild(t)},dispose:function(){this._container.removeChild(this._guideContainer),this._guideContainer=null,this._container=null,this._guideData=null},getCopyRightName:function(){return this._guideData.name+this._guideData.Paths[this._seletedIndex].tourName}});module.exports=PhotoTourGuide});
;define("common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",function(require,exports,module){var util=require("common:widget/pano/base/util.js"),ModuleClass=require("common:widget/pano/base/ModuleClass.js"),Animation=require("common:widget/ui/Animation/Animation.js"),LAYER_TEMPLATE=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="photo-container" class="">    <div id="photo-return-btn">        <a class="pano_button" href="javascript:void(0);">            <span></span><em>返回</em>        </a>    </div>    <div id="photo-photo-wrapper"></div>    <div id="photo-expand-wrapper" style="display: none">        <ul id="photo-sidebar" style="bottom: 20px;">            <li id="photo-share-btn" class="pano_share_btn"><a class="pano_button" title="点击分享该场景照片游" href="javascript:void(0);"><span></span></a></li>             <!--<li id="photo-fold-btn">            <a class="pano_button" title="折叠功能区" href="javascript:void(0)"><span></span></a>            </li>  收起按钮, 默认是禁止的 -->        </ul>        <div id="photo-overview-wrapper"></div>                <div id="photo-footer">            <div id="photo-funcarea"  isinit=\'1\' class="clearfix pano_funcarea_hide" style="bottom: -120px;">                                            </div>            <div id="photo-tips">                <div class="pano-copyright">                        <span id="tourNameTip">北京市故宫</span>                        <span>|</span>                                <span><a target="_blank" class="pano-feedback" href="../../../../../map.baidu.com/pano/feedback/index.html"/*tpa=http://map.baidu.com/pano/feedback/index.html*/ style="display:inline;">反馈问题</a></span>                    <span>拍摄日期：2014.05.21</span>                </div>            </div>        </div>    </div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];require.loadCss({content:"#photo-container{position:absolute;overflow:hidden;top:0;left:0;width:100%;height:100%;background-color:#eee;z-index:100100;min-width:960px}#photo-photo-wrapper{position:absolute;width:100%;height:100%;z-index:100102;background-color:#000}#photo-sidebar{position:absolute;right:12px;width:34px;z-index:100110;line-height:0;bottom:140px}.pano_unfold_func{font-size:0}#photo-footer{position:absolute;width:100%;bottom:0;background-color:#000;z-index:100105}#photo-footer .photo-func-item{position:absolute}#photo-funcarea{padding-left:0;width:100%;background-color:#000;font-size:0;position:absolute;height:120px;bottom:15px}.pano_unfold_func{font-size:12px}.pano_funcarea_hide{}#photo-tips{width:100%;text-align:right;overflow:hidden;line-height:20px;font-size:12px;color:#797979;background-color:#000;position:absolute;bottom:0}#photo-tips span{font-size:12px}#photo-overview-wrapper{position:absolute;left:10px;bottom:20px;width:300px;height:106px;z-index:100110;visibility:hidden;border:2px solid #3D4145}#photo-overview-holder{width:300px;margin-right:10px}.photo-ui-layer{width:0;height:0;position:absolute;left:0;top:0;z-index:100111}#photo-return-btn{position:absolute;top:13px;left:13px;z-index:200002}#photo-return-btn .pano_button{background-color:#000;width:auto;text-decoration:none}#photo-return-btn .pano_button em{line-height:34px;height:34px;vertical-align:top;color:gray;font-style:normal;display:inline-block;text-decoration:none;margin-right:12px;font-size:12px}#photo-return-btn .pano_button span{background-image:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/album_aae0aec.png);width:11px;height:18px;background-position:-98px -80px}#photo-return-btn .pano_button:hover span{background-position:-79px -80px}#photo-return-btn .pano_button:hover em{color:#3af}.pano-copyright{text-align:right;padding-right:30px;display:inline-block}.pano-copyright span{margin-left:10px}.pano-copyright a{text-decoration:none;color:#797979}.pano-copyright .pano-feedback{text-decoration:underline;color:#3af}.pano_share_btn{margin-top:3px}.pano_share_btn .pano_button span{background-position:-108px 1px}.pano_share_btn .pano_button:hover span{background-position:-127px 1px}#photo-fold-btn .pano_button{height:25px;border-radius:2px 2px 0 0}#photo-fold-btn .pano_button span{width:18px;height:18px;margin:3px 8px}#photo-fold-btn .pano_button span{background-position:-72px -18px}#photo-fold-btn .pano_button:hover span{background-position:-90px -18px}.pano_unfold_sidebar #photo-fold-btn .pano_button span{background-position:-36px -18px}.pano_unfold_sidebar #photo-fold-btn .pano_button:hover span{background-position:-54px -18px}#photo-fold-btn{margin-top:3px}"});var layeroutResizeTimer=null,isUserHideAlbum=!1,PhotoTourLayoutManager=ModuleClass.extend("PhotoTourLayoutManager",{constructor:function(){},initialize:function(o){try{this._container=o,this.render()}catch(t){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:28})}},render:function(){try{var o=LAYER_TEMPLATE();this._tourLayoutContainer=T(o)[0],T(this._container).append(this._tourLayoutContainer),this.appendFoldBtn(T.g("photo-sidebar")),T.g("photo-container").onselectstart=function(){return!1}}catch(t){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:39})}},appendFoldBtn:function(o){var t=T.dom.create("li",{id:"photo-fold-btn","class":"fold_btn"});t.innerHTML='<a class="pano_button" title="折叠功能区" href="javascript:void(0)"><span></span></a>',o.appendChild(t);var n=this;T.on(t,"click",function(o){o.stopPropagation();o.target;n._toggleFoldArea(),n.dispatchEvent("fold_state_changed",{data:T("#photo-sidebar").hasClass("pano_unfold_sidebar")})}),T.on(T.g("photo-expand-wrapper"),"mouseup",function(o){o.stopPropagation()}),T.on(T.g("photo-expand-wrapper"),"mousedown",function(o){o.stopPropagation()})},getContainer:function(o){switch(o){case"tour":return T.g("photo-photo-wrapper");case"guide":return T.g("photo-funcarea");case"return":return T.g("photo-return-btn");case"expand":return T.g("photo-expand-wrapper");case"share":return T.g("photo-share-btn");default:return null}},updateCopyRight:function(o){var t=T.g("tourNameTip");t.innerHTML=o},showExpandArea:function(){this.getContainer("expand").style.display="block",this._toggleFoldArea(!0)},hideExpandArea:function(){this.getContainer("expand").style.display="none"},_toggleFoldArea:function(o){var t=T("#photo-fold-btn .pano_button"),n=T("#photo-funcarea"),a=T("#photo-sidebar"),e=n.hasClass("pano_funcarea_hide");if(!(o===!0&&!e||o===!1&&e)){var i=new Animation.Animation,p={duration:400,fps:40,delay:Animation.Animation.INFINITE,transition:Animation.Transitions.easeOutQuad,finish:function(){},render:function(){try{}catch(o){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:o.message||o.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:120})}}},r=(T("#pano-footer"),parseInt(n.css("height"))),s=parseInt(T("#photo-tips").css("height")),d=n.children();util.each(d,function(o){util.setOpacity(o,0)});var u,h;o===!0||void 0===o&&e?(n.removeClass("pano_funcarea_hide"),a.addClass("pano_unfold_sidebar"),t.attr("title","折叠功能区"),u=r,p.render=function(o){try{a.css("bottom",s+o*u+"px"),n.css("bottom",s+(o-1)*u+"px"),util.each(d,function(t){util.setOpacity(t,o)})}catch(t){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:146})}}):(n.addClass("pano_funcarea_hide"),a.removeClass("pano_unfold_sidebar"),t.attr("title","展开功能区"),h=r+s,u=h-s,p.render=function(o){try{a.css("bottom",h-o*u+"px"),n.css("bottom",-o*r+"px"),util.each(d,function(t){util.setOpacity(t,1-o)})}catch(t){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:t.message||t.description,path:"common:widget/pano/PhotoTour/PhotoTourLayout/PhotoTourLayoutManager.js",ln:161})}},p.finish=function(){util.each(d,function(o){util.setOpacity(o,1)})}),i.build(p),i.start()}},dispose:function(){this._container.removeChild(this._tourLayoutContainer)}});module.exports=PhotoTourLayoutManager});
;define("common:widget/pano/PhotoTour/PhotoTourModule/PhotoTourModule.js",function(o,t,e){var i=o("common:widget/pano/base/ModuleClass.js"),a=(o("common:widget/pano/base/util.js"),o("common:widget/pano/PhotoTour/PhotoTourModule/PhotoViewer.js"));o.loadCss({content:".photo-vertical:hover{cursor:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/pano_whole/vertical-hover_a509ed5.cur) 16 16,ew-resize}.photo-horizontal:hover{cursor:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/horizontal-hover_bf90a86.cur) 16 16,ew-resize}.photo-vertical:active{cursor:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/vertical-active_4112acd.cur) 16 16,ew-resize}.photo-horizontal:active{cursor:url(http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/horizontal-active_827b698.cur) 16 16,ew-resize}.photo-return-btn{position:absolute;top:13px;left:13px}.photo-btn{width:auto;text-decoration:none;background-color:#000;cursor:pointer;overflow:hidden;height:34px;display:inline-block;border-radius:4px;opacity:.8;width:70px}.photo-btn-icon{width:18px;height:18px;background-position:0 -18px;margin:8px;background-image:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pano_whole/pano-icons_249d710.png);background-repeat:no-repeat;display:inline-block}.photo-btn-text{line-height:34px;height:34px;color:gray;vertical-align:top;font-style:normal;display:inline-block;margin-right:12px}.photo-poiinfo{position:absolute}.photo-poiinfo-circle{cursor:pointer;height:100%;border-radius:100%;box-shadow:0 0 0 1px rgba(0,0,0,.5),0 0 0 4px rgba(255,255,255,.35),0 0 0 5px rgba(0,0,0,.5)}.photo-poiinfo-circle:hover{box-shadow:0 0 0 1px rgba(0,0,0,.5),0 0 0 4px rgba(255,255,255,1),0 0 0 5px rgba(0,0,0,.5)}.photo-poiinfo-text{text-align:center;color:#fff;font-weight:bolder;display:block;font-size:3em}#panoGuideAlbum .panoAlbum-item:hover{border:1px #3af solid}#panoGuideAlbum .panoAlbum-item .selected-item{position:absolute;top:0;left:0;border:3px solid #3af;z-index:5}body{padding:0;margin:0}#webgl{width:90%;height:80%;position:relative;border:1px solid red}.control{display:table;border-spacing:15px;float:right;width:300px;height:150px;position:absolute;background-color:rgba(0,0,0,.4);color:#fff;border:1px solid #fff;border-radius:4px;top:15px;left:15px;z-index:1}.control>div{margin:8px 0;display:table-row}.control>div>input,.control>div>label{display:table-cell}.PSAnnotations{position:absolute}.PSAnnotationViewer{position:absolute;top:0;left:0;z-index:6}.PSAnnotationViewer *{font:16px wf_segoe-ui_light,'Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif}.PSAnnotation{position:absolute;width:26px;height:26px;z-index:2;border-radius:50%;box-shadow:0 0 0 1px rgba(0,0,0,.5),0 0 0 4px rgba(255,255,255,.35),0 0 0 5px rgba(0,0,0,.5);cursor:pointer;opacity:0}.PSAnnotation:hover,.PSAnnotationHovered{box-shadow:0 0 0 1px rgba(0,0,0,.5),0 0 0 4px rgba(255,255,255,1),0 0 0 5px rgba(0,0,0,.5)}.photo-poiinfo-circle{display:none;position:absolute;z-index:100;cursor:pointer;height:100%;border-radius:100%;box-shadow:0 0 0 1px rgba(0,0,0,.5),0 0 0 4px rgba(255,255,255,.35),0 0 0 5px rgba(0,0,0,.5)}.photo-poiinfo-circle:hover{box-shadow:0 0 0 1px rgba(0,0,0,.5),0 0 0 4px rgba(255,255,255,1),0 0 0 5px rgba(0,0,0,.5)}.photo-poiinfo-text{text-align:center;display:block;color:#fff;font-weight:700}.photo-poiinfo-detail{display:none;position:absolute;z-index:101;top:0;left:0;width:210px;padding:10px;border-radius:6px;color:#fff;background:rgba(0,0,0,.6)}"});var n=i.extend("PhotoTourModule",{initialize:function(o,t){try{if(!a.isSupported())return;this.container=o,this.viewer=this._create(t)}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/pano/PhotoTour/PhotoTourModule/PhotoTourModule.js",ln:21})}},_create:function(o){var t="/panofeedback/panoPhotoTour/",e={id:o,domain:t,data_dir:"{id}/",json_file:"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/0.json",path_file:"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/path.bcpt",high_image_dir:"texture_2048/img{index}.jpg"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/pkg/texture_2048/img{index}.jpg*/,normal_image_dir:"texture/img{index}.jpg"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/pkg/texture/img{index}.jpg*/,low_image_dir:"atlas/atlas_{index}.jpg"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/pkg/atlas/atlas_{index}.jpg*/,geometry_dir:"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/mesh/mesh_{index}.bmpt"},i=this;if(this.tourid=o,"#no"==window.location.hash)return setTimeout(function(){i.dispatchEvent("photoview_complete")},300),{};var n=new a(this.container,e);return n.load(o,function(){i.container.className=n.isCircle()?"photo-horizontal":"photo-vertical",n.enableDrag(!0)}),n.on("ready",function(){i.dispatchEvent("photoview_complete")}),n.on("id_changed",function(){i.dispatchEvent("id_changed",{data:{id:o}})}),n},setTourid:function(o){this.viewer&&this.viewer.dispose(),this.viewer=this._create(o)},getSupportEvents:function(){return["photo_tour_exit"]},dispose:function(){this.viewer.dispose(),this.viewer=null,this.container=null}});e.exports=n});
;define("common:widget/pano/PhotoTour/PhotoTourShare/PhotoTourShare.js",function(require,exports,module){var ModuleClass=require("common:widget/pano/base/ModuleClass.js"),PanoShareUtil=require("common:widget/pano/PhotoTour/PhotoTourShare/PanoShareUtil.js"),PotoTourShare=ModuleClass.extend("PotoTourShare",{initialize:function(container,opts){try{this._opts=opts;var style='#photo-share-panel{position:absolute;right:38px;width:295px;height:95px;z-index:100010;padding:0 15px;color:#fff;font-size:12px;background-color:#000;opacity:.9;filter:alpha(opacity=90);_filter:alpha(opacity=90);border-radius:4px;font-size:12px}#photo-share-panel .head{height:20px;line-height:20px;margin-top:10px;margin-bottom:6px;width:100%}#photo-share-panel .close{float:right;width:18px;height:18px;background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pano_whole/pano-icons_249d710.png) no-repeat -108px -16px;_background:url(/static/images/pano_whole/photo-icons-8.png) no-repeat -108px -16px}#photo-share-panel .close:hover{background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pano_whole/pano-icons_249d710.png) no-repeat -126px -18px;cursor:pointer;_background:url(/static/images/pano_whole/photo-icons-8.png) no-repeat -126px -18px;cursor:pointer}#photo-share-panel .inputContainer{position:relative;float:left;vertical-align:middle}#photo-share-panel .inputContainer .input{width:240px;height:20px;text-indent:5px;background-color:#313335;border:1px #000 solid;vertical-align:middle;color:#fff}#photo-share-panel #photo-share-msg{position:absolute;right:0;top:0;width:60px;height:22px;line-height:22px;text-align:center;color:#3af;font-size:12px;border:1px solid #3af;display:none}#photo-share-panel .copyContainer{position:relative;float:left;vertical-align:middle;width:45px;height:23px;margin-left:2px}#photo-share-panel .copyContainer .copyBack{position:absolute;left:0;top:0;width:45px;height:22px;line-height:22px;margin-left:2px;background-color:#313335;border:1px #000 solid;color:#fff;text-align:center;text-decoration:none;z-index:1}#photo-share-panel .btn{position:absolute;left:0;top:0;z-index:2;width:45px;height:22px}#photo-share-panel .btn:hover{cursor:pointer}#photo-baiduShare{margin-top:2px}#pano_bdshare{width:140px;height:30px;overflow:hidden;float:left}span.bds_more,.bds_tools a{font-family:Arial,"Microsoft Yahei","微软雅黑",sans-serif;height:16px;float:left;display:block;padding-top:6px;padding-bottom:3px;padding-left:22px}#pano_bdshare .bds_more{float:left;padding-top:13px;padding-left:0}span.bds_btn_arr{float:left;height:10px;width:10px;margin-top:10px;padding-bottom:3px;margin-left:4px;cursor:pointer;background:url(http://webmap2.map.bdstatic.com/newmap/static/common/images/pano_whole/pano-icons_249d710.png) 0 -54px no-repeat;_background:url(/static/images/pano_whole/photo-icons-8.png) 0 -54px no-repeat}.bds_tools a{background:url(http://webmap1.map.bdstatic.com/newmap/static/common/images/bg_bdshare_d642b88.png) no-repeat;cursor:pointer}.bds_qzone{background-position:0 -85px!important}.bds_tsina{background-position:0 -125px!important}.bds_baidu{background-position:0 -165px!important}.bds_renren{background-position:0 -205px!important}.bds_tqq{background-position:0 -245px!important}.bds_kaixin001{background-position:0 -285px!important}.bds_hi{background-position:0 -365px!important}.bds_douban{background-position:0 -405px!important}.bds_tsohu{background-position:0 -445px!important}.bds_msn{background-position:0 -485px!important}.bds_fx{background-position:0 -525px!important}#bdshare_iwshare{margin-left:3px}#bdshare_iwshare.bds_tools{height:24px;_margin-top:-3px}#bdshare_iwshare.bds_tools a{padding-bottom:2px;+padding-bottom:4px}#bds_btn_arr_iwshare{_margin-top:-3px}';require.loadCss({content:style});var template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="photo-share-panel"><div class="head"><a id="photo-share-close" href="javascript:void(0)" title="关闭" class="close"></a>您可将当前地图上的内容分享给好友</div><ul><li class="inputContainer"><input id="photo-shareLink" class="input" type="text"/><span id="photo-share-msg"></span></li><li class="copyContainer"><span class="copyBack">复制</span><a id="copeLinkBtn" class="btn" title="复制"></a></li></ul><div id="photo-baiduShare"></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],html=template(),sharePanel=T(html)[0];sharePanel.style.top=opts.positionTop,container.appendChild(sharePanel);var copeBtn=T.g("copeLinkBtn"),flashBtn=baidu.swf.createHTML({id:"linkBtnFlh",url:"../swf/fClipboard.swf"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/swf/fClipboard.swf*/,width:"48",height:"26",wmode:"transparent",ver:"9.0.0"});copeBtn.innerHTML=flashBtn,this.bindCloseEvent(),this.bindCopyEvent(),this.addBaiduShare(),this.getShortLink(),this.bindGlobalClickEvent()}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/pano/PhotoTour/PhotoTourShare/PhotoTourShare.js",ln:49})}},getSupportEvents:function(){return["dispose"]},showMessage:function(o){var t=baidu.g("photo-share-msg");t.style.display="block",t.innerHTML=o,setTimeout(function(){t.style.display="none"},1300)},bindCopyEvent:function(){function o(){var o=baidu.swf.getMovie("linkBtnFlh");o&&o.flashInit&&o.flashInit()&&(clearInterval(a),o.setHandCursor(!0),o.setContentFuncName("pano_share_copy_getPasteData"))}var t=this,a=(T.G("photo-shareLink"),setInterval(o,500));window.pano_share_copy_getPasteData=function(){var o=T.G("photo-shareLink");return o?(t.showMessage("复制成功"),o.value):void 0}},bindCloseEvent:function(){var o=this;baidu.event.on("photo-share-close","click",function(){o.dispose()})},bindGlobalClickEvent:function(){var o=this,t=T.g("photo-share-panel");window.pano_share_global_click_handler=function(a){for(var e=a.srcElement||a.target;e;){if(e==t)return;if(e==document.body)return o.dispose(),void T.un(document.body,"mousedown",window.pano_share_global_click_handler);e=e.parentNode}},T.on(document.body,"mousedown",window.pano_share_global_click_handler)},getShortLink:function(){PanoShareUtil.getLink(this._opts.shareParam,function(o){baidu.g("photo-shareLink").value=o})},addBaiduShare:function(){var o=this,t=baidu.g("photo-baiduShare"),a=T.G("photo-shareLink");PanoShareUtil.creatShare(t,function(){return{roadName:o._opts.address,link:a.value}})},dispose:function(){T.g("photo-share-panel")&&baidu.dom.remove("photo-share-panel")}});module.exports=PotoTourShare});
;define("common:widget/pano/PhotoTour/PhotoTourShare/PanoShareUtil.js",function(e,t,n){var o=e("common:widget/ui/config/config.js"),i=o.urlConfig,a={SHARE_PROC_URL:"http://j.map.baidu.com/",getShareKeyList:function(){return{tsina:{title:"分享到新浪微博",code:1307,cbkcode:1317},tqq:{title:"分享到腾讯微博",code:1308,cbkcode:1318},qzone:{title:"分享到QQ空间",code:1306,cbkcode:1316},renren:{title:"分享到人人网",code:1309,cbkcode:1319},baidu:{title:"分享到百度搜藏",code:1310,cbkcode:1320},kaixin001:{title:"分享到开心网",code:1311,cbkcode:1321},hi:{title:"分享到百度空间",code:1312,cbkcode:1322},douban:{title:"分享到豆瓣网",code:1313,cbkcode:1323},tsohu:{title:"分享到搜狐微博",code:1314,cbkcode:1324},msn:{title:"分享到Myspace",code:1315,cbkcode:1325},fx:{title:"分享到飞信",code:1326,cbkcode:1327}}},getLink:function(e,t){var n=[];for(var o in e)null!=e[o]&&n.push(o+"="+e[o]);var i="http://map.baidu.com/?newmap=1&shareurl=1&"+n.join("&"),a=this.SHARE_PROC_URL+"?url="+encodeURIComponent(i)+"&web=true",r=!1;T.jsonp(a,function(e){r=!0,t(e&&e.url||i)}),setTimeout(function(){0==r&&t(i)},3e3)},creatShare:function(e,t){var n=this,o=this.getShareKeyList(),i=['<div id="pano_bdshare" class="bds_tools"><span class="bds_more">分享到：</span>'];for(var a in o){var r=o[a].title;i.push('<a _key="'+a+'" class="bds_'+a+'" title="'+r+'"></a>')}i.push('</div><span class="bds_btn_arr" id="pano_bds_btn_arr" title="更多网站"></span>'),e.innerHTML=i.join("");{var c=T.G("pano_bdshare"),d=T.G("pano_bds_btn_arr");c.getElementsByTagName("a")}d.onclick=function(){var e=178,t=120,o=15,i=0;!function a(){o>i&&(i++,c.style.width=Math.ceil(n._tween(i,e,t,o))+"px",setTimeout(a,10))}(),d.style.display="none"},T.on(c,"click",function(e){var o=e.target||e.srcElement,i=o.getAttribute("_key");o&&i&&n._openLink(window.open("about:blank"),i,t)})},_tween:function(e,t,n,o){return n*((e=e/o-1)*e*e+1)+t},_openLink:function(e,t,n){if(e){var o=n(),i=this._getShareInfo(o.roadName,o.link),a=i.text,r=(i.point,o.link+"#bshare-"+t);"fx"==t&&(r=r);var c,d="";("qzone"==t||"tsohu"==t)&&(c="../../../../../map.baidu.com/image/logo-map.png"/*tpa=http://map.baidu.com/image/logo-map.png*/),c="../../../../../map.baidu.com/fwmap/upload/r/image/2014-09-02/8f68908c1c4c0b824b8df2def4ba1cf8.jpg"/*tpa=http://map.baidu.com/fwmap/upload/r/image/2014-09-02/8f68908c1c4c0b824b8df2def4ba1cf8.jpg*/,d=a;var s={to:t,url:r,pic:c,title:a,type:"text",desc:d,comment:" ",key:""};"tsina"==t&&(s.key="3694297746"),"tqq"==t&&(s.key="801199301");var u="http://share.baidu.com/s?"+this._jsonToQuery(s,encodeURIComponent);"renren"==t&&(s={resourceUrl:r,pic:c,title:a,description:d,charset:"UTF-8"},u="http://widget.renren.com/dialog/share?"+this._jsonToQuery(s,encodeURIComponent));try{e.location.href=u,e.focus()}catch(p){}}},_getShareInfo:function(e,t){{var n=e||"",o="【百度全景-照片游】";this.cinfo}return{text:n+" "+t+" "+o}},_jsonToQuery:function(e,t){var n=[];t=t||function(e){return e};for(var o in e){var i=e[o];""!=i&&null!=i&&"undefined"!=typeof i&&n.push(o+"="+t(i))}return n.join("&")},getPanoShare3DImageUrl:function(e){var t=i.PANO_URL+"?qt=share",n={panoid:e.panoId,heading:e.panoHeading,pitch:e.panoPitch,fovy:75,width:460,height:250,watermark:"baidumap",quality:80};for(var o in n)t=t+"&"+o+"="+n[o];return t}};n.exports=a});