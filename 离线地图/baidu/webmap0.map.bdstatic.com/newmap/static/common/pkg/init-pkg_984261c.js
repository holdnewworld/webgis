define("common:widget/com/BaseComponent.js",function(o,e,n){function t(o){T.lang.Class.call(this),this.dom=o.dom,this.opts=o||{},this.$parentEl=T(this.opts.dom),this.json=this.opts.json,this.cinfo=this.opts.cinfo||{},this.name=this.opts.name}T.inherits(t,T.lang.Class,"BaseComponent"),T.extend(t.prototype,{render:function(){try{return!0}catch(o){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:o.message||o.description,path:"common:widget/com/BaseComponent.js",ln:28})}},initialize:function(){try{}catch(o){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:o.message||o.description,path:"common:widget/com/BaseComponent.js",ln:33})}},unload:function(o){this.removeFromManager(o)},removeFromManager:function(){var e=o("common:widget/com/componentManager.js");e.remove(this._className)}}),n.exports=t});
;define("common:widget/com/MapComponent.js",function(e,t,o){function i(e){e=e||{},e.cinfo=e.cinfo||{},this.dom=e.dom=T("#MapInfo"),this.modelQuery=e.url,this.isMainRequest="no"===e.isMainRequest?!1:!0,this.startCity={name:c.cityName,code:c.cityCode},(null==e.cinfo.city||null==e.cinfo.city.name)&&(e.cinfo.startCity={name:this.startCity.name,code:this.startCity.code}),map.enableLoadTiles=!0,n.call(this,e);var t=!0;"record"in e&&(t=e.record),t&&r.record(e),this.isMainRequest&&map.clearOverlays(),map.fullScreenMode&&e.cinfo&&e.cinfo.exitLargeMapMode&&window.fullScreenCtrl&&window.fullScreenCtrl.exitFull(!0),this.isMainRequest&&this.json&&this.json.result&&!m.active&&(11==this.json.result.type||1==this.json.result.type||36==this.json.result.type||2==this.json.result.type)?(c.enableMapMove=!1,window.mapMoveTimer&&clearTimeout(window.mapMoveTimer),window.mapMoveTimer=setTimeout(function(){c.enableMapMove=!0},4e3)):this.isMainRequest&&(window.mapMoveTimer&&clearTimeout(window.mapMoveTimer),c.enableMapMove=!0),window.currentComponent=this}var n=e("common:widget/com/BaseComponent.js"),s=e("common:widget/ui/searchData/searchData.js"),a=e("common:widget/ui/config/config.js"),r=e("common:widget/ui/history/history.js"),c=a.modelConfig,m=e("common:widget/ui/Weather/Weather.js");T.inherits(i,n,"MapComponent"),T.extend(i.prototype,{statusChange:function(e,t){this.modelQuery=e,s.fetch(e,t)},render:function(){try{return!0}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/MapComponent.js",ln:107})}},initialize:function(){try{}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/MapComponent.js",ln:112})}},unload:function(){this.removeFromManager(),this.destroy&&this.destroy(),this.dom.html(""),n.prototype.unload.apply(this,arguments)}}),o.exports=i});
;define("common:widget/com/componentManager.js",function(require,exports,module){var searchData=require("common:widget/ui/searchData/searchData.js"),util=require("common:widget/ui/util/util.js"),modelCode={1:"City",2:"City",5:"BusStops",6:{special:{condition:"json.content.poiType===0",component:"PoiSearch"},defaultComponent:"Detail"},7:"Clarify",11:"PoiSearch",13:"RouteAddr",14:"BusTrans",15:"LinesQuery",18:"BusLines",19:"RouteAddr",20:"NavTrans",21:"SearchInView",22:"BusTrans",23:"RouteAddr",24:"RouteAddr",26:"SpecialPoi",28:"District",29:"RouteAddr",31:"NavWalk",36:"PoiSearch",37:"Clarify",38:"PoiSearch",39:"SearchInView",40:"Clarify",41:"PoiAddr",48:"CBusTrans"},printModel=["City","PoiSearch","SearchInView","BusTrans","NavTrans","CBusTrans"],components={},compMonitorFlag=!1,componentManager={start_event:0,compMonitorFlag:!1,go:function(url,opts,callback){"function"==typeof opts&&(callback=opts,opts={}),opts=opts||{};var me=this;me.start_event=(new Date).getTime(),searchData.fetch(url,function(json){if(me.start_send=(new Date).getTime(),opts.json=json,opts.url=url,json&&json.result&&json.result.auth&&(window.AUTH=json.result.auth),1&json.result.result_show)return map.setMapType(BMAP_SATELLITE_MAP),void(window.maptypeCtrl&&window.maptypeCtrl.streetMapMgr(!0));var type=json.result.type,componentName=modelCode[type];if(!T.isString(componentName)&&componentName&&componentName.defaultComponent){var selector=componentName;if(componentName=selector.defaultComponent,selector.special){var flag=!0;try{eval(selector.special.condition)||(flag=!1)}catch(e){flag=!1}flag&&(componentName=selector.special.component)}}componentName&&(compMonitorFlag=!0,"NavTrans"==componentName||"RouteAddr"==componentName?me.loadTPMAsync(function(){me.load(componentName,opts,callback)}):me.loadPlaceAsync(function(){me.load(componentName,opts,callback)}))},function(){me.start_send=(new Date).getTime(),me.load("Error",{dom:baidu("#MapInfo")})})},load:function(e,o,n){var t=this,a={};o=o||{},o.dom=T(o.dom?o.dom:"#MapInfo"),o.name=e,require.async("common:widget/com/"+e+"/"+e+".js",function(r){t.transfer_time=(new Date).getTime();for(var i in components)null!=components[i]&&components[i].dom&&o.dom&&components[i].dom[0]===o.dom[0]&&(components[i].unload(components[i]._className,o),t.remove(i));if("Fav"!=e){var c=require("common:widget/ui/BoxContainer/BoxContainer.js");c&&c.exit()}!window.currentComponent||"PoiSearch"!=currentComponent._className&&"SearchInView"!=currentComponent._className||(t.preModuleName=window.currentComponent._className);var s=new r(o);components[e]=s,t.setBeforeRender(s,o);var m=s.render();if(m&&"object"==typeof m)s.$parentEl.empty().append(s.$el);else if(m&&"string"==typeof m)s.$el=T(m),s.$parentEl.empty().append(s.$el);else if(!m)return;if(o.json&&t.setInitStatus(s,o),s.initialize(),"function"==typeof o.onload&&o.onload(s),n&&n(s),window.isPrint&&baidu.array.contains(printModel,s._className)&&t.loadPrintCom(s),t.start_send){var l="z_"+e.toLowerCase()+"_load_time",u=t.transfer_time-t.start_send;u>0&&(a[l]=u,alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/cus.fire","time",a))}})},get:function(e){return components[e]},remove:function(e){components[e]=null},setBeforeRender:function(e,o){try{var n=o.json||{},t=require("common:widget/ui/Weather/Weather.js"),a=require("common:widget/ui/indexUtil/IndexUtil.js"),r=require("common:widget/ui/config/config.js"),i=r.modelConfig;if(util.loadSearchInfo(function(e){e.rangeSearchCenterMarker&&(e.rangeSearchCenterMarker.remove(),e.rangeSearchCenterMarker=null)}),e.isMainRequest&&n.current_city){var c=n.current_city;t.active=i.cityName!==c.name&&!n.weather,a.setCurCity(c.name,c.code,c.type,c),null!=c.sup_bus&&a.setSupBus(c.sup_bus),i.upCityid=c.up_cityid?c.up_cityid:c.code,window.clearClarify=null}}catch(s){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:s.message||s.description,path:"common:widget/com/componentManager.js",ln:310})}},setInitStatus:function(e,o){var n=o.json||{},t=require("common:widget/ui/mapInfo/mapInfo.js"),a=require("common:widget/ui/fullScreen/fullScreen.js");n.hot_city&&window._OLR&&(window._OLR.hot_city=n.hot_city),1&n.result.result_show&&1==n.result.pattern_sign||window.GRControll&&window.GRControll.clearAfterGetAtBase(n),!map.fullScreenMode&&"close"!=t.status||window.GRControll&&window.GRControll.isGRequest&&!o.history||(map.fullScreenMode?n&&n.result&&2==n.result.type||o.cinfo&&0==o.cinfo.exitLargeMapMode||(a&&a.exitFull(void 0),"close"==t.status&&t.show()):"close"==t.status&&(n&&n.result&&2==n.result.type||o.cinfo&&0==o.cinfo.exitLargeMapMode||t.show()))},loadPrintCom:function(e){var o=e._className+"Print";require.async("common:widget/print/"+o+"/"+o+".js",function(e){var o=new e;o.initialize(currentComponent)})},loadPlaceAsync:function(e){require.async(["common:widget/ui/place/place.js","common:widget/ui/place/hotelFilter.js","common:widget/ui/place/caterFilter.js","common:widget/ui/place/scopeFilter.js","common:widget/ui/place/cinemaFilter.js","common:widget/ui/place/caterList.js","common:widget/ui/place/caterPopInner.js"],function(o,n,t,a,r,i,c){o.hotel=n,o.cater=t,o.scope=a,o.cinema=r,o.caterList=i,o.caterPopInner=c,window.place=o,e&&e()})},loadTPMAsync:function(e){require.async(["common:widget/ui/throughpoint/Throughpoint.js"],function(o){window.TPM=o,e&&e(o)})}};window.componentManager=componentManager,module.exports=componentManager});
;define("common:widget/com/UserAuth/userAuth.js",function(e,t,n){function a(e,t){var n=document.createElement("script");n.src=e+"&auth="+window.AUTH,n.type="text/javascript",n.charset="utf-8",n.addEventListener?n.addEventListener("load",function(e){var n=e.target;n.parentNode.removeChild(n),t&&t()},!1):n.attachEvent&&n.attachEvent("onreadystatechange",function(){var e=window.event.srcElement;!e||"loaded"!==e.readyState&&"complete"!==e.readyState||e.parentNode.removeChild(e)}),document.getElementsByTagName("head")[0].appendChild(n)}n.exports={sendUserOp:function(e){a("/?newmap=1&pcevaname=pc2&qt=userOp&useraction="+e.type.replace("end","").replace("on",""))},sendSugg:function(e){a("/?newmap=1&pcevaname=pc2&qt=userOp&useraction=sugg"+e)},sendImage:function(e){a("/?newmap=1&pcevaname=pc2&qt=image&type="+e)}}});
;define("common:widget/view/View.js",function(e,i,n){function t(){T.lang.Class.call(this)}T.inherits(t,T.lang.Class,"View"),T.extend(t.prototype,{render:function(){try{return!0}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/view/View.js",ln:11})}},initialize:function(){try{}catch(e){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/exception.fire","catch",{msg:e.message||e.description,path:"common:widget/view/View.js",ln:15})}},unload:function(){}}),n.exports=t});
;define("common:widget/ui/areaCfg/areaCfg.js",function(n,a,e){var i="中国|1,安徽|23,福建|16,甘肃|6,广东|7,广西|17,贵州|24,海南|21,河北|25,黑龙江|2,河南|30,湖北|15,湖南|26,江苏|18,江西|31,吉林省|9,辽宁|19,内蒙古|22,宁夏|20,青海|11,山东|8,山西|10,陕西|27,四川|32,新疆|12,西藏|13,云南|28,浙江|29,北京|131,天津|332,石家庄|150,唐山|265,秦皇岛|148,邯郸|151,邢台|266,保定|307,张家口|264,承德|207,沧州|149,廊坊|191,衡水|208,太原|176,大同|355,阳泉|357,长治|356,晋城|290,朔州|237,晋中|238,运城|328,忻州|367,临汾|368,吕梁|327,呼和浩特|321,包头|229,乌海|123,赤峰|297,通辽|64,鄂尔多斯|283,呼伦贝尔|61,巴彦淖尔|169,乌兰察布|168,兴安盟|62,锡林郭勒盟|63,阿拉善盟|230,沈阳|58,大连|167,鞍山|320,抚顺|184,本溪|227,丹东|282,锦州|166,营口|281,阜新|59,辽阳|351,盘锦|228,铁岭|60,朝阳|280,葫芦岛|319,长春|53,吉林市|55,四平|56,辽源|183,通化|165,白山|57,松原|52,白城|51,延边朝鲜族自治州|54,哈尔滨|48,齐齐哈尔|41,鸡西|46,鹤岗|43,双鸭山|45,大庆|50,伊春|40,佳木斯|42,七台河|47,牡丹江|49,黑河|39,绥化|44,大兴安岭地区|38,上海|289,南京|315,无锡|317,徐州|316,常州|348,苏州|224,南通|161,连云港|347,淮安|162,盐城|223,扬州|346,镇江|160,泰州|276,宿迁|277,杭州|179,宁波|180,温州|178,嘉兴|334,湖州|294,绍兴|293,金华|333,衢州|243,舟山|245,台州|244,丽水|292,合肥|127,芜湖|129,蚌埠|126,淮南|250,马鞍山|358,淮北|253,铜陵|337,安庆|130,黄山|252,滁州|189,阜阳|128,宿州|370,巢湖|251,六安|298,亳州|188,池州|299,宣城|190,福州|300,厦门|194,莆田|195,三明|254,泉州|134,漳州|255,南平|133,龙岩|193,宁德|192,南昌|163,景德镇|225,萍乡|350,九江|349,新余|164,鹰潭|279,赣州|365,吉安|318,宜春|278,抚州|226,上饶|364,济南|288,青岛|236,淄博|354,枣庄|172,东营|174,烟台|326,潍坊|287,济宁|286,泰安|325,威海|175,日照|173,莱芜|124,临沂|234,德州|372,聊城|366,滨州|235,菏泽|353,郑州|268,开封|210,洛阳|153,平顶山|213,安阳|267,鹤壁|215,新乡|152,焦作|211,濮阳|209,许昌|155,漯河|344,三门峡|212,南阳|309,商丘|154,信阳|214,周口|308,驻马店|269,武汉|218,黄石|311,十堰|216,宜昌|270,襄阳|156,鄂州|122,荆门|217,孝感|310,荆州|157,黄冈|271,咸宁|362,随州|371,恩施土家族苗族自治州|373,仙桃|1713,潜江|1293,天门|2654,神农架林区|2734,长沙|158,株洲|222,湘潭|313,衡阳|159,邵阳|273,岳阳|220,常德|219,张家界|312,益阳|272,郴州|275,永州|314,怀化|363,娄底|221,湘西土家族苗族自治州|274,广州|257,韶关|137,深圳|340,珠海|140,汕头|303,佛山|138,江门|302,湛江|198,茂名|139,肇庆|338,惠州|301,梅州|141,汕尾|339,河源|200,阳江|199,清远|197,东莞|119,中山|187,潮州|201,揭阳|259,云浮|258,南宁|261,柳州|305,桂林|142,梧州|304,北海|295,防城港|204,钦州|145,贵港|341,玉林|361,百色|203,贺州|260,河池|143,来宾|202,崇左|144,海口|125,三亚|121,五指山|1644,琼海|2358,儋州|1215,文昌|2758,万宁|1216,东方|2634,定安|1214,屯昌|1641,澄迈|2757,临高|2033,白沙黎族自治|2359,昌江黎族自治|1642,乐东黎族自治|2032,陵水黎族自治|1643,保亭黎族苗族自治|1217,琼中黎族苗族自治|2031,重庆|132,成都|75,自贡|78,攀枝花|81,泸州|331,德阳|74,绵阳|240,广元|329,遂宁|330,内江|248,乐山|79,南充|291,眉山|77,宜宾|186,广安|241,达州|369,雅安|76,巴中|239,资阳|242,阿坝藏族羌族自治州|185,甘孜藏族自治州|73,凉山彝族自治州|80,贵阳|146,六盘水|147,遵义|262,安顺|263,铜仁地区|205,黔西南布依族苗族自治州|343,毕节地区|206,黔东南苗族侗族自治州|342,黔南布依族苗族自治州|306,昆明|104,曲靖|249,玉溪|106,保山|112,昭通|336,丽江|114,临沧|110,楚雄彝族自治州|105,红河哈尼族彝族自治州|107,文山壮族苗族自治州|177,普洱|108,西双版纳傣族自治州|109,大理白族自治州|111,德宏傣族景颇族自治州|116,怒江傈僳族自治州|113,迪庆藏族自治州|115,拉萨|100,昌都地区|99,山南地区|97,日喀则地区|102,那曲地区|101,阿里地区|103,林芝地区|98,西安|233,铜川|232,宝鸡|171,咸阳|323,渭南|170,延安|284,汉中|352,榆林|231,安康|324,商洛|285,兰州|36,嘉峪关|33,金昌|34,白银|35,天水|196,武威|118,张掖|117,平凉|359,酒泉|37,庆阳|135,定西|136,陇南|256,临夏回族自治州|182,甘南藏族自治州|247,西宁|66,海东地区|69,海北藏族自治州|67,黄南藏族自治州|70,海南藏族自治州|68,果洛藏族自治州|72,玉树藏族自治州|71,海西蒙古族藏族自治州|65,银川|360,石嘴山|335,吴忠|322,固原|246,中卫|181,乌鲁木齐|92,克拉玛依|95,吐鲁番地区|89,哈密地区|91,昌吉回族自治州|93,博尔塔拉蒙古自治州|88,巴音郭楞蒙古自治州|86,阿克苏地区|85,克孜勒苏柯尔克孜自治州|84,喀什地区|83,和田地区|82,伊犁哈萨克自治州|90,塔城地区|94,阿勒泰地区|96,石河子|770,阿拉尔|731,图木舒克|792,五家渠|789,香港特别行政区|2912,澳门特别行政区|2911,凤凰县|1724,台北|9002,高雄|9019".split(","),r=[];!function(){for(var n=0;n<i.length;n++){var a=i[n].split("|");r[a[0]]=a[1]}}(),null!=r["中国"]&&(r["全国"]=r["中国"]),e.exports=r});
;define("common:widget/ui/stat/CodeStat.js",function(e,r,t){function o(){var e={},r=document.referrer&&document.referrer.match(/^(?:(\w+):\/\/)?(?:(\w+):?(\w+)?@)?([^:\/\?#]+)(?::(\d+))?(\/[^\?#]+)?(?:\?([^#]+))?(?:#(\w+))?/);if(r)var t=r[4];else var t="";var o,n=T.url.queryToJson(location.search);if("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/www.hao123.com"==t?o="hao123":"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/www.baidu.com"==t?"alamap"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/==n.from?(o="阿拉丁",e.alatpl=n.tpl):(o="pstab",e.pstabDetail=-1==document.referrer.indexOf("word")?"搜索前":"搜索后"):""==t?o="自有用户":(o="其他来源",e.otherReferer=t),n.third_party&&(e.third_party=n.third_party),n.s){var a=n.s.substring(0,n.s.indexOf("%"));a&&(e.qt=a);var i=T.url.queryToJson(decodeURIComponent(n.s));i&&i.wd&&(e.wd=i.wd)}e.refer=o,ccStat("pageLoad",e)}var n=function(){function r(e){var r,t=window.poiResponse,o=t&&t.result,e=e||{};if(t&&o){r={from:"map",query:o.return_query||o.wd||"",qid:o.qid||"",page_num:isNaN(Number(o.page_num))?"":""+o.page_num};for(var n in r)r.hasOwnProperty(n)&&r[n]&&(e[n]=r[n])}return e}function t(e,r){e&&(d=!0,setTimeout(function(){if(e.src&&-1!=e.src.indexOf("class="))var r="http://log.map.baidu.com/t.gif?"+e.src;else var r="/newmap/static/common/images/transparent.gif?newmap=1"+e;i.src=r,i.onload=o},r||50))}function o(){var e=c.shift();return e?void t(e):void(d=!1)}function n(){d=!1,o()}function a(e,r){var t="";for(var o in e)"undefined"!=typeof e[o]&&(t=r?t+"&"+o+"="+encodeURIComponent(e[o]):t+"&"+o+"="+e[o]);return t}var i=new Image,d=!1,c=[],u=e("common:widget/ui/config/config.js"),s=u.modelConfig;return i.onload=n,i.onerror=n,window.statParamInterceptor=r,{addStat:function(e,o,n){if(e){var i,n=n||{};if(n.da_par=window._SOURCE,n.da_e_name="pcmap2","number"==typeof e)n=o||{},(n.uid||n.tag||n.useraction)&&(n=r(n)),n.code=e,n.t=(1e8*Math.random()).toFixed(0),n.c=s.cityCode,i=a(n,!0);else{if(o=o||"click",!e||"string"!=typeof o||!DA_ACT[o.toUpperCase()])return;n.da_src=e,n.da_act=o,n.resid=61,n.t=(new Date).getTime(),i=a(n)}d?c.push(i):t(i,0)}},classStat:function(){}}}();window.addStat=n.addStat,window.ccStat=n.classStat,function(){function e(e,r,o,n){var a=Math.floor(.001*(new Date).getTime()),i=new Image;i.src="http://log.map.baidu.com/errorreport?product="+e+"&model="+r+"&type="+o+"&detail="+encodeURIComponent(n)+"&t="+a+"&c="+t}function r(e){var r=Math.floor(.001*(new Date).getTime()),t=new Image;t.src="http://log.map.baidu.com/tn.gif?module="+e.module+"&time="+r+"&subvalue="+e.subtype+"&subtype="+e.type+"&value="+e.value+"&detail="+encodeURIComponent(e.detail)+"&logid="+e.logid+"&represent="+e.represent}var t="unknow";T.browser.chrome&&(t="chrome"+T.browser.chrome),T.browser.ie&&(t="ie"+T.browser.ie),window.ReportError=function(r,t,o){!r&&window.currentComponent&&(r=window.currentComponent.__type),"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/map.baidu.com"==location.host&&Math.random()<.005&&e("PCMAP_JS",r,t,o)};var o={};window.ErrorMonitor=function(e,t,n,a,i){void 0===a?a=.2:a===!0&&(a=1);var d=a;if(("BASE"==t||"succ"==t)&&(d=.01*a),"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/map.baidu.com"==location.host&&Math.random()<d){{Math.random()}if("BASE"!=t){if(i=i||{},i.unique){if(o[e])return;o[e]=!0}i.xhr=i.xhr||{};var c=i.xhr.timeEnd?i.xhr.timeEnd-i.xhr.timeStart:i.xhr.endTime-i.xhr.startTime;r({module:e,type:i.type,subtype:t,value:c,detail:i.url,logid:i.xhr.getResponseHeader&&i.xhr.getResponseHeader("HTTP_X_BD_LOGID"),represent:d})}}},window.onerror=function(e,r,t,o){return ReportError(null,"execute_error",e+"."+t+"."+o),!1}}(),t.exports={addStat:n.addStat,ccStat:n.classStat,pvstat:o}});
;define("common:widget/ui/util/util.js",function(n,e,t){var i={taxi:[131,289,257,340,75,332,179,218,224,315,132,268,233,288,236,158],smp:[1,2,11,21,26,28,36,38,39,41],smpSug:["PoiSearch","BusSearchSta","BusSearchEnd","DriveSearchSta","DriveSearchEnd","iw_ssn","iw_esn"]},r={beforeEndHTML:function(n,e){var t=document.createElement("div");t.innerHTML=e;for(var i=t.childNodes.length,r=0;i>r;r++)n.appendChild(t.childNodes[0]);return t=null,n.lastChild},formatBounds:function(n){var e=n||map.getBounds();return e?"("+e.minX+","+e.minY+";"+e.maxX+","+e.maxY+")":""},formatBlinfo:function(n){for(var e,t=[],i=0,r={},o=n.length;o>i;i++)if(e=n[i].addr,r[e]){var a=t[r[e]-1];a.uid=a.uid+"_"+n[i].uid,a.index=a.index+"_"+i,t.push(n[i])}else{var u=T.extend({},n[i]);t.push(u),t[i].index=i,r[e]=i+1}return t},geoToPoint:function(n){var e=n.split("|");if(1==e[0]){var t=e[1].split(","),i=new BMap.Point(parseFloat(t[0]),parseFloat(t[1]));return i}},getParam:function(n){if(n.indexOf("?")>-1)var e=n.slice(n.indexOf("?")+1);else{if(!(n.indexOf("#")>-1))return;var e=n.slice(n.indexOf("#")+1)}if(""!=e){for(var t={},i=e.split("&"),r=0;r<i.length;r++){var o=i[r].split("=");if(o[1]){var a=o[1].indexOf("#");o[1]=a>-1?o[1].slice(0,a):o[1],t[o[0]]=o[1]}}return t}},extendHashParam:function(n,e){if(n.indexOf("#")>-1){var t=n.slice(n.indexOf("#")+1);if(""!=t)for(var i=t.split(/[&\?]/),r=0;r<i.length;r++){var o=i[r].split("=");if(o[1]){var a=o[1].indexOf("#");o[1]=a>-1?o[1].slice(0,a):o[1],e[o[0]]=o[1]}}}return e},getOverlayPoint:function(n){return n.getPoint?n.getPoint():n.getPosition()},getPointByStr:function(n){if("string"==typeof n){var e=n.split(",");if(!(e.length<2))return new BMap.Point(e[0],e[1])}},getBPoints:function(n){if(n&&0!=n.length){for(var e=[],t=0;t<n.length;t++)if(n[t])for(var i=n[t].split(";"),r=0;r<i.length;r++){var o=this.getPointByStr(i[r]);e.push(o)}return e}},getPointsBounds:function(n){for(var e=new BMap.Bounds,t=0,i=n.length;i>t;t++)e.extend(n[t]);return e},getPoiPoint:function(n){var e=[],t=null;if("Point"==n.toString())t=n;else{if("string"==typeof n){if(e=T.trim(n).split(","),e.length<2)return;e[0]=parseFloat(T.trim(e[0])),e[1]=parseFloat(T.trim(e[1]))}else if(e=n.slice(0),e.length<2)return;t=new BMap.Point(e[0],e[1])}return t},parseGeo:function(n){if("string"==typeof n){var e=n.split("|"),t=parseInt(e[0]),i=e[1],r=e[2],o=r.split(";");if(4===t){for(var a=[],u=0;u<o.length-1;u++)"1"===o[u].split("-")[0]&&a.push(o[u].split("-")[1]);o=a,o.push("")}var s=[];switch(t){case 1:s.push(o[0]);break;case 2:case 3:case 4:for(var u=0;u<o.length-1;u++){var f=o[u];if(f.length>100)f=f.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;"),s.push(f);else{for(var l=[],d=f.split(","),c=0;c<d.length;c+=2){var p=d[c],h=d[c+1];l.push(p+","+h)}s.push(l.join(";"))}}}return s.length<=1&&(s=s.toString()),{type:t,bound:i,points:s}}},isInteger:function(n){return/^\+?[1-9][0-9]*$/.test(n)},filtQuery:function(n){return n=n||"",n.replace(/[\uac00-\ud7a3]/g,"").replace(/\u2022|\u2027|\u30FB/g,String.fromCharCode(183)).replace(/^\s*|\s*$/g,"")},fixed:function(n,e){for(var n=n.toString();n.length<e;)n="0"+n;return n},isInBounds:function(n,e){return e=e||map.getBounds(),e.containsPoint(n)},supportMinHeight:function(){var n;return function(){if(void 0===n){var e=document.createElement("div"),t=document.body;e.style.minHeight="100px",e.style.height="auto",e.style.padding="0",e.style.borderWidth="0",n=100===t.appendChild(e).offsetHeight,t.removeChild(e)}return n}}(),getClientSize:function(){var n=document;return{width:n.body.clientWidth,height:n.body.clientHeight}},jsonToQuery:function(n,e){var t=[];e=e||function(n){return n};for(var i in n){var r=n[i];""!=r&&null!=r&&"undefined"!=typeof r&&t.push(i+"="+e(r))}return t.join("&")},isActiveCity:function(n,e){return T.array.some(i[n],function(n){return n==e})},stopBubble:function(n){var n=window.event||n;n.stopPropagation?n.stopPropagation():n.cancelBubble=!0},preventDefault:function(n){var n=window.event||n;return n.preventDefault?n.preventDefault():n.returnValue=!1,!1},purgeEvents:function(n){if(n){var e=n.attributes,t="";if(e)for(var i=0,r=e.length;r>i;i++)t=e[i].name,"function"==typeof n[t]&&(n[t]=null);var o=n.childnodes;if(o)for(var i=0,r=o.length;r>i;i++)arguments.callee(n.childnodes[i])}},loadSearchInfo:function(e){n.async("common:widget/ui/searchInfoWindow/searchInfoWindow.js",function(n){e&&e(n)})}};t.exports=r});
;define("common:widget/ui/config/config.js",function(t,a,i){var e=t("common:widget/ui/areaCfg/areaCfg.js"),o={"3d_city":{},poiSearch:{enableRoute:!0,showCircle:!0},busTrans:{enableDragging:!0},navTrans:{enableDragging:!0},navWalk:{enableDragging:!0},host:function(t,a){if(!t)return"";var i=c.cdnHost;if(!T.isArray(i)||!i.length)return t;var e=t.split("."),o=1===e.length?e[0]:e[e.length-2],p=o.charCodeAt(o.length-1);return i=i[p%i.length],/^http[s]?:\/\//.test(t)?t.replace(/^http[s]?:\/\/[^\/]*/,i):i+(0==t.indexOf("/")?"":"/")+t},smFlwCon:""},p={DATA_URL:"?newmap=1&reqflag=pcmap&biz=1&pcevaname=pc2&da_par="+window._SOURCE+"&from=webmap&qt=",MAIN_BOX:"MapInfo",cityName:"全国",cityCode:e["全国"],upCityid:e["全国"],highLevel:19,cityType:0,supBus:0,sup:0,level:{country:5,province:11,city:12,area:13},defalutCityCode:null,enableMapMove:!0,panoCityName:"",panoCityCode:"",timg:"../images/transparent.gif"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/transparent.gif*/},n=TVC.ditu,m={normal:n.normal.version,satellite:n.satellite.version,normalTraffic:n.normalTraffic.version,satelliteTraffic:n.satelliteTraffic.version,mapJS:n.mapJS.version,INDOOR_CLICK_VER:n.panoClick.version,UDT_VERSION:n.panoUdt.version},c={PANO_URL:"http://pcsv0.map.bdimg.com/",PANO_TILE_URL:["http://pcsv2.map.bdimg.com/","http://pcsv1.map.bdimg.com/","http://pcsv0.map.bdimg.com/"],PANO_ROAD_LAYER:"http://pcsv0.map.bdimg.com/",PANO_3DIMAGE_URL:"http://pcsv0.map.bdimg.com/",PANO_PHPUI_URL:"http://sv0.map.baidu.com/",PANO_ROUTE_VIDEO_URL:"http://pcsv2.map.bdimg.com/",PANO_AERIAL_VIDEO_SERVER_URL:"http://pcsv0.map.bdimg.com/video/",PANO_VIDEO_SERVER_URL:"http://atv.map.baidu.com/",PANO_HOME_URL:"http://quanjing.baidu.com/",MapComplaintCenterURL:"http://tousu.baidu.com/map/",WP_URL:"http://weipai.baidu.com/",DETAIL_PAGE_URL:window.location.host,WP_URL:"http://weipai.baidu.com/",MAP_CENT_URL:"http://"+window.location.host,cdnHost:["http://webmap0.map.bdimg.com/","http://webmap1.map.bdimg.com/"]};i.exports={modelConfig:p,mapVersion:m,mapConfig:o,urlConfig:c}});
;define("common:widget/ui/constant/Constant.js",function(_,E,R){var T={GEO_TYPE_AREA:0,GEO_TYPE_LINE:1,GEO_TYPE_POINT:2,CITY_TYPE_NATION:0,CITY_TYPE_PROV:1,CITY_TYPE_CITY:2,CITY_TYPE_DIST:3,AREA_TYPE_NORM:0,AREA_TYPE_PROV:1,AREA_TYPE_DIST:2,AREA_TYPE_POI:3,DEST_START:0,DEST_END:1,DEST_MIDDLE:2,DEST_SEC:3,POI_TYPE_NORMAL:0,POI_TYPE_BUSSTOP:1,POI_TYPE_BUSLINE:2,POI_TYPE_SUBSTOP:3,POI_TYPE_SUBLINE:4,ROUTE_TYPE_DEFAULT:0,ROUTE_TYPE_BUS:1,ROUTE_TYPE_WALK:2,ROUTE_TYPE_DRIVE:3,ROUTE_TYPE_TEMP_BUS:4,ROUTE_TYPE_TEMP_WALK:5,ROUTE_TYPE_RAIL_DASHED:6,ROUTE_TYPE_BADWAY:7,SYNC_ACTION_ADD:0,SYNC_ACTION_UPDATE:1,SYNC_ACTION_DELETE:2,SYNC_DATA_TYPE_POI:0,SYNC_DATA_TYPE_ROUTE:1,OVERLAY_STYLE:{MKR_A:1,MKR_B:2,MKR_C:3,MKR_D:4,MKR_E:5,MKR_F:6,MKR_H:7,MKR_I:8,MKR_J:9,MKR_K:10,MKR:11,MKR_RCTR:12,DIS_DOT:13,BUS_STOP:14,BUS_TRANS:15,SUB_TRANS:16,DS_MKR:17,DE_MKR:18,DRV_M_MKR:19,DRV_E_MKR:20,MKR_NULL:21,GEN_MKR:22,VIW_LBL:30,DIS_LBL:31,DIS_T_LBL:32,DS_LBL:33,DE_LBL:34,DIR_MKR:40,ROUTE:60,BUS_ROUTE:61,WALK_ROUTE:62,DRV_ROUTE:63,DIS_LINE:64,AREA:65,H_LINE:66,HO_LINE:67,HW_LINE:68,ADDR_MKR_NUM:[70,71,72,73,74,75,76,77,78,79],ADDR_MKR_ACC:110,ADDR_MKR_EST:111,RAIL_DASHED_ROUTE:120},A_J_MARKER_IMG:"../../../../../webmap2.map.bdstatic.com/newmap/static/common/images/markers_new_653df87.png"/*tpa=http://webmap2.map.bdstatic.com/newmap/static/common/images/markers_new_653df87.png*/,A_J_MARKER_RED_SIZE:new BMap.Size(21,32),A_J_MARKER_RED_OFFSET:new BMap.Size(10,32),A_J_MARKER_BLUE_SIZE:new BMap.Size(24,36),A_J_MARKER_OFFSET:new BMap.Size(10,32),A_J_MARKER_BLUE_OFFSET:new BMap.Size(12,36),A_J_MARKER_INFOWND_OFFSET:new BMap.Size(13,1),A_J_MARKER_BLUE_ICON_Y:73,A_J_MARKER_ORANGE_ICON_Y:34,A_J_MARKER_BLUE_ICON_WID:24,A_J_MARKER_RED_ICON_WID:21,A_J_ADDR_OFFSET:new BMap.Size(8,20),DEST_MARKER_SIZE:new BMap.Size(42,34),DEST_MARKER_OFFSET:new BMap.Size(14,32),DEST_MARKER_INFOWND_OFFSET:new BMap.Size(14,0),MARKER_11_11_SIZE:new BMap.Size(11,11),MARKER_11_11_OFFSET:new BMap.Size(5,5),MARKER_11_11_INFOWND_OFFSET:new BMap.Size(5,0),CHILD_MARKER_IMG:"../../../../../webmap1.map.bdstatic.com/newmap/static/common/images/markers_child_ab91b1f.png"/*tpa=http://webmap1.map.bdstatic.com/newmap/static/common/images/markers_child_ab91b1f.png*/,CHILD_MARKER_WID:21,CHILD_MARKER_OFFSET:new BMap.Size(10,32),CHILD_MARKER_ORANGE_Y:0,CHILD_MARKER_GREEN_Y:32,CHILD_MARKER_ORANGE_SIZE:new BMap.Size(21,32),CHILD_MARKER_GREEN_SIZE:new BMap.Size(21,32),CHILD_MARKER_INFOWND_OFFSET:new BMap.Size(13,1),PCHILD_MARKER_IMG:"../../../../../webmap1.map.bdstatic.com/newmap/static/common/images/marker_pchild_73cc40c.png"/*tpa=http://webmap1.map.bdstatic.com/newmap/static/common/images/marker_pchild_73cc40c.png*/,PCHILD_MARKER_OFFSET:new BMap.Size(0,0),PCHILD_MARKER_HOVER:90,PCHILD_MARKER_HEIGHT:28,PCHILD_MARKER_WIDTH_1:28,PCHILD_MARKER_WIDTH_2:40,PCHILD_MARKER_WIDTH_3:52,PCHILD_MARKER_WIDTH_4:65,PCHILD_MARKER_WIDTH_5:77,PCHILD_MARKER_WIDTH_6:89,TRANS_TYPE_BUS:0,TRANS_TYPE_SUB:1,TRANS_TYPE_RAIL:2,TRANS_TYPE_AIR:3,TRANS_TYPE_DRIVING:4,TRANS_TYPE_WALKING:5};R.exports=T});
;define("common:widget/ui/history/history.js",function(e,r,o){var t={nowTpl:null,tplOpts:{},record:function(e){var r="http://webmap0.map.bdstatic.com/newmap/static/common/history_d35a118.html",o=document.fmHistory,t=e.url?e.url:"name:"+e.name;t=escape(t),this.nowTpl=t,o.url.value=t,1!=e.history&&(T.g("wHistory").src=T.browser.ie>0||T.browser.chrome>0||T.browser.safari>0?r+"?url="+escape(t):r+"?url="+escape(t),e._mapInfo={center:map.getCenter(),level:map.getZoom()},this.tplOpts[t]=e)}};window.MapHistory=t,o.exports=t});
;define("common:widget/ui/indexUtil/IndexUtil.js",function(t,e,o){{var i=t("common:widget/ui/config/config.js"),n=t("common:widget/com/componentManager.js"),a=t("common:widget/ui/mapInfo/mapInfo.js"),r=(t("common:widget/ui/areaCfg/areaCfg.js"),t("common:widget/ui/sateCityList/SateCityList.js")),s=(t("common:widget/ui/stat/CodeStat.js"),i.modelConfig);i.mapConfig}o.exports={cnameSearch:function(t,e,o){o=o||0,e=e||s.cityCode,n.go("con&contp=0&wd="+encodeURIComponent(t)+"&pn=0&c="+e+"&src="+o)},selectCity:function(e,o){if(window.temp.cityPop)return void window.temp.cityPop.close();var i={title:"城市列表",content:"",height:402,width:395,open:function(){this.styleSwitch&&T.ac(e,"curcity-expand-selected")},close:function(){this.styleSwitch&&T.rc(e,"curcity-expand-selected"),window.temp.cityPop=null}};for(var n in o)i[n]=o[n];t.async(["common:widget/ui/Popup/Popup.js","common:widget/ui/Storage/Storage.js","common:widget/com/SelectCity/SelectCity.js"],function(t,n,r){var s=window.temp.cityPop=new t(i);s.addConnectDom(e),s.render(),s.hide(),i&&"undefined"!=typeof i.right?s.getDom().style.right=i.right+"px":s.getDom().style.left=i&&"undefined"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/!=typeof i.left?i.left+"px":"close"==a.status?"12px":"362px",i&&"undefined"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/!=typeof i.top?s.getDom().style.top=i.top+"px":i&&"undefined"!=typeof i.bottom?s.getDom().style.top=i.bottom+"px":map.fullScreenMode?(s.getDom().style.top="28px",s.getDom().style.left="12px"):s.getDom().style.top="139px",o.baiduStorage=n,o.exitLargeMapMode=!1;var c=new r({dom:s.content,cinfo:o,pop:s});c.show()}),window.place&&place.resetArea&&place.resetArea(),addStat("indexcityex.cityexchange.cityexchangeentrance")},setCurCity:function(e,o,i,n){if(!window.isPrint&&e&&o){n=n||{},e="中国"==e?"全国":e,T.g("supBus").innerHTML="",T.g("curCity").innerHTML=e,window.GRControll&&GRControll.isGRequest&&s.cityCode!=o&&window.GRControll.addGRMap(),s.cityCode!=o&&(this.isSupportStreetView(o)&&addStat(STAT_CODE.STAT_PANORAMA,{catalog:"pano-city-visit",from:o}),addStat(STAT_CODE.STAT_PANORAMA,{catalog:"city-visit",from:o})),s.cityCode=o,s.cityName=e,s.cityType=i||"",s.sup=n.sup,map.currentCity="",map.cityCode="",this.setMapCtrlWhenMoving(o);var a=t("common:widget/ui/Traffic/Traffic.js");a.setBtnStatus(),this.setStreetViewTool(),this.setDataCopyRight()}},setWeipaiViewTool:function(){},initWeipaiViewTool:function(){},setStreetViewTool:function(){function e(e){o.streetViewTool?(o.streetViewTool.show(),o.streetViewTool.setPostion(),e&&!o.streetViewTool.isOpen&&(o.streetViewTool.resetStatus(),o.streetViewTool.setStatus())):t.async("common:widget/ui/StreetViewTool/StreetViewTool.js",function(t){o.streetViewTool=new t({map:map}),map.addControl(o.streetViewTool),o.streetViewTool.show(),o.streetViewTool.setPostion(),e&&!o.streetViewTool.isOpen&&(o.streetViewTool.resetStatus(),o.streetViewTool.setStatus())})}var o=window;this.isSupportStreetView2()?e(!1):o.streetViewTool&&o.streetViewTool.hide()},setDataCopyRight:function(){t.async("common:widget/ui/dataCopyRight/dataCopyRight.js",function(t){t.setCopyRight()})},setSupBus:function(t){s.supBus=t,window.isPrint||(T.g("blSearchLinkSpan")&&(T.g("blSearchLinkSpan").style.display=1==s.supBus?"inline-block":"none"),T.g("blSearchLink")&&(T.g("blSearchLink").style.display=1==s.supBus?"inline-block":"none"))},setMapCtrlWhenMoving:function(t){s.enableMapMove&&map.mapType==BMAP_SATELLITE_MAP||r.isSateMapSupportCity(t)?window.maptypeCtrl.hide3DControl():window.maptypeCtrl.hide()},isSupportStreetView:function(t){var e=window.G_POC||[];t=t||s.cityCode;for(var o=0;o<e.length;o++)if(t==e[o])return!0;return!1},isSupportStreetView2:function(){var t=window.G_POC||[],e=s.cityCode;if(e>=9e3&&9378>=e)return!1;for(var o=0;o<t.length;o++)if(e==t[o]||-9999==t[o])return!0;return!1},getBusExpTime:function(){var t=new Date,e=T.date.format(t,"yyyy-MM-dd"),o=t.getHours(),i=t.getMinutes(),a=i>=10?i:"0"+i,r=o+":"+a,s="",c=n.get("BusTrans"),u=window.currentComponent._className;return c&&"BusTrans"==u&&(e=c.startQDate?c.startQDate:e,r=c.startQTime?c.startQTime:r),s=e+" "+r},switchUrl:function(t,e){var o="",i=window.encodeURIComponent,n=T.trim,a=document.fmwd.word,r=document.fmbus.word_from,s=document.fmbus.word_to,c=document.fmwd.style.display,u=document.fmbus.style.display,p=document.fmnav.style.display,d=document.fmnav.word_from,l=document.fmnav.word_to;"block"==c||""==c?""!=n(a.value)&&(o=i(a.value)):"block"==u||""==u?""!=n(r.value)&&""!=n(s.value)?o=i("从"+n(r.value)+"到"+n(s.value)):""==n(r.value)&&""!=n(s.value)?o=i(n(s.value)):""!=n(r.value)&&""==n(s.value)&&(o=i(n(r.value))):("block"==p||""==p)&&(""!=n(d.value)&&""!=n(l.value)?o=i("从"+n(d.value)+"到"+n(l.value)):""==n(d.value)&&""!=n(l.value)?o=i(n(l.value)):""!=n(d.value)&&""==n(l.value)&&(o=i(n(d.value))));{var m=["http://news.baidu.com/ns?word=#####&tn=news&from=news&ie=utf-8&bs=mp3&sr=0&cl=2&rn=20&ct=1&prevct=no&sc=map","http://www.baidu.com/s?wd=#####&ie=utf-8&fr=map1000","http://tieba.baidu.com/f?kw=#####&ie=utf-8&fr=map_tab","http://zhidao.baidu.com/q?word=#####&ct=17&pn=0&tn=ikaslist&rn=10&lm=0&fr=map0000","http://music.baidu.com/search?key=#####&ie=utf-8&fr=map","http://image.baidu.com/i?tn=baiduimage&ct=201326592&cl=2&lm=-1&word=#####&z=0&ie=utf-8&fr=map0000","http://v.baidu.com/v?ct=301989888&s=25&word=#####&ie=utf-8&fr=map0000","http://baike.baidu.com/search/word?&word=#####&pic=1&sug=1&enc=utf8&fr=map0000","http://wenku.baidu.com/search?word=#####&ie=utf-8&fr=map0000"];t.href}if(""!=o)if(""!=m[1*e]&&-1!=m[1*e].indexOf("#####"))t.href=m[1*e].replace(/#####/gi,o);else{var w="?";t.href=t.href+w+"ie=utf-8&q="+o}}}});
;define("common:widget/ui/mapUtil/mapUtil.js",function(e,t,o){function a(e){for(var t=n(e.charAt(0)),o=e.substr(1),a=0,s=o.length,p=[],d=[],_=[];s>a;)if(o.charAt(a)==f[0]){if(13>s-a)return 0;if(_=i(o.substr(a,13),p),0>_)return 0;a+=13}else if(";"==o.charAt(a))d.push(p.slice(0)),p.length=0,++a;else{if(8>s-a)return 0;if(_=r(o.substr(a,8),p),0>_)return 0;a+=8}for(var l=0,c=d.length;c>l;l++)for(var u=0,E=d[l].length;E>u;u++)d[l][u]/=100;return{geoType:t,geo:d}}function n(e){var t=-1;return e==f[1]?t=d.GEO_TYPE_POINT:e==f[2]?t=d.GEO_TYPE_LINE:e==f[3]&&(t=d.GEO_TYPE_AREA),t}function i(e,t){for(var o=0,a=0,n=0,i=0;6>i;i++){if(n=s(e.substr(1+i,1)),0>n)return-1-i;if(o+=n<<6*i,n=s(e.substr(7+i,1)),0>n)return-7-i;a+=n<<6*i}return t.push(o),t.push(a),0}function r(e,t){var o=t.length;if(2>o)return-1;for(var a=0,n=0,i=0,r=0;4>r;r++){if(i=s(e.substr(r,1)),0>i)return-1-r;if(a+=i<<6*r,i=s(e.substr(4+r,1)),0>i)return-5-r;n+=i<<6*r}return a>l&&(a=l-a),n>l&&(n=l-n),t.push(t[o-2]+a),t.push(t[o-1]+n),0}function s(e){var t=e.charCodeAt(0);return e>="A"&&"Z">=e?t-"A".charCodeAt(0):e>="a"&&"z">=e?26+t-"a".charCodeAt(0):e>="0"&&"9">=e?52+t-"0".charCodeAt(0):"+"==e?62:"/"==e?63:-1}{var p=e("common:widget/ui/util/util.js"),d=e("common:widget/ui/constant/Constant.js"),_=e("common:widget/ui/config/config.js");_.mapConfig}BMap.Overlay.getZIndex=function(e,t,o){return(e=1*e)?(t&&t==BMAP_COORD_MERCATOR&&(e=BMap.Project.convertMC2LL(new BMap.Point(0,e)).lat),(-1e5*e<<5)+(o||0)):0};var f=["=",".","-","*"],l=1<<23,c={decode_geo_diff:a};o.exports={addArrow:function(e,t){for(var o=0;o<e.length;o++){var a=e[o].split(",");e[o]=new BMap.Point(a[0],a[1])}for(var n=-1e3,i=[],r=t.getBounds(),o=1;o<e.length-1;o++)if(!(e[o].lng<r.minX||e[o].lng>r.maxX||e[o].lat<r.minY||e[o].lat>r.maxY)){var s=t.pointToPixel(e[o]),p=t.pointToPixel(e[o+1]),d=(s.x-p.x)*(s.x-p.x)+(s.y-p.y)*(s.y-p.y);if(!(400>d)){var _=Math.atan2(e[o].lat-e[o+1].lat,e[o+1].lng-e[o].lng),f=Math.floor(8*_/Math.PI+16.5)%16*-16;if(f!=n){var l=new BMap.Icon("../images/dest_markers_14848ce.png"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/dest_markers_14848ce.png*/,new BMap.Size(16,16),{imageOffset:new BMap.Size(f,-120),infoWindowOffset:new BMap.Size(9,0)}),c=new BMap.Marker(e[o],{icon:l});t.addOverlay(c),i.push(c),n=f}}}return i},addSearchPoi:function(e,t,o,a){var n=p.getPoiPoint(e),i=o.substring(0,6);if(a=a||{},a.type=a.type||"normal",a.garnd=a.grand||!1,a.isgrandtype=a.isgrandtype,!(!n||"undefined"==typeof t||0>t||t>9&&"child"!==a.type||t>39&&"child"===a.type)){var r,s=d.A_J_MARKER_IMG;"RouteAddrMarker"==a.type&&(s=d.A_J_MARKER_IMG);var _;if("child"==a.type){s=d.CHILD_MARKER_IMG;var f=new BMap.Icon(s,d.CHILD_MARKER_ORANGE_SIZE,{imageOffset:new BMap.Size(-d.CHILD_MARKER_WID*t,-d.CHILD_MARKER_ORANGE_Y),offset:d.CHILD_MARKER_OFFSET,infoWindowOffset:d.CHILD_MARKER_INFOWND_OFFSET});r=t+1}else if("pchild"==a.type){var l=i.replace(/[\u0100-\uffff]/g,"##").length/2,_=Math.ceil(l);s=d.PCHILD_MARKER_IMG;var f=new BMap.Icon(s,new BMap.Size(d["PCHILD_MARKER_WIDTH_"+_],28),{imageOffset:new BMap.Size(0,-d.PCHILD_MARKER_HEIGHT*(6-_)),offset:new BMap.Size(d["PCHILD_MARKER_WIDTH_"+_]/2,d.PCHILD_MARKER_HEIGHT),infoWindowOffset:new BMap.Size(d["PCHILD_MARKER_WIDTH_"+_]/2,1)});r=t+1}else{var c=0;("RouteAddrMarker"==a.type||"groupon"==a.type)&&(c=-d.A_J_MARKER_ORANGE_ICON_Y);var u=new BMap.Size(-d.A_J_MARKER_RED_ICON_WID*t,c),f=new BMap.Icon(s,d.A_J_MARKER_RED_SIZE,{offset:d.A_J_MARKER_RED_OFFSET,imageOffset:u,infoWindowOffset:d.A_J_MARKER_INFOWND_OFFSET});r=t+1}var E=100;"child"===a.type&&(E=1e3);var m=new BMap.Marker(n,{icon:f,zIndexFixed:!0,baseZIndex:25e5-E*t});if("busline"===a.markerType?m.addEventListener("click",function(){addStat("basemap.basemap.buslinemarker")}):"subline"===a.markerType&&m.addEventListener("click",function(){addStat("basemap.basemap.sublinemarker")}),m.customProperty={type:a.type},a.uid&&"undefined"!=typeof a.ext_type&&1&a.ext_type){var g="<span class='inr-tip' id='inr_tip_"+t+"' data-uid=\""+a.uid+'" data-wd="'+o+'" >室内地图</span>',R=this.createNormalTip(g,{point:n,offset:new BMap.Size(11,20)});R.setStyle({background:"url(http://webmap2.map.bdstatic.com/newmap/static/common/images/inr_bg_3fefafb.gif) 0 -29px no-repeat",height:"20px",border:"0"}),R.setTitle("查看室内地图"),R._indoor=!0,m.setLabel(R)}map.addOverlay(m),"pchild"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/==a.type?(m.isgrand=1,m.textlen=_,p.beforeEndHTML(m.siblingElement,'<div style="width:'+d["PCHILD_MARKER_WIDTH_"+_]+'px;z-index:10;font-weight:bold;position: absolute;color:#f21101;text-align:center;margin-top:3px;">'+i+"</div>")):(m.isgrand=0,m.textlen=2),m._stCode=r,o&&m.setTitle(o),m.isgchild=a.garnd,m.isgrandtype=a.isgrandtype||0;var M=this;return baidu("#tipBtn_"+t).on("mouseover",function(){var e=baidu(this).data("index");M.showInrTip(e)}),m}},addSearchInViewTitle:function(e,t,o){var a=this.createSearchInViewTitle(e,t);return a._stCode=d.OVERLAY_STYLE.VIW_LBL,o&&"Marker"==o.toString()?(o.setLabel(a),a):(map.addOverlay(a),a)},addDetailPoi:function(e,t){var o=p.getPoiPoint(e);if(o){var a=new BMap.Icon(d.A_J_MARKER_IMG,d.A_J_MARKER_RED_SIZE,{offset:d.A_J_MARKER_OFFSET,imageOffset:new BMap.Size(0,-116),infoWindowOffset:d.A_J_MARKER_INFOWND_OFFSET}),n=new BMap.Marker(o,{icon:a});return map.addOverlay(n),n._stCode=d.OVERLAY_STYLE.MKR,t&&n.setTitle(t),n}},addRoute:function(e,t,o,a){var n,i,r,s,p,_;if(1===t&&("yes"===map.showTerminal||"yes2"===map.showTerminal)){n=e.split(";");var f=new BMap.Icon("../images/start_2c8cf26.png"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/start_2c8cf26.png*/,new BMap.Size(30,33),{offset:new BMap.Size(14,32),imageOffset:new BMap.Size(0,0)}),l=new BMap.Icon("../../../../../webmap2.map.bdstatic.com/newmap/static/common/images/end_90f6ae1.png"/*tpa=http://webmap2.map.bdstatic.com/newmap/static/common/images/end_90f6ae1.png*/,new BMap.Size(30,33),{offset:new BMap.Size(14,32),imageOffset:new BMap.Size(0,0)});_=n.length-1,i=new BMap.Point(parseFloat(n[0].split(",")[0]),parseFloat(n[0].split(",")[1])),r=new BMap.Point(parseFloat(n[_].split(",")[0]),parseFloat(n[_].split(",")[1])),p=new BMap.Marker(i,{isTop:!0,icon:f}),s=new BMap.Marker(r,{isTop:!0,icon:l}),map.addOverlay(p),map.addOverlay(s),map.showTerminal="no"}var c=[{stroke:6,color:"#3a6bdb",opacity:.6,stCode:d.OVERLAY_STYLE.ROUTE},{stroke:6,color:"#3a6bdb",opacity:.6,stCode:d.OVERLAY_STYLE.BUS_ROUTE},{stroke:6,color:"#78bc5f",opacity:.6,stCode:d.OVERLAY_STYLE.WALK_ROUTE},{stroke:5,color:"#3a6bdb",opacity:.6,stCode:d.OVERLAY_STYLE.DRV_ROUTE},{stroke:6,color:"#3a6bdb",opacity:.6,stCode:d.OVERLAY_STYLE.BUS_ROUTE},{stroke:4,color:"#78bc5f",opacity:.6,stCode:d.OVERLAY_STYLE.WALK_ROUTE},{stroke:6,color:"#688DE1",opacity:.6,strokeStyle:"dashed",stCode:d.OVERLAY_STYLE.RAIL_DASHED_ROUTE},{stroke:6,color:"#575757",opacity:.6,strokeStyle:"dotted",stCode:d.OVERLAY_STYLE.WALK_ROUTE}];if("undefined"==typeof t&&(t=0),c[t]){var u=c[t],E={strokeWeight:u.stroke,strokeColor:u.color,strokeOpacity:u.opacity,strokeStyle:u.strokeStyle};if("string"==typeof e||"Point"==e[0].toString())var m=new BMap.Polyline(e,E);else if("[object Array]"==Object.prototype.toString.call(e))var m=new BMap.PolylineMultipart(e,E);var g=a||map;if(g.addOverlay(m),m._stCode=c[t].stCode,m._routeType=t,m._sMarker=p,m._eMarker=s,t==d.ROUTE_TYPE_BUS){var R=new BMap.Polyline(e,{strokeWeight:u.stroke-2,strokeColor:"#fff",strokeOpacity:.3});m._p=R,g.addOverlay(R)}return m}},createSearchInViewTitle:function(e,t){var o=p.getPoiPoint(e);if(o){var a=new BMap.Size(14,-21),n=t;t.replace(/[\u0100-\uffff]/g,"##").length>20&&(t=t.substring(0,10)+"...");var i=new BMap.Label(t,{point:o,offset:a});return i.setTitle(n),i.setStyle({lineHeight:"15px",padding:"1px 3px",borderColor:"#a7a7a7",color:"#666",cursor:"pointer"}),i}},createNormalTip:function(e,t){var o={display:!0,style:{background:"url(http://webmap0.map.bdstatic.com/newmap/static/common/images/tip_5ffa1fb.gif) 0 0 no-repeat",color:"#000",height:"30px",border:"0",padding:"0 0 0 4px"}};t&&"object"==typeof t&&(t=T.extend(o,t));var a=new BMap.Label(e,{point:t.point,offset:t.offset});return a},cutPoints:function(e,t){if(t?.25>t?t=0:t>.25&&1>t?t=1:t>32&&(t=32):t=0,e&&"string"==typeof e){var o=e;if(t>0){var a=new RegExp("(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);)(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);){"+t+"}","ig");o=e.replace(a,"$1")}return o}},selectRoute:function(e){if(e&&"Polyline"==e.toString()){var t=["#ff0103","#ff0103","#ff0103","#ff0103","","","#ff0103"];t[e._routeType]&&(e.setStrokeColor(t[e._routeType]),e._stCode=e._stCode==d.OVERLAY_STYLE.BUS_ROUTE?d.OVERLAY_STYLE.HO_LINE:e._stCode==d.OVERLAY_STYLE.WALK_ROUTE?d.OVERLAY_STYLE.HW_LINE:d.OVERLAY_STYLE.H_LINE)}},unSelectRoute:function(e){if(e&&"Polyline"==e.toString()){var t=["#3a6bdb","#3a6bdb","#30a208","#3a6bdb","","","#688DE1"],o=[d.OVERLAY_STYLE.ROUTE,d.OVERLAY_STYLE.BUS_ROUTE,d.OVERLAY_STYLE.WALK_ROUTE,d.OVERLAY_STYLE.DRV_ROUTE,,,d.OVERLAY_STYLE.RAIL_DASHED_ROUTE];t[e._routeType]&&(e.setStrokeColor(t[e._routeType]),e._stCode=o[e._routeType])}},removeRoute:function(e){e._p&&"Polyline"==e._p.toString()&&(e._p.remove(),e._p=null),e.remove(),e=null},addArea:function(e,t){if(e){var o=[{strokeColor:"#0064fc",strokeWeight:2,fillColor:!1,strokeOpacity:.8,strokeStyle:"dashed",stCode:d.OVERLAY_STYLE.AREA},{strokeColor:"#0064fc",strokeWeight:2,fillColor:!1,strokeOpacity:.8,strokeStyle:"dashed",stCode:d.OVERLAY_STYLE.AREA},{strokeColor:"#0064fc",strokeWeight:2,fillColor:!1,strokeOpacity:.8,strokeStyle:"dashed",stCode:d.OVERLAY_STYLE.AREA},{strokeColor:"#6791e5",strokeWeight:2,strokeOpacity:.9,strokeStyle:"solid",fillColor:"#4673cc",fillOpacity:.2,stCode:d.OVERLAY_STYLE.AREA}],a=t||0;if(o[a]){var n=new BMap.Polygon(e,o[a]);return map.addOverlay(n),!o[a].strokeColor&&n.setFillColor(!1),n._stCode=o[a].stCode,n}}},removeArea:function(e){"Polygon"==e.toString()&&(e.remove(),e=null)},addTransPoi:function(e,t,o,a){var n=p.getPoiPoint(e);if(n){var i=d.OVERLAY_STYLE.BUS_TRANS,r=-55;switch(t){case d.TRANS_TYPE_BUS:r=-55;break;case d.TRANS_TYPE_SUB:i=d.OVERLAY_STYLE.SUB_TRANS,r=-76;break;case d.TRANS_TYPE_RAIL:r=-118;break;case d.TRANS_TYPE_AIR:r=-139;break;case d.TRANS_TYPE_DRIVING:r=-97;break;case d.TRANS_TYPE_WALKING:r=-160}var s=new BMap.Icon("../../../../../webmap1.map.bdstatic.com/newmap/static/common/images/trans_icons_45ed3d3.png"/*tpa=http://webmap1.map.bdstatic.com/newmap/static/common/images/trans_icons_45ed3d3.png*/,new BMap.Size(21,21),{imageOffset:new BMap.Size(0,r),infoWindowOffset:new BMap.Size(10,0)}),_=new BMap.Marker(n,{icon:s}),f=a||map;return _._stCode=i,o&&_.setTitle(o),f.addOverlay(_),_}},addBusStopPoi:function(e,t){var o=p.getPoiPoint(e);if(o){var a=new BMap.Icon("../images/stop_icon_b14a324.png"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/stop_icon_b14a324.png*/,d.MARKER_11_11_SIZE,{offset:d.MARKER_11_11_OFFSET,infoWindowOffset:d.MARKER_11_11_INFOWND_OFFSET}),n=new BMap.Marker(o,{icon:a,baseZIndex:15e5});return map.addOverlay(n),n._stCode=d.OVERLAY_STYLE.BUS_STOP,t&&n.setTitle(t),n}},addDestPoi:function(e,t,o,a,n){n=n||map;var i=p.getPoiPoint(e);if(i){if(o==d.DEST_MIDDLE){var r=new BMap.Icon("../../../../../webmap2.map.bdstatic.com/newmap/static/common/images/drv_m_234b1a3.png"/*tpa=http://webmap2.map.bdstatic.com/newmap/static/common/images/drv_m_234b1a3.png*/,d.MARKER_11_11_SIZE,{offset:d.MARKER_11_11_OFFSET,infoWindowOffset:d.MARKER_11_11_INFOWND_OFFSET}),s=new BMap.Marker(i,{icon:r});return n.addOverlay(s),s.enableDragging(!0),s._stCode=d.OVERLAY_STYLE.DRV_M_MKR,s}if(o==d.DEST_SEC){var r=new BMap.Icon("../../../../../webmap2.map.bdstatic.com/newmap/static/common/images/drv_m_234b1a3.png"/*tpa=http://webmap2.map.bdstatic.com/newmap/static/common/images/drv_m_234b1a3.png*/,d.MARKER_11_11_SIZE,{offset:d.MARKER_11_11_OFFSET,imageOffset:new BMap.Size(0,-11),infoWindowOffset:d.MARKER_11_11_INFOWND_OFFSET}),s=new BMap.Marker(i,{icon:r});return n.addOverlay(s),s._stCode=d.OVERLAY_STYLE.DRV_E_MKR,s}if(!a){var r=new BMap.Icon("../images/dest_markers_14848ce.png"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/dest_markers_14848ce.png*/,d.DEST_MARKER_SIZE,{offset:d.DEST_MARKER_OFFSET,imageOffset:new BMap.Size(0,-34*o),infoWindowOffset:d.DEST_MARKER_INFOWND_OFFSET}),s=new BMap.Marker(i,{icon:r,baseZIndex:35e5});return t&&s.setTitle(t),s._stCode=d.OVERLAY_STYLE.DS_MKR+o,n.addOverlay(s),s}var _=t;_.length>10&&(_=_.substring(0,10)+"...");var f=new BMap.Label(t,{point:i});return f.setStyles({cursor:"pointer"}),f.setOffset(new BMap.Size(-12,-28)),f._stCode=d.OVERLAY_STYLE.DS_LBL+o,f.addEventListener("domready",function(){var e=f.getDom();e.style.border="none",e.style.background="transparent",e.style.overflow="visible",e.style.zIndex=25e5+2*map.pointToPixel(i).y,e.style.cursor="url("+map.config.defaultCursor+"), default",T.browser.ie||(T.on(e,"mousedown",function(){e.style.cursor="url("+map.config.draggingCursor+"), default"}),T.on(e,"mouseup",function(){e.style.cursor="url("+map.config.defaultCursor+"), default"})),f.zIndex=e.style.zIndex;var t="";t=6==T.browser.ie?'<div class="dest_icon_left_ie6 dest'+o+'"><div></div></div><div class="dest_icon_right_ie6"><div></div><span class="dest_text_ie6">'+_+"</span></div>":'<div class="dest_icon dest'+o+'"><div class="dest_icon_right"><span class="dest_text">'+_+"</span></div></div>",e.innerHTML=t}),n.addOverlay(f),f}},createDrvMidLabel:function(e,t){var o=new BMap.Label(e,{point:t,offset:new BMap.Size(15,-5)});return o.setStyles({border:"1px solid #999",color:"#666",padding:"2px",background:"#fff"}),o},addDrvDirIcon:function(e,t,o){o=o||map;var a=p.getPoiPoint(e);if(a){(0>t||t>12)&&(t=0);var n=-18*t,i=new BMap.Icon("../images/dest_markers_14848ce.png"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/dest_markers_14848ce.png*/,new BMap.Size(18,18),{imageOffset:new BMap.Size(n,-100),infoWindowOffset:new BMap.Size(9,0)}),r=new BMap.Marker(a,{icon:i});return o.addOverlay(r),r._stCode=d.OVERLAY_STYLE.DIR_MKR+t,r}},addDrRoute:function(e,t,o,a){var n=this,i=a||map;window.dropRoutes||(window.dropRoutes=[]);var r=[];t.onRemoveTips();var s=t.routePoints;if(t.mapZoomLevel=i.zoomLevel,t.driveBounds.length>0){var _=p.getBPoints(t.driveBounds);if(0==t.drag&&!e||o)if(i.mapType==BMAP_TYPE_DIMENSIONAL){var f=BMap.MapType[BMAP_TYPE_DIMENSIONAL].citys,l=f[i.currentCity][1],c=p.getPointsBounds(_),u=n.getBitLevel(c);l.intersects(c)?(15>=u&&(u=15),t.dragPois&&i.centerAndZoom(t.dragPois[0].getPoint(),u)):(i.setMapType(BMAP_NORMAL_MAP),this.setViewport(_,40))}else this.setViewport(_,40);t.drag=0}for(var E=Math.pow(2,BMap.MapType[i.mapType].zoomLevelMax-i.zoomLevel),m=i.pixelToPoint({x:3*-i.width,y:3*i.height}),g=i.pixelToPoint({x:3*i.width,y:3*-i.height}),R=(new BMap.Bounds(m.lng,m.lat,g.lng,g.lat),0);R<s.length;R++){for(var M=s[R],v=[],T=0;T<M.length;T++)if(i.mapType===BMAP_TYPE_DIMENSIONAL)for(var w=M[T].p,S=this.cutPoints(w,E),y=S.split(";"),A=0;A<y.length;A++){var O=y[A].split(","),L=new BMap.Point(O[0],O[1]);v.push(L)}else for(var w=M[T].p,S=this.cutPoints(w,0),y=S.split(";"),A=0;A<y.length;A++){var O=y[A].split(","),L=new BMap.Point(O[0],O[1]);v.push(L)}if(!t.draging&&0==t.sended){var n=t;if(0==e){var h=this.addRoute(v,d.ROUTE_TYPE_DRIVE,void 0,i);r.push(h),h.index=R,h.addEventListener("mouseover",function(e){n.onRouteOver(e)}),h.addEventListener("mousemove",function(e){n.onRouteMove(e)}),h.addEventListener("mouseout",function(e){n.onRouteOut(e)}),window.dropRoutes.push(h)}else{var b=window.dropRoutes[R];b&&b.setPoints(v)}}}return r},createTip:function(e,t,o,a){if(e||"string"==typeof e){var n={display:!0,offset:new BMap.Size(3,-34),style:{background:"url(http://webmap0.map.bdstatic.com/newmap/static/common/images/tip_5ffa1fb.gif) 0 0 no-repeat",color:"#000",height:"30px",border:"0",padding:"0 0 0 4px"}},i=a||map;n.point=i.getCenter(),o&&"object"==typeof o&&(o=T.extend(n,o)),e="<span class="+t+">"+e+"</span>";var r=new BMap.Label(e,{point:o.point,offset:o.offset}),s=new BMap.Marker(o.point,{icon:new BMap.Icon("../images/transparent.gif"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/transparent.gif*/,new BMap.Size(1,1))});return r.setStyle(o.style),s.setLabel(r),0==o.display&&r.hide(),i.addOverlay(s),r.addEventListener("mouseover",function(){s.setTop(!0,35e5-BMap.Overlay.getZIndex(o.point.lat,BMAP_COORD_MERCATOR))}),r.addEventListener("mouseout",function(){s.setTop(!1)}),s}},getBitLevel:function(e){for(var t=BMap.MapType[map.mapType],o=t.zoomLevelMax,a=1,n=o;n>=a;n--){var i=Math.pow(2,t.zoomLevelMax-n)*t.baseUnits/t.tileSize;if((e.getMaxX()-e.getMinX())/i<map.width-60&&(e.getMaxY()-e.getMinY())/i<map.height-60)break}return n},setViewport:function(e,t){if(0!=e.length){var o=null;t&&(o={margins:[t,t,t,t]});var a=map.getViewport(e,o);map.setViewport(a)}},_getPicType:function(){var e=map.getMapType(),t=[];return e==BMAP_SATELLITE_MAP?(t.push(7),map._isHybirdShow&&t.push(1)):t.push(0),window.GRControll&&window.GRControll.getDataForSnap()&&t.push(6),t.join(",")},parse2Geo:function(e,t){t?.25>t?t=0:t>.25&&1>t?t=1:t>32&&(t=32):t=0;var o=e.split("|");if(1==o.length){var a=c.decode_geo_diff(o[0]);return{type:a.type,bound:"",points:a.geo.join(",")}}if(o.length>1){for(var n=e.split(";.="),i=[],r=[],s=0,p=n.length,d=0;p>d;d++){var _=n[d];p>1&&(0==d&&(_+=";"),d>0&&p-1>d&&(_=".="+_+";"),d==p-1&&(_=".="+_));var f=_.split("|"),l=c.decode_geo_diff(f[0]),u=c.decode_geo_diff(f[1]);i.push(l.geo.join(",")),i.push(u.geo.join(","));var a=c.decode_geo_diff(f[2]);s=a.type;var E=a.geo.join(",");if(E=E.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;"),t>0){var m=new RegExp("(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);)(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);){"+t+"}","ig");E=E.replace(m,"$1")}r.push(E)}return 1>=p&&(r=r.join(";")),{type:s,bound:i.join(";"),points:r}}},getGEORevertAddress:function(e,t){var o="http://api.map.baidu.com/?qt=rgc&x="+e.lng+"&y="+e.lat+"&dis_poi=100&poi_num=10&ie=utf-8&oue=1&res=webmap";baidu.jsonp(o,function(e){"function"==typeof t&&e&&e.content&&t(e)})},add3DTip:function(){},remove3DTip:function(){},showInrTip:function(e){T.g("inrTipNew_"+e).style.display="block",T.g("tipBtn_"+e).style.display="none",setTimeout(function(){T.g("inrTipNew_"+e)&&(T.g("inrTipNew_"+e).style.display="none"),T.g("tipBtn_"+e)&&(T.g("tipBtn_"+e).style.display="block")},3e3)}}});
;define("common:widget/ui/searchData/searchData.js",function(e,n,r){function o(e){var n="",r=map.getBounds(),o="&l="+map.zoomLevel,i=location.pathname,a=window.isPrint?i.replace("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/print.html",""):i;if((-1!=e.indexOf("nav&")||-1!=e.indexOf("nse&"))&&(e+="&extinfo=63"),0!=e.indexOf("bd&")&&window.searchInViewCtrl&&(window.searchInViewCtrl.exit(),window.searchInViewCtrl.curKw=""),document.location.href.indexOf("format=1")>-1&&(n="&format=1"),e.indexOf("&l=")>-1&&(o=""),(0===e.indexOf("s&")||0===e.indexOf("con&")||0===e.indexOf("nb&")||0===e.indexOf("bd&"))&&(-1===e.indexOf("&pn=")&&(e+="&pn=0"),-1===e.indexOf("&auth=")&&(e=e+"&auth="+window.AUTH)),e=e.replace(/%3C/gi,encodeURIComponent(" ")).replace(/%3E/gi,encodeURIComponent(" "))+"&tn="+map.mapType,e.indexOf("&nn=")<0&&(e+="&nn=0"),e.indexOf("b=(")>-1)e=a+t.DATA_URL+e+n+mapDebug.getParam(e)+"&ie=utf-8"+o+"&t="+(new Date).getTime();else{var d=Math.min(r.minX,r.maxX),l=Math.max(r.minX,r.maxX),s=Math.min(r.minY,r.maxY),u=Math.max(r.minY,r.maxY);e=a+t.DATA_URL+e+n+mapDebug.getParam(e)+"&ie=utf-8"+o+"&b=("+d+","+s+";"+l+","+u+")&t="+(new Date).getTime()}return e}var i=e("common:widget/ui/config/config.js"),t=i.modelConfig,a={fetch:function(e,n,r){var i=e.substring(0,e.indexOf("&"));e=o(e),T.ajax(e,{dataType:"json",success:function(o,t){var a=t.getResponseHeader("HTTP_X_BD_LOGID");a&&window.mapDebug&&window.mapDebug.onDebugResp&&window.mapDebug.onDebugResp(a,t);var a=t.getResponseHeader("HTTP_X_BD_LOGID");return o&&o.result?(1===o.result.current_null&&!o.place_info||t.slow?(1!==o.result.current_null||o.place_info||"bse"===i||ErrorMonitor("qt_"+i,"res_null",a+"$$no content$$"+e,void 0,{xhr:t,url:e,type:"fail"}),t.slow&&ErrorMonitor("qt_"+i,"req_slow"+t.slow,a,void 0,{xhr:t,url:e,type:"slow"})):ErrorMonitor("qt_"+i,"succ","",void 0,{xhr:t,url:e,type:"succ"}),void(n&&n(o))):(ErrorMonitor("qt_"+i,"res_null",a+"$$no res$$"+e,void 0,{xhr:t,url:e,type:"fail"}),void(r&&r()))},error:function(n){ErrorMonitor("qt_"+i,"req_fail",n.status,void 0,{xhr:n,url:e,type:"fail"}),r&&r()}}),ErrorMonitor("qt_"+i,"BASE","")},setUrl:o};r.exports=a});
;define("common:widget/ui/searchBox/searchBox.js",function(e,n,t){function o(){var e=w,n=function(e){e.keyCode<49&&!t["_"+e.keyCode]||(this._wd2=null)},t={_8:1,_32:1,_46:1};T.on(T.g("PoiSearch"),"keydown",n),T.on(T.g("BusSearchSta"),"keydown",n),T.on(T.g("BusSearchEnd"),"keydown",n),T.on(T.g("DriveSearchSta"),"keydown",n),T.on(T.g("DriveSearchEnd"),"keydown",n);var o=function(){var e=T.getAttr(this,"_from"),n="input_"+e,t="input_"+e+"_focus",o=this.value;window.temp.headSearchBoxFocus=this,baidu(this).removeClass(n),0==o.length?baidu(this).addClass(t):(baidu(this).removeClass(n),baidu(this).removeClass(t))},r=function(){var e=T.getAttr(this,"_from"),n="input_"+e,t="input_"+e+"_focus",o=this.value;delete window.temp.headSearchBoxFocus,T.rc(this,t),0==o.length?T.ac(this,n):(T.rc(this,n),T.rc(this,t))},i=function(e){if(window.temp.headSearchBoxFocus){var n=window.temp.headSearchBoxFocus,t=T.getAttr(n,"_from"),o="input_"+t,a="input_"+t+"_focus",r=n.value;n&&"value"==e.propertyName&&(T.rc(n,o),0==r.length?T.ac(n,a):(T.rc(n,o),T.rc(n,a)))}},c=function(){var e=T.getAttr(this,"_from"),n=this.value,t="input_"+e,o="input_"+e+"_focus";T.rc(this,t),0==n.length?T.ac(this,o):(T.rc(this,t),T.rc(this,o))};T.on(T.g("BusSearchSta"),"focus",o),T.on(T.g("BusSearchEnd"),"focus",o),T.on(T.g("DriveSearchSta"),"focus",o),T.on(T.g("DriveSearchEnd"),"focus",o),T.on(T.g("BusSearchSta"),"blur",r),T.on(T.g("BusSearchEnd"),"blur",r),T.on(T.g("DriveSearchSta"),"blur",r),T.on(T.g("DriveSearchEnd"),"blur",r),T.on(T.g("BusSearchSta"),"keyup",o),T.on(T.g("BusSearchEnd"),"keyup",o),T.on(T.g("DriveSearchSta"),"keyup",o),T.on(T.g("DriveSearchEnd"),"keyup",o),T.browser.ie&&document.attachEvent?(T.g("BusSearchSta").attachEvent("onpropertychange",i),T.g("BusSearchEnd").attachEvent("onpropertychange",i),T.g("DriveSearchSta").attachEvent("onpropertychange",i),T.g("DriveSearchEnd").attachEvent("onpropertychange",i)):(T.on(T.g("BusSearchSta"),"input",c),T.on(T.g("BusSearchEnd"),"input",c),T.on(T.g("DriveSearchSta"),"input",c),T.on(T.g("DriveSearchEnd"),"input",c)),T.on(T.g("busReturnIcon"),"mouseover",function(){var e=window.currentComponent._className;this.title="BusTrans"==e||"CBusTrans"==e||"NavTrans"==e?"查看返程":"切换起终点",T.ac(this,"return_icon_on")}),T.on(T.g("busReturnIcon"),"mouseout",function(){T.rc(this,"return_icon_on")}),(T.browser.chrome||T.browser.safari)&&T.on(T.g("busReturnIcon"),"mousedown",function(e){baidu.event.preventDefault(e)}),T.on(T.g("busReturnIcon"),"click",function(){s(),addStat("indexheader.searchbox.exchangeterminals",null,{da_src_bk:"bus"});{var n=document.fmbus,t=n.word_from.value,o=n.word_to.value,a=window.currentComponent._className;n.word_to._fromPoiSearch}e.notShowSuggest.run();var r=f.get("BusTrans"),i=f.get("CBusTrans"),c=f.get("NavWalk");if(r&&"BusTrans"==a&&T.g("BusSearchSta").value==r.start.wd&&T.g("BusSearchEnd").value==r.end.wd||i&&"CBusTrans"==a&&!i.noResult&&T.g("BusSearchSta").value==i.start.wd&&T.g("BusSearchEnd").value==i.end.wd||c&&"NavWalk"==a&&T.g("BusSearchSta").value==c.start.wd&&T.g("BusSearchEnd").value==c.end.wd)"BusTrans"==a?r.returnBus():"CBusTrans"==a?i._back():c.returnDr();else{var u=T.g("BusSearchSta")._wd2?T.trim(T.g("BusSearchSta")._wd2):"",d=T.g("BusSearchEnd")._wd2?T.trim(T.g("BusSearchEnd")._wd2):"";e.setValue("BusSearchSta",o),T.g("BusSearchSta")._wd2=d,e.setValue("BusSearchEnd",t),T.g("BusSearchEnd")._wd2=u,("BusTrans"==a||"CBusTrans"==a||"SelAddr"==a||"BusAddr"==a||"RouteAddr"==a)&&e.qSearch(document.fmbus,"bt")}""==T.g("BusSearchSta").value?T.g("BusSearchSta").focus():""==T.g("BusSearchEnd").value&&T.g("BusSearchEnd").focus()}),T.on(T.g("navReturnIcon"),"mouseover",function(){var e=window.currentComponent._className;this.title="BusTrans"==e||"CBusTrans"==e||"NavTrans"==e?"查看返程":"切换起终点",T.ac(this,"return_icon_on")}),T.on(T.g("navReturnIcon"),"mouseout",function(){T.rc(this,"return_icon_on")}),(T.browser.chrome||T.browser.safari)&&T.on(T.g("navReturnIcon"),"mousedown",function(e){S.preventDefault(e)}),T.on(T.g("navReturnIcon"),"click",function(){s(),addStat("indexheader.searchbox.exchangeterminals",null,{da_src_bk:"nav"});{var n=document.fmnav,t=n.word_from.value,o=n.word_to.value,a=window.currentComponent._className;n.word_to._fromPoiSearch}e.notShowSuggest.run();var r=f.get("NavTrans");if(r&&"NavTrans"==a&&r.total&&T.g("DriveSearchSta").value==r.start.wd&&T.g("DriveSearchEnd").value==r.end.wd)r.returnDr();else{var i=T.g("DriveSearchSta")._wd2?T.trim(T.g("DriveSearchSta")._wd2):"",c=T.g("DriveSearchEnd")._wd2?T.trim(T.g("DriveSearchEnd")._wd2):"";e.setValue("DriveSearchSta",o),T.g("DriveSearchSta")._wd2=c,e.setValue("DriveSearchEnd",t),T.g("DriveSearchEnd")._wd2=i,("NavTrans"==a||"SelAddr"==a||"NavAddr"==a||"RouteAddr"==a)&&e.qSearch(document.fmnav,"nav")}""==T.g("DriveSearchSta").value?T.g("DriveSearchSta").focus():""==T.g("DriveSearchEnd").value&&T.g("DriveSearchEnd").focus()}),a()}function a(){var e=w;baidu(".search_box form").on("submit",function(n){var t=baidu(this).data("type")||"";e.qSearch(this,t,"",{from:"button",da_src:"searchBox.button"}),n.preventDefault()}),baidu("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/.search_box form .tab").delegate("li","click",function(){var n=parseInt(baidu(this).data("tab"));switch(n){case 1:e.setSwitchTab(1,"","",{from:"button"}),addStat("indexheader.searchbox.searchboxtabs");break;case 2:e.setSwitchTab(2,"","",{from:"button"}),addStat("indexheader.searchbox.searchboxtabbt");break;case 3:e.setSwitchTab(3,"","",{from:"button"}),addStat("indexheader.searchbox.searchboxtabnav")}}),baidu("span.smp_poi_btn").on("click",function(e){baidu(this).hasClass("clearBase")||g.openList("PoiSearch",e)}),baidu("span.smp_navs_btn").on("click",function(e){var n=baidu(this).data("type");"bt"==n?g.openList("BusSearchSta",e):"nav"==n&&g.openList("DriveSearchSta",e)}),baidu("span.smp_nave_btn").on("click",function(e){var n=baidu(this).data("type");"bt"==n?g.openList("BusSearchEnd",e):"nav"==n&&g.openList("DriveSearchEnd",e)})}function r(e,n,t,o,a){var r="pcmappg.unknown";if(a&&a.da_src&&(r="pcmappg."+a.da_src),e.word.value=S.filtQuery(e.word.value),""==e.word.value)return e.word.focus(),!1;var i=l.cityCode||1,c=o||T.g("PoiSearch")&&T.g("PoiSearch")._wd2||"",s=c?1:0;T.g("PoiSearch")&&(T.g("PoiSearch")._wd2=null),window.GRControll&&(window.GRControll.openedMarker=null);var u={cinfo:{from:"searchBox"},dom:T.g("MapInfo")},d=map.getBounds();f.go("s&da_src="+r+"&wd="+encodeURIComponent(e.word.value)+"&c="+i+"&src=0&wd2="+encodeURIComponent(c)+"&sug="+s+"&l="+map.zoomLevel+"&b=("+d.minX+","+d.minY+";"+d.maxX+","+d.maxY+")&from=webmap",u),window.isPrint||p.clearInit()}function i(e,n,t,o,a,r){var i=(f.get("RouteAddr")||{},w),c=l.cityCode||1,s=2,u=2,d="",h="",g="",v="",p="",_="",b={},B=c,I=c,$=T.string.trim(e.word_from.value),E=T.string.trim(e.word_to.value),C="",x="";switch(n){case"bt":C="BusSearchSta",x="BusSearchEnd",g="bt";break;case"nav":C="DriveSearchSta",x="DriveSearchEnd",g="nav"}if(i.setValue(C,S.filtQuery($)),i.setValue(x,S.filtQuery(E)),""==$)return e.word_from.focus(),!1;if(""==E)return e.word_to.focus(),!1;T.g(C)&&(v=T.g(C)._wd2||"",T.g(C)._wd2=null),T.g(x)&&(p=T.g(x)._wd2||"",T.g(x)._wd2=null);var y,D=v?1:0,k=p?1:0,R=i.inputInfo[C],V=i.inputInfo[x],P=R&&R.point&&R.note==$,G=V&&V.point&&V.note==E;if(P&&G||!P&&!G){P&&G?(s=1,u=1,d=R.point,h=V.point,c=R.ccode||c,B=R.ccode||c,I=V.ccode||c):(i.inputInfo[C]={},i.inputInfo[x]={});var N=encodeURIComponent($),j=encodeURIComponent(v),A=encodeURIComponent(E),Q=encodeURIComponent(p);y={c:c,sn:s+"$$$$"+d+"$$"+N+"$$"+D+"$$"+j+"$$",en:u+"$$$$"+h+"$$"+A+"$$"+k+"$$"+Q+"$$",sc:B,ec:I,pn:0,rn:5}}else if(P||G)if(("button"!=t||"bt"==g)&&(g="bt"==g?"bse":"nse"),"bse"==g||"nse"==g){var U,M,q,L,F,O="";P?(U=R.point,M=R.note,q=E,L="sn",F=1,c=R.ccode||c,i.inputInfo[x]={},O=p):G&&(U=V.point,M=V.note,q=$,L="en",F=0,c=G.ccode||c,i.inputInfo[C]={},O=v);var y={c:c,t:F,poiType:"0",isSingle:"true",ptx:U.split(",")[0],pty:U.split(",")[1],wd:encodeURIComponent(q),name:encodeURIComponent(M),wd2:encodeURIComponent(O)};y[L]="1$$$$"+U+"$$"+encodeURIComponent(M)+"$$$$$$",_=g+"&"+S.jsonToQuery(y),b={cinfo:{q:_,c:c,t:0,isSingle:!0,kwn:{name:M,pt:S.getPoiPoint(U),poiType:0}}}}else{var s=2,u=2,d="",h="",B=c,I=c;P?(d=R.point,s=1,B=R.ccode||c,i.inputInfo[x]={}):G&&(h=V.point,u=1,I=G.ccode||c,i.inputInfo[C]={});var N=encodeURIComponent($),j=encodeURIComponent(v),A=encodeURIComponent(E),Q=encodeURIComponent(p);y={c:c,sn:s+"$$$$"+d+"$$"+N+"$$"+D+"$$"+j+"$$",en:u+"$$$$"+h+"$$"+A+"$$"+k+"$$"+Q+"$$",sc:B,ec:I,pn:0,rn:5}}if(y.en&&a.support()&&a.getSearchableTpCount()>0){{f.get("NavTrans")}y.en=a.getQueryParam(function(){})+y.en,y.ec=a.getCityCode()+y.ec,y.drag=1,b.cinfo=b.cinfo?b.cinfo:{},b.cinfo.fromBdyx=!0}("bt"==g||"bse"==g)&&(y.exptype="dep",y.exptime=m.getBusExpTime(),y.version=5),_=g+"&da_src=pcmappg."+r+"&"+S.jsonToQuery(y),f.go(_,b)}function c(e){var n=w,t=window.currentComponent&&window.currentComponent._className;if(2==e){if("NavTrans"==t){var o=f.get("NavTrans");if(o&&T.g("DriveSearchSta").value==o.start.wd&&T.g("DriveSearchEnd").value==o.end.wd)return void f.go(o.busQueryString,{cinfo:{switchTab:!0},dom:T.g("MapInfo")});n.qSearch(document.fmbus,"bt")}}else if(T.g("supBus").innerHTML="","BusTrans"==t){var a=f.get("BusTrans");if(a&&a.start&&T.g("BusSearchSta").value==a.start.wd&&T.g("BusSearchEnd").value==a.end.wd)return void f.go(a.getNavQuery()+(window.navTimeCache?"&time_index="+window.navTimeCache.timeIndex+"&day="+window.navTimeCache.day:"&time_index=-1&day=-1"),{dom:T.g("MapInfo")});n.qSearch(document.fmnav,"nav")}else if("CBusTrans"==t){var r=f.get("CBusTrans");if(r&&T.g("BusSearchSta").value==r.start.wd&&T.g("BusSearchEnd").value==r.end.wd)return void f.go(r.navQueryString+(window.navTimeCache?"&time_index="+window.navTimeCache.timeIndex+"&day="+window.navTimeCache.day:"&time_index=-1&day=-1"),{dom:T.g("MapInfo")});n.qSearch(document.fmnav,"nav")}("SelAddr"==t||"BusAddr"==t||"NavAddr"==t||"RouteAddr"==t)&&(2==e?n.qSearch(document.fmbus,"bt"):n.qSearch(document.fmnav,"nav"))}function s(){var e=w,n=T.object.extend({},e.inputInfo.BusSearchSta),t=T.object.extend({},e.inputInfo.BusSearchEnd),o=T.object.extend({},e.inputInfo.DriveSearchSta),a=T.object.extend({},e.inputInfo.DriveSearchEnd);e.inputInfo.BusSearchSta=t,e.inputInfo.BusSearchEnd=n,e.inputInfo.DriveSearchSta=a,e.inputInfo.DriveSearchEnd=o}function u(e){var n=w,t=n.inputInfo.BusSearchSta,o=n.inputInfo.BusSearchEnd,a=n.inputInfo.DriveSearchSta,r=n.inputInfo.DriveSearchEnd;2==e?(!t.point&&a.point&&(n.inputInfo.BusSearchSta=T.object.extend({},a)),!o.point&&r.point&&(n.inputInfo.BusSearchEnd=T.object.extend({},r))):3==e&&(!a.point&&t.point&&(n.inputInfo.DriveSearchSta=T.object.extend({},t)),!r.point&&o.point&&(n.inputInfo.DriveSearchEnd=T.object.extend({},o)))}function d(){var n=w,t=4,o=8;T.browser.ie&&(t=3),7==T.browser.ie&&(o=7),e.async("common:widget/ui/MapSuggest/MapSuggest.js",function(e){n.poiSSG=new e({inputid:"PoiSearch",closeTip:1,formName:"fmwd",_sq:!0,offset1:[-o,0]},function(e,t){t?n.qSearch(document.fmwd,"loc",e,{da_src:"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/searchBox.sugg"}):T.g("PoiSearch")&&(T.g("PoiSearch")._wd2=e)},function(){this.closeSuggestion.showTip(T.g("PoiSearch"))}),n.busSSG1=new e({inputid:"BusSearchSta",closeTip:1,qType:2,cityid:"modelConfig.cityCode",offset1:[-t,0]},function(e){T.g("BusSearchSta")&&(T.g("BusSearchSta")._wd2=e)},function(){this.closeSuggestion.showTip(T.g("BusSearchSta"))}),n.busSSG2=new e({inputid:"BusSearchEnd",closeTip:1,qType:2,cityid:"modelConfig.cityCode",offset1:[-t,0]},function(e){T.g("BusSearchEnd")&&(T.g("BusSearchEnd")._wd2=e)},function(){this.closeSuggestion.showTip(T.g("BusSearchEnd"))}),n.driveSSG1=new e({inputid:"DriveSearchSta",closeTip:1,offset1:[-t,0]},function(e){T.g("DriveSearchSta")&&(T.g("DriveSearchSta")._wd2=e)},function(){this.closeSuggestion.showTip(T.g("DriveSearchSta"))}),n.driveSSG2=new e({inputid:"DriveSearchEnd",closeTip:1,offset1:[-t,0]},function(e){T.g("DriveSearchEnd")&&(T.g("DriveSearchEnd")._wd2=e)},function(){this.closeSuggestion.showTip(T.g("DriveSearchEnd"))}),n.poiSSG.setValue(""),n.busSSG1.setValue(""),n.busSSG2.setValue(""),n.driveSSG1.setValue(""),n.driveSSG2.setValue("")})}var h=e("common:widget/ui/config/config.js"),S=e("common:widget/ui/util/util.js"),f=e("common:widget/com/componentManager.js"),g=(e("common:widget/ui/mapInfo/mapInfo.js"),e("common:widget/ui/setMyPlace/SetMyPlaceMgr.js")),v=e("common:widget/ui/BoxContainer/BoxContainer.js"),p=e("common:widget/ui/ClearBase/ClearBase.js"),m=e("common:widget/ui/indexUtil/IndexUtil.js"),l=h.modelConfig,w={_ByClickTab:!0,_curSelIndex:1,inputInfo:{BusSearchSta:{},BusSearchEnd:{},DriveSearchSta:{},DriveSearchEnd:{},iw_ssn:{},iw_esn:{}},notShowSuggest:{state:0,timer:null,run:function(){var e=this;e.state=1,e.timer&&clearTimeout(e.timer),e.timer=setTimeout(function(){e.state=0},300)}},init:function(){o()},suggest:function(){T.g("PoiSearch").value="",this.setValue("BusSearchSta",""),this.setValue("BusSearchEnd",""),this.setValue("DriveSearchSta",""),this.setValue("DriveSearchEnd",""),d()},setValue:function(e,n,t){var o=T.g(e);if(n=T.trim(n),o){var a=T.dom.getAttr(o,"_from"),r="input_"+a,i="input_"+a+"_focus";o._fromPoiSearch&&(o._fromPoiSearch=null),o.value=n,n.length>0?(T.rc(o,r),T.rc(o,i)):T.ac(o,r),"sug"==t||o.blur()}},parseShare:function(e){var n=e.split("&"),t=n[0],o={},a={},r=0,i=0;if("bt"==t||"bse"==t||"nse"==t||"nav"==t){for(var c=0,s=n.length;s>c;c++){if(n[c].indexOf("sn=1")>=0){var u=n[c].split("$$");o={note:u[3],point:u[2]}}if(n[c].indexOf("en=1")>=0){var d=n[c].split("to:"),h=d[d.length-1].split("$$");a={note:h[3],point:h[2]}}n[c].indexOf("sc=")>=0&&(r=n[c].split("=")[1]),n[c].indexOf("ec=")>=0&&(i=n[c].split("=")[1].split("to:"),i=i[i.length-1])}("bt"==t||"bse"==t)&&(o.note&&o.point&&(r&&(o.ccode=r),this.inputInfo.BusSearchSta=o),a.note&&a.point&&(i&&(a.ccode=i),this.inputInfo.BusSearchEnd=a)),("nse"==t||"nav"==t)&&(o.note&&o.point&&(r&&(o.ccode=r),this.inputInfo.DriveSearchSta=o),a.note&&a.point&&(i&&(a.ccode=i),this.inputInfo.DriveSearchEnd=a))}},qSearch:function(n,t,o,a){a=a||{};var c=a.from||"",s=window.currentComponent&&window.currentComponent._className;"loc"==t?r(n,c,s,o,a):e.async("common:widget/ui/throughpoint/Throughpoint.js",function(e){i(n,t,c,s,e,a.da_src||"unknown")}),window.PanoMap&&window.PanoMap.isOpen&&window.PanoMap.hide(),v&&v.resetStatus()},setSwitchTab:function(n,t,o,a){if(!(window.isPrint||1>n||n>3)){a=a||{},u(n),e.async("common:widget/ui/throughpoint/Throughpoint.js",function(e){e.onSwitchTab(n,a)});var r=this,i=(a.from||"",window.currentComponent&&window.currentComponent._className,this._curSelIndex);if(1==n&&null!=t&&""!=t&&(T.g("PoiSearch").value=t,r.poiSSG&&r.poiSSG.setValue(t)),i!=n){this._curSelIndex=n;for(var s=1;3>=s;s++)T.g("tab"+s).className="",T.g("form"+s).style.display="none";if(T.g("tab"+n).className="on",T.g("form"+n).style.display="block",1==n)try{T.g("form1").word.focus()}catch(d){}else T.g("form"+n).word_to.focus(),T.g("form"+n).word_from.focus();if(1!=n){if(1!=i){var h=T.trim(T.g("form"+i).word_from.value),S=T.trim(T.g("form"+i).word_to.value);this.setQValue(S,2,1),this.setQValue(h,2,0),this.setQValue(S,3,1),this.setQValue(h,3,0)}var f=T.trim(T.g("form1").word.value),g=T.trim(T.g("form"+n).word_to.value);""==g&&""!=f&&(this.setQValue(f,n,1),T.g("form"+n).word_to._fromPoiSearch=!0),c(n)}}}},setQValue:function(e,n,t){e||(e=""),n||(n=1),1>n||n>3||(1==n?this.poiSSG?this.poiSSG.setValue(e):T.g("form1").word.value=e:2==n?0==t?this.busSSG1&&this.busSSG1.setValue(e):1==t&&this.busSSG2&&this.busSSG2.setValue(e):0==t?this.driveSSG1&&this.driveSSG1.setValue(e):1==t&&this.driveSSG2&&this.driveSSG2.setValue(e))},setQFocus:function(e,n){e||(e=1),1>e||e>3||(1==e?T.g("form1").word.focus():2==e?0==n?T.g("form2").word_from.focus():1==n&&T.g("form2").word_to.focus():0==n?T.g("form3").word_from.focus():1==n&&T.g("form3").word_to.focus())}};t.exports=w});
;define("common:widget/ui/setMyPlace/SetMyPlaceList.js",function(t,i,e){var s=t("common:widget/ui/setMyPlace/SetMyPlaceStorer.js"),a='<tr class="smp_sug_item" data-uid="#uid#" data-from="#from#" ><td class="td_note">#word#</td><td class="td_action"><a href="javascript:void(0)" class="edit_place"  data-uid="#uid#" >修改</a><a href="javascript:void(0)" class="remv_place"  data-uid="#uid#"  data-word="#word#" >删除</a></td></tr>',n='<tr><td class="td_note defaultNote">#word#</td><td class="td_action"><a href="javascript:void(0)" class="add_place" data-word="#word#" >设置</a></td></tr>',o='<tr class="nonSupNote"><td class="td_note">#word#</td><td class="td_action"><a href="javascript:void(0)">设置</a></td></tr>',d={container:null,display:!1,init:function(t){var i=this,e=T.dom.create("div",{"class":"smp_sug_wrap"});this.container=e,document.body.appendChild(e),T.on(document.body,"click",function(){i.hide()}),map.addEventListener("mousedown",function(){i.hide()}),this.open(t)},open:function(t){this.container?this.toggle(t):this.init(t)},toggle:function(t){this.display&&this.display==t?this.hide():(this.show(t),this.update(t))},show:function(t){var i=this;this.container.style.display="block",this.display=t,map.infoWindow&&(T.on(map.infoWindow.contentMain,"click",function(){i.hide()}),T.on(map.infoWindow.titleDiv,"click",function(){i.hide()}))},hide:function(){this.container&&(this.container.style.display="none",this.display=!1)},update:function(t){this.setContent({from:t}),this.setPosAndSize(t)},setPosAndSize:function(t){var i=T.g(t+"Span"),e=i?i:T.g(t).parentNode,s=T.g("smp_sug_table"),a=T.dom.getPosition(e),n=this.container,o=e.clientWidth,d=e.offsetHeight;if(("iw_esn"==t||"iw_ssn"==t)&&(o-=2),o>=s.offsetWidth+2&&(s.style.width=o+"px"),T.browser.ie<=6){n.style.width="100%";var r=s.offsetWidth;n.style.width=r+"px"}n.style.top="PoiSearch"==t?a.top+d-1+"px":"onway_1"==t?a.top+d-1+"px":a.top+d+"px",n.style.left=a.left+"px"},setContent:function(t){t=t||{};var i=t.from||"",e=['<table id="smp_sug_table" class="smp_sug_table" cellspacing="0" cellpadding="1">'];if(!T.swf.version){var a="(请安装flash插件)";return("iw_esn"==i||"iw_ssn"==i)&&(a=""),e.push(this.getItem({note:"我的家"},"nonsup",i)),e.push('</table><div id="smp_table_exts" class="exts oversize"><a href="javascript:void(0)">设置常用地点</a>'+a+"</div>"),void(this.container.innerHTML=e.join(""))}var n=s.getAll(),o=this.getExtHtml(n,i);if(n&&0!=n.length)for(var d=0,r=n.length;r>d;d++)e.push(this.getItem(n[d],"normal",i));else e.push(this.getItem({note:"我的家"},"default",i));e.push("</table>"+o),this.container.innerHTML=e.join("")},getExtHtml:function(t,i){var e='<div id="smp_table_exts" class="exts"><a class="add_place_btn" href="javascript:void(0)" data-from="'+i+'" >设置常用地点</a></div>';if(t&&0!=t.length){if(t.length>=4){var s="(最多设置4个常用地点)";("iw_esn"==i||"iw_ssn"==i)&&(s=""),e='<div id="smp_table_exts" class="exts oversize"><a href="javascript:void(0)">设置常用地点</a>'+s+"</div>"}}else{var s="";("iw_esn"==i||"iw_ssn"==i)&&(s="");var e='<div id="smp_table_exts" class="exts"><a  class="add_place_btn" href="javascript:void(0)" data-from="'+i+'">设置常用地点</a><span style="color:#B3B3B3">'+s+"</span></div>"}return e},getItem:function(t,i,e){var s="";switch(i){case"normal":s=a;break;case"default":s=n;break;case"nonsup":s=o}var d=s.replace(/#word#/gi,t.note).replace(/#uid#/gi,t.uid).replace(/#from#/gi,e);return d}};e.exports=d});
;define("common:widget/ui/setMyPlace/SetMyPlaceStorer.js",function(t,i,e){var r=(t("common:widget/ui/util/util.js"),t("common:widget/ui/config/config.js")),n=(r.mapConfig,{baiduStorage:null,arr:null,userId:encodeURIComponent(baidu.cookie.get("BAIDUID"))||"",init:function(i){var e=this;t.async("common:widget/ui/Storage/Storage.js",function(t){e.baiduStorage=t,i()})},setAll:function(t){this.baiduStorage.set({key:"_smp_save",value:baidu.json.stringify(t)}),this.arr=t},set:function(t){var i=this.arr;if(i&&0!=i.length){var e=this.getIndexByUid(t.uid);void 0!=e?i[e]=t:i.push(t)}else i=[t];this.setAll(i)},getAll:function(){try{var t=baidu.json.parse(this.baiduStorage.get({key:"_smp_save"}))}catch(i){return}return this.arr=t||[],t},getItemByUid:function(t){if(t){var i=this.getIndexByUid(t);return this.arr[i]}},getIndexByUid:function(t){if(t)for(var i=0,e=this.arr.length;e>i;i++)if(t==this.arr[i].uid)return i},rmvItemByUid:function(t){t&&this.rmvItemByIndex(this.getIndexByUid(t))},rmvItemByIndex:function(t){T.array.removeAt(this.arr,t),this.setAll(this.arr)},clear:function(){this.baiduStorage.remove({key:"_smp_save"})}});e.exports=n});
;define("common:widget/ui/setMyPlace/SetMyPlaceMgr.js",function(e,i,n){var t=(e("common:widget/com/componentManager.js"),e("common:widget/ui/util/util.js")),o=e("common:widget/ui/setMyPlace/SetMyPlaceList.js"),a=e("common:widget/ui/setMyPlace/SetMyPlaceStorer.js"),s=e("common:widget/ui/config/config.js"),d=(s.mapConfig,{isEmpty:function(e){return!/\S+/.test(e)},isNotWord:function(e){return!/^[\u4E00-\u9FA5\uf900-\ufa2d\w]{0,30}$/.test(e)},isOverLong:function(e,i){return T.string.getByteLength(e)>i?!0:!1}}),r={box:null,init:function(){var e=this;this.box=T.dom.create("div",{id:"smp_cover"}),this._innerFun=function(){e.resize()},T.on(window,"resize",this._innerFun)},show:function(){var e=this.box;T.browser.ie?document.body.appendChild(e):(document.body.appendChild(e),window.setTimeout(function(){e.style.opacity="0.2"},0)),this.resize()},hide:function(){var e=this;T.browser.ie?(e.box&&document.body.removeChild(e.box),e.clear()):(e.box.style.opacity=0,window.setTimeout(function(){e.box&&document.body.removeChild(e.box),e.clear()},250))},resize:function(){if(this.box){var e=this.box,i=t.getClientSize();6==T.browser.ie&&(e.style.width=i.width+"px",e.style.height=i.height+"px")}},clear:function(){this._innerFun&&(T.un(window,"resize",this._innerFun),delete this._innerFun),delete this.box}},c=[0,T.G("searchWrapper").offsetHeight],u=1,l=new BMap.Icon("../images/tools_img_39c80b4.png"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/tools_img_39c80b4.png*/,new BMap.Size(13,16),{offset:new BMap.Size(3,16),imageOffset:new BMap.Size(0,-280),infoWindowOffset:new BMap.Size(3,0)}),h={popOpts:{title:"设置常用地点",height:343,width:457,left:380,clickClose:!1,addDom:document.body,offset:c||[0,0],defaultAnchor:u,close:function(){h.closePop()}},helper:d,storer:a,popup:null,component:null,markers:{},infoWindows:{},openList:function(e,i){t.stopBubble(i||window.event),o.open(e),this.bindEvents()},init:function(){if(!window.isPrint){var e=this;a.init(function(){e.addAllPlace()})}},open:function(i){this.popup&&this.popup.close(),i=i||{};var n=this;e.async(["common:widget/ui/Popup/Popup.js","common:widget/com/SetMyPlace/SetMyPlace.js"],function(e,t){var o=n.popup=new e(n.popOpts);o.render(),o.hide(),r.init();new t({dom:o.content,cinfo:i});r.show(),o.show()});var t=T.browser.ie&&T.browser.ie<=7?"keypress":"keydown";T.on(window.document,t,function(e){n._escFun=arguments.callee,27==e.keyCode&&n.popup&&n.popup.close()})},clear:function(){if(this._escFun){var e=T.browser.ie&&T.browser.ie<=7?"keypress":"keydown";T.un(window.document,e,this._escFun),delete this._escFun}map.enableScrollWheelZoom(),this.component.dispose(),r.hide(),delete this.popup},addAllPlace:function(){var e=a.getAll();if(e&&0!=e.length)for(var i=0,n=e.length;n>i;i++)this.buildOverlay(e[i])},buildOverlay:function(e){var i=this,n=this.createMarker(e);return map.addOverlay(n),n.addEventListener("click",function(){t.loadSearchInfo(function(t){var o=i.createInfoWindow(e,t);t.openSearchInfoWnd(o,n)})}),{marker:n}},createInfoWindow:function(e,i){if(e){var n=e.point.split(","),t=i.createSearchInfoWnd({title:e.note,addr:e.addr},{smp:e.uid,cityCode:e.ccode,x:n[0],y:n[1]});return this.infoWindows[e.uid]=t,t}},createMarker:function(e){if(e){var i=t.getPoiPoint(e.point),n=new BMap.Marker(i,{icon:l,title:e.note,enableMassClear:!1});return this.markers[e.uid]=n,n}},updateOverLay:function(e){if(e&&e.uid){var i=e.uid,n=this.markers[i],t=this.infoWindows[i];n&&t&&(map.removeOverlay(n),map.removeOverlay(t)),this.buildOverlay(e)}},addMyPlace:function(e,i){this.open({note:e}),this.hideSug(),"PoiSearch"==i?addStat("indexheader.searchbox.setfusedplace",null,{da_src_bk:"searchBox"}):"iw_ssn"==i||"iw_esn"==i?addStat("poiinfowin.searchbox.setfusedplace",null,{da_src_bk:"bubble"}):addStat("indexheader.searchbox.setfusedplace",null,{da_src_bk:"busandnav"})},editMyPlace:function(e,i){t.stopBubble(e||window.event),this.open(a.getItemByUid(i)),window.MYADDRLAYER_FR_EDIT=!0,this.hideSug()},rmvMyplace:function(e,i,n){t.stopBubble(e||window.event);var o=window.confirm("是否要删除常用地点“"+n+"”?");o&&(this.markers[i]&&map.removeOverlay(this.markers[i]),a.rmvItemByUid(i)),this.hideSug()},showMyPlace:function(e){if(e&&this.markers[e]){var i=this.markers[e],n=this.infoWindows[e];i&&n&&t.loadSearchInfo(function(e){e.openSearchInfoWnd(n,i)}),map.centerAndZoom(i.getPoint(),16)}},itemClick:function(i,n,t,o){var s=e("common:widget/ui/searchBox/searchBox.js");if("PoiSearch"==t){var d=a.getItemByUid(i);return T.g(n).value=" ",void s.notShowSuggest.run()}if(s.notShowSuggest.run(),"PoiSearch"==n)this.showMyPlace(i),addStat("indexheader.searchbox.usefusedplace",null,{da_src_bk:"searchBox"});else{var d=a.getItemByUid(i);"iw_ssn"==n||"iw_esn"==n?(T.g(n).value=d.note,addStat("poiinfowin.searchbox.usefusedplace",null,{da_src_bk:"bubble"})):(s.setValue(n,d.note,o),addStat("indexheader.searchbox.usefusedplace",null,{da_src_bk:"busandnav"})),s.inputInfo[n]?s.inputInfo[n]=T.object.extend(s.inputInfo[n],d):e.async("common:widget/ui/throughpoint/Throughpoint.js",function(e){e.setTPPointBySmp(n,d)})}},hideSug:function(){o.hide()},closePop:function(){window.MYADDRLAYER_FR_EDIT=!1,this.clear()},bindEvents:function(){var e=this;baidu("a.add_place_btn").on("click",function(){var i=baidu(this).data("from")||"";e.addMyPlace("",i)}),baidu("tr.smp_sug_item").on("click",function(){var i=baidu(this).data("from")||"",n=baidu(this).data("uid")||"";e.itemClick(n,i)}),baidu("a.add_place").on("click",function(){var i=baidu(this).data("word")||"";e.addMyPlace(i)}),baidu("a.edit_place").on("click",function(i){var n=baidu(this).data("uid")||"";e.editMyPlace(i,n)}),baidu("a.remv_place").on("click",function(i){var n=baidu(this).data("uid")||"",t=baidu(this).data("word")||"";e.rmvMyplace(i,n,t)})}};n.exports=h});
;define("common:widget/ui/mapInfo/mapInfo.js",function(t,e,i){var n=t("common:widget/ui/util/util.js"),o=t("common:widget/ui/mapInfoScroll/mapInfoScroll.js"),s={status:"open",isGoing:!1,timer:null,sideWidth:350,init:function(){var t=this;t.bindEvent()},hide:function(){var t=this;if(t.status="close",!t.isGoing){t.isGoing=!0;var e=T.g("MapHolder"),i=T.g("tools"),o=T.g("MapInfoCon"),s=T.g("MapInfoNav"),a=T.g("MapInfoTab"),l=T.g("citytools"),g=T.g("shad_v"),p=map.getCenter(),d=n.getClientSize().height-142+32,f=n.getClientSize().width,m=(T.g("tool_container"),T.g("StreetViewHolder")),r=this.sideWidth;l.style.left=0,o.style.left="-"+r+"px",s.style.left="-"+r+"px",a.style.left=0,g.style.left=0,i.style.paddingLeft=0,e.style.marginLeft=0,e.style.height=d+"px",m.style.marginLeft=0,map.addEventListener("resize",function(){map.setCenter(p),map.removeEventListener("resize",arguments.callee)}),a.className="mapinfo_but mapinfo_but_open",a.title="显示左栏",T.g("cityBottom")&&baidu.dom.hide(T.g("cityBottom")),t.isGoing=!1,this.dispatchEvent("onHideSide",{action:"hide",size:{width:f,height:d,marginLeft:0}})}},show:function(){var t=this;if(t.status="open",!t.isGoing){t.isGoing=!0;var e=T.g("MapHolder"),i=T.g("tools"),o=T.g("MapInfoCon"),s=T.g("MapInfoNav"),a=T.g("MapInfoTab"),l=T.g("citytools"),g=T.g("shad_v"),p=map.getCenter(),d=n.getClientSize().height-142+32,f=n.getClientSize().width-this.sideWidth,m=(T.g("tool_container"),T.g("StreetViewHolder")),r=this.sideWidth;l.style.left=r+"px",o.style.left="2px",s.style.left="1px",a.style.left=r+1+"px",g.style.left=r+"px",e.style.height=d+"px",e.style.marginLeft=r+1+"px",i.style.paddingLeft=r+"px",m.style.marginLeft=r+"px",map.addEventListener("resize",function(){map.setCenter(p),map.removeEventListener("resize",arguments.callee)}),a.className="mapinfo_but",a.title="收起左栏",t.isGoing=!1,T.g("cityBottom")&&baidu.dom.show(T.g("cityBottom")),this.dispatchEvent("onShowSide",{action:"show",size:{width:f,height:d,marginLeft:r}})}},bindEvent:function(){var t=this;T.on(T.g("MapInfoTab"),"mouseover",function(){var e="mapinfo_but_close_on";"close"==t.status&&(e="mapinfo_but_open_on"),this.className="mapinfo_but "+e}),T.on(T.g("MapInfoTab"),"mouseout",function(){var e="";"close"==t.status&&(e="mapinfo_but_open"),this.className="mapinfo_but "+e}),T.on(T.g("MapInfoTab"),"click",function(){"open"==t.status?(addStat("indexleftmenu.placemenu.sidebarclose"),t.hide()):(addStat("indexleftmenu.placemenu.sidebaropen"),t.show(),o.update())})}};s=baidu.lang.createSingle(s),i.exports=s});
;define("common:widget/ui/mapInfoScroll/mapInfoScroll.js",function(n,e,a){var l={panel:null,init:function(){var n=this,e=5;T.browser.ie&&(e=3),n.panel=new baidu.ui.ScrollPanel({container:"MapInfo",overflow:"overflow-y",margin:[5,e,5,0]}),n.panel.render("MapInfo")},update:function(n){if(!window.isPrint){n=n||{};var e=this,a=n.notToTop;e.panel&&e.panel.update(),a||e.panel.getScrollBar().scrollTo(0)}},show:function(){var n=this;if(n.panel){{n.panel.getTarget()}n.panel&&n.panel.setVisible(!0)}},hide:function(){var n=this;if(n.panel){{n.panel.getTarget()}n.panel&&n.panel.setVisible(!1)}}};a.exports=l});
;define("common:widget/ui/fullScreen/fullScreen.js",function(e,t,l){var i=e("common:widget/ui/util/util.js"),n=e("common:widget/ui/mapInfo/mapInfo.js"),o=e("common:widget/ui/history/history.js"),s=T.g("searchWrapper"),r=T.g("MapHolder"),a=T.g("tools"),u=T.g("MapInfoCon"),c=T.g("MapInfoNav"),g=T.g("MapInfoTab"),f=T.g("citytools"),d=T.g("shad_v"),p=T.g("tool_fullScrF"),y=T.g("tools_search"),m="",h=(T.g("tool_container"),350),S=T.g("StreetViewHolder"),w=T.g("tools-container"),v={isFullScreen:!1,isGoing:!1,timer:null,sideWidth:350,init:function(){var e=this;e.bindEvent()},toFull:function(t){var l=this;if(!l.isGoing){l.isGoing=!0,w.style.top="0px",T.G("MaptoDown_tip")&&baidu.dom.remove(T.G("MaptoDown_tip")),T.g("cityBottom")&&baidu.dom.hide(T.g("cityBottom"));var n=i.getClientSize().height,v=i.getClientSize().width;T.rc(T.g("tool_fullScr"),"span_focus"),T.rc(T.g("tool_fullScr"),"toolBtn--img--full"),T.ac(T.g("tool_fullScr"),"toolBtn--img--returnFull"),window.GRControll&&window.GRControll.setGRequestFlg(1e3),"none"!=T.G("form1").style.display&&(m=T.G("PoiSearch").value),T.G("ToolPoiSearch").value=m,f.style.left=0,s.style.display="none",u.style.left=-h+"px",c.style.left=-h+"px",g.style.display="none",d.style.left=0,a.style.paddingLeft=0,r.style.marginLeft=0,r.style.height=n+"px",y.style.display="",S.style.marginLeft=0,p.innerHTML="退出全屏",T.g("tool_fullScr").style.display="block",map.fullScreenMode=l.isFullScreen=!0;var x=map.getCenter();map.addEventListener("resize",function(){map.setCenter(x),map.removeEventListener("resize",arguments.callee)}),l.isGoing=!1,null==t&&o.record({url:"isfullScreen=true"}),this.dispatchEvent("onFullScreen",{action:"enter",size:{width:v,height:n,marginLeft:0}}),e.async("common:widget/ui/setDefCity/SetDefCity.js",function(e){e.hideCityTip()}),addStat("indextool.toolbar.fullscreen")}},exitFull:function(t){var l=this;if(!l.isGoing){l.isGoing=!0,w.style.top=T("#searchWrapper").outerHeight()+"px";var m=i.getClientSize().width,v=i.getClientSize().height-142+32,x=0,C=m;T.rc(T.g("tool_fullScr"),"span_focus"),T.rc(T.g("tool_fullScr"),"toolBtn--img--returnFull"),T.ac(T.g("tool_fullScr"),"toolBtn--img--full"),"open"==n.status&&(C-=h),window.GRControll&&window.GRControll.setGRequestFlg(1e3),y.style.display="none",s.style.display="",g.style.display="",T.g("cityBottom")&&baidu.dom.show(T.g("cityBottom")),"open"==n.status&&(m-=h,x+=h,u.style.left=0,c.style.left="1px",r.style.marginLeft=h+1+"px",f.style.left=h+"px",S.style.marginLeft=h+"px"),d.style.left=x+"px",a.style.paddingRight=x+"px",r.style.height=v+"px",p.innerHTML="全屏",map.fullScreenMode=l.isFullScreen=!1;var F=map.getCenter();map.addEventListener("resize",function(){map.setCenter(F),map.removeEventListener("resize",arguments.callee)}),l.isGoing=!1,null==t&&o.record({url:"isfullScreen=false"});var G="open"==n.status?h:0;this.dispatchEvent("onExitFull",{action:"exit",size:{width:m,height:v,marginLeft:G}}),e.async("common:widget/ui/setDefCity/SetDefCity.js",function(e){e.hideCityTip()}),addStat("indextool.toolbar.exitfullscreen")}},toggleFullScreen:function(){this.isFullScreen?this.exitFull():this.toFull()},bindEvent:function(){var e=this;T.on("tool_fullScr","click",function(){e.toggleFullScreen()}),T.on(document,"keydown",function(t){t=window.event||t,27==t.keyCode&&e.isFullScreen&&setTimeout(function(){e.exitFull()},100)})},fullScreenState:function(){return this.isFullScreen?!0:!1}};l.exports=v=baidu.lang.createSingle(v),window.fullScreenCtrl=v});
;define("common:widget/ui/PanoUtil/PanoUtil.js",function(e,t,n){function i(){var e=baidu.g("StreetViewHolder"),t=e.clientWidth,n=e.clientHeight,i=map.getSize(),o=t>0?t:i.width,a=n>0?n:i.height;return{width:o,height:a}}var o=window.Pano=window.Pano||{};o.PANO_TYPE_STREET="street",o.PANO_TYPE_INDOOR="inter",o.PANO_TYPE_PARK="park",o.PanoLayoutType={DEFAULT:0,SPLIT_HORIZON:1,SPLIT_VERTICAL:2,DEFINE:3,FULL_HORIZON:4,FULL_VERTICAL:5};var a=e("common:widget/com/componentManager.js"),s=e("common:widget/ui/fullScreen/fullScreen.js"),r=e("common:widget/ui/mapShare/MapShare.js"),h=e("common:widget/ui/toolShare/ToolShare.js"),d=e("common:widget/ui/tools/tools.js"),p=e("common:widget/ui/PanoService/PanoService.js"),c=e("common:widget/ui/util/util.js"),l=e("common:widget/ui/config/config.js"),v=l.modelConfig,u=l.urlConfig,m=function(t,n){var l={curCity:"",curCode:1,panoMarker:null,panoLoad:!1,panoView:null,stOverFrame:null,panoType:"",panoId:"",innerId:"",heading:"",pitch:"",panoPt:null,isOpen:!1,panoOverView:null,indoorOverView:null,stExitMarker:null,from:"",panoPOI:null,pname:"",paddr:"",level:16,poiUid:"",hasPanoEvents:!1,hasOverEvents:!1,showPano:function(e){e=e||{},this.isOpen=!0,this.setData(e),this.panoView?this._setPano():this._showPano(),t.PanoMap&&t.PanoMap.isOpen&&t.PanoMap.hide()},closePano:function(e,n){t.streetViewTool&&t.streetViewTool.isOpen&&!n&&t.streetViewTool.resetStatus(),this.removePanoEvents(),this.removeOverEvents(),this.panoView&&this.panoView.hide(),this.stOverFrame&&this.stOverFrame.hide(),this.panoOverView&&this.panoOverView.removeEvents(),this.indoorOverView&&this.indoorOverView.removeEvents(),this._closeInfoWindow(),this.setTools(!1),this._reset(),baidu.g("messagebox").style.display="none",e&&"tool"==e&&t.streetViewTool&&t.streetViewTool.setStatus()},setData:function(e){this.panoSize=e.size||i(),this.panoId=e.panoId,this.innerId=e.innerId,this.panoType=e.panoType||o.PANO_TYPE_STREET,(e.heading||0===e.heading)&&(this.heading=e.heading),(e.pitch||0===e.pitch)&&(this.pitch=e.pitch),this.from=e.from||"",this.panoPOI=e.poi||{},this.panoPt=e.point||this.panoPt,this.pname=this.panoPOI.name||"",this.paddr=e.addr||"",this.poiUid=e.poiUid,e.poi&&(e.markers=[],e.markers.push(e.poi)),this.panoMarkers=e.markers||[],this.curCity=e.cityname||v.cityName,this.curCode=v.cityCode},hide:function(){this.closePano()},clearStatus:function(){t.streetViewTool&&t.streetViewTool.resetStatus()},createOverFrame:function(e){this.stOverFrame||(this.stOverFrame=new e("StreetOverViewHolder",{mapHolder:"MapHolder",panoHolder:"StreetViewHolder"}))},showOverview:function(t){var i=this;e.async(["common:widget/ui/StreetOverViewFrame/StreetOverViewFrame.js","common:widget/ui/StreetOverView/StreetOverView.js"],function(e,o){i.createOverFrame(e),i.bindOverEvents(),i.panoOverView=new o({dom:i.stOverFrame.contentContainer,panoView:i.panoView,overFrame:i.stOverFrame,mapContainer:i.stOverFrame.contentContainer,point:t,level:i.level||n.getZoom()}),i.stOverFrame.show()})},showIndoorView:function(t){var n=this;e.async(["common:widget/ui/StreetOverViewFrame/StreetOverViewFrame.js","common:widget/ui/IndoorView/IndoorView.js"],function(e,i){n.createOverFrame(e),n.panoOverView&&n.panoOverView.removeEvents(),n.bindOverEvents(),n.indoorOverView=new i({dom:n.stOverFrame.contentContainer,panoView:n.panoView,overFrame:n.stOverFrame,mapContainer:n.stOverFrame.contentContainer,indoorData:t}),n.stOverFrame.show(),t.hasImage||n.stOverFrame.setVisible(!1)})},addFlashMarkers:function(e){this.panoView.addFlashMarkers(e)},clearMarkers:function(){this.panoView.clearMarkers()},bindPanoEvents:function(){if(!this.hasPanoEvents){var e=this,n=this.guid,i=this.panoView,o=s;i.addEventListener("onLoad",function(t){e._setLoaded(t),i.removeEventListener("onLoad",n+"_onLoad")},n+"_onLoad"),i.addEventListener("onError",function(t){e._showErrInf(t)},n+"_onError"),i.addEventListener("onVisibleChange",function(t){e._setVisible(t)},n+"_onVisibleChange"),i.addEventListener("onPanoChanged",function(t){e._setPanoInfo(t)},n+"_onPanoChanged"),i.addEventListener("onPovChanged",function(t){e._setPanoPov(t)},n+"_onPovChanged"),i.addEventListener("onPOIClick",function(t){e._showPOIInf(t)},n+"_onPOIClick"),i.addEventListener("onEnterIndoor",function(t){e._enterIndoor(t)},n+"_onEnterIndoor"),i.addEventListener("onExitIndoor",function(t){e._exitIndoor(t)},n+"_onExitIndoor"),o.addEventListener("onFullScreen",function(){addStat(STAT_CODE.STAT_STREETVIEW,{item:e.panoType,func:"fullscreen"})},n+"_onFullScreen"),baidu(t).resize(function(){setTimeout(function(){e.resizeWindow()},50)}),this.hasPanoEvents=!0}},removePanoEvents:function(){var e=this.panoView,t=this.guid,n=s;e&&(e.removeEventListener("onError",t+"_onError"),e.removeEventListener("onVisibleChange",t+"_onVisibleChange"),e.removeEventListener("onPanoChanged",t+"_onPanoChanged"),e.removeEventListener("onPovChanged",t+"_onPovChanged"),e.removeEventListener("onPOIClick",t+"_onPOIClick"),e.removeEventListener("onEnterIndoor",t+"_onEnterIndoor"),e.removeEventListener("onExitIndoor",t+"_onExitIndoor")),n.removeEventListener("onFullScreen",t+"_onFullScreen"),this.hasPanoEvents=!1},bindOverEvents:function(){if(!this.hasOverEvents){var e=this,t=this.guid,n=this.stOverFrame;n.addEventListener("onVisibleChange",function(t){e.setPanoSize(t),0==t.visible&&addStat(STAT_CODE.STAT_STREETVIEW,{item:e.panoType,catalog:"overview",func:"hide"})},t+"_onVisibleChange"),n.addEventListener("onRetDefault",function(t){e.setPanoSize(t)},t+"_onRetDefault"),n.addEventListener("onEnterFull",function(t){e.setPanoSize(t)},t+"_onRetDefault"),n.addEventListener("onWindowResize",function(t){e.setPanoSize(t)},t+"_onWindowResize"),n.addEventListener("onAbsorb",function(t){e.setPanoSize(t),addStat(STAT_CODE.STAT_STREETVIEW,{item:e.panoType,catalog:"overview",func:"absorb"})},t+"_onAbsorb"),n.addEventListener("onHolderResize",function(t){e.setPanoSize(t)},t+"_onHolderResize"),this.hasOverEvents=!0}},removeOverEvents:function(){var e=this.stOverFrame,t=this.guid;e&&(e.removeEventListener("onEnterFull",t+"_onRetDefault"),e.removeEventListener("onRetDefault",t+"_onRetDefault"),e.removeEventListener("onWindowResize",t+"_onWindowResize"),e.removeEventListener("onAbsorb",t+"_onAbsorb"),e.removeEventListener("onVisibleChange",t+"_onVisibleChange"),e.removeEventListener("onHolderResize",t+"_onHolderResize")),this.hasOverEvents=!1},setPanoSize:function(e){var t=this.panoView,i=this.stOverFrame,a=o.PanoLayoutType,s=e.size,r=e.layout||i.layoutType,h=n.getSize(),d=h.width,p=h.height,c=T.g("StreetOverViewHolder"),l="hidden"===c.style.visibility?!1:!0;switch(r){case a.SPLIT_HORIZON:case a.FULL_HORIZON:p=0==e.visible?h.height:p-s.height,l||(p=h.height);break;case a.SPLIT_VERTICAL:case a.FULL_VERTICAL:d=0==e.visible?h.width:d-s.width,l||(d=h.width)}t.setSize({width:d,height:p})},_showPano:function(){var t=this;e.async("common:widget/ui/StreetView/StreetView.js",function(e){t.panoView=new e("StreetViewHolder",{panoId:t.panoId,innerId:t.innerId,panoType:t.panoType,heading:t.heading,pitch:t.pitch,size:t.panoSize,poiUid:t.poiUid}),t.setStatus()})},_setPano:function(){this.panoPt=this.panoPt||{},this.panoView.setPano(this.panoId,{panoType:this.panoType,heading:this.heading,pitch:this.pitch,size:this.panoSize,x:this.panoPt.lng,y:this.panoPt.lat,poiUid:this.poiUid}),this.clearMarkers(),this.addFlashMarkers(this.panoMarkers),this.setStatus()},setStatus:function(){this.bindPanoEvents(),this.panoView.show(),this._setShareParam(),T.un("tool_street_view_share","click",this.shareTool),T.un("tool_panoClose","click",this.closeTool),T.on("tool_street_view_share","click",this.shareTool),T.on("tool_panoClose","click",this.closeTool)},_reset:function(){this.panoType=o.PANO_TYPE_STREET,this.panoId="",this.innerId="",this.heading="",this.pitch="",this.panoPt=null,this.isOpen=!1,this.panoOverView=null,this.indoorOverView=null,this.from="",this.panoMarkers=[],this.pname="",this.paddr="",this._setShareParam(),T.un("tool_street_view_share","click",this.shareTool),T.un("tool_panoClose","click",this.closeTool)},_setLoaded:function(){this.panoLoad=!0,this.addFlashMarkers(this.panoMarkers)},_setVisible:function(e){var t=e.visible;this.setTools(t),t&&this.panoType==o.PANO_TYPE_STREET&&this.showOverview(this.panoPt)},_setPanoInfo:function(e){var t=e.pano;this.panoType=t.panoType||this.panoType,this.panoId=this.panoType==o.PANO_TYPE_STREET?t.panoid:this.panoId,this.innerId=this.panoType==o.PANO_TYPE_STREET?"":t.panoid,this.heading=t.heading,this.pitch=t.pitch,this.paddr=t.rname||"",this.panoPt=new BMap.Point(t.x,t.y),this._setShareParam(),this._closeInfoWindow(),addStat(STAT_CODE.STAT_STREETVIEW,{item:this.panoType,func:"enter",cityname:this.curCity})},_setPanoPov:function(e){var t=e.pov;this.panoType=t.panoType||this.panoType,this.heading=t.heading,this.pitch=t.pitch,this._setShareParam(),this._closeInfoWindow()},_enterIndoor:function(e){var t=e.data;t&&(this.panoType=o.PANO_TYPE_INDOOR,this.panoId=t.innerId,this.poiUid=t.poiuid,this.panoPt=new BMap.Point(t.x,t.y),this.showIndoorView(t),this._setShareParam(),this._closeInfoWindow(),this._showScenicTheme(this.poiUid))},_showScenicTheme:function(e){function t(e){var t={show:0,baseBlock:0,detailBlock:0};return e&&e.name?(e.entrance_price&&e.shop_hours&&(t.baseBlock=1),(e.sug_time||e.best_time)&&(t.detailBlock=1),(t.baseBlock||t.detailBlock)&&(t.show=1),t):t}var n=this;baidu.ajax("/?qt=panoScenic&uid="+e+"&ie=utf-8&t="+(new Date).getTime(),{dataType:"json",success:function(e){if(e&&e.content){var i=t(e.content);i.show&&a.load("PanoScenicTheme",{dom:T("#PanoramaTheme"),cinfo:{themeData:e.content,baseBlock:i.baseBlock,detailBlock:i.detailBlock,panoramaFlashInteractive:n.panoView}})}},error:function(){}})},_exitIndoor:function(e){if(e&&e.data){var t=e.data,n=new BMap.Point(t.x,t.y);this.panoPt=n,this.panoType=o.PANO_TYPE_STREET,this.panoId=t.pid,this.innerId="",this.showOverview(n),this._setShareParam()}},_setShareParam:function(){var e=r,t=h,n=this.curCity+this.pname,i=this.paddr,o=this.panoId,a=o?this.panoType:"",s="",d="";"inter"==a?(s=this.innerId,d=this.panoId,e.setParam("pid",s),e.setParam("iid",d)):(s=this.panoId,e.setParam("pid",s),e.setParam("iid","")),e.setParam("panoid",o),e.setParam("panotype",a),e.setParam("heading",this.heading+""),e.setParam("pitch",this.pitch+""),t.setShareText({sname:n,saddr:i})},_showPOIInf:function(t){var n=this,i=t.data;e.async("common:widget/ui/PanoInfoUtil/PanoInfoUtil.js",function(e){e.show({panoView:n.panoView,data:i})})},_closeInfoWindow:function(){e.async("common:widget/ui/PanoInfoUtil/PanoInfoUtil.js",function(e){e.close()})},setTools:function(e){var n=T.g("tool_event"),i=T.g("tool_sehInView"),o=T.g("tool_traffic"),a=T.g("tool_tollCon"),s=T.g("tool_fullScr"),r=T.g("tool_pano_share"),h=T.g("tool_street_view_share"),p=T.g("tool_panoClose");1==e?(h.style.display="block",p.style.display="block",s.style.display="block",n.style.display="none",i.style.display="none",o.style.display="none",a.style.display="none",r.style.display="none",t.trafficCtrl&&t.trafficCtrl.close(),t.searchInViewCtrl&&t.searchInViewCtrl.exit(),t.captureCtrl&&t.captureCtrl.endCapture(),t.MapSignInst&&t.MapSignInst.exituserSign()):(h.style.display="none",p.style.display="none",i.style.display="block",o.style.display="block",a.style.display="block"),d&&d.resetWidth()},shareTool:function(){T.rc(this,"span_focus"),h.open(this,{type:"street",from:"streetview"}),addStat(STAT_CODE.STAT_STREETVIEW,{item:m.panoType,func:"share"})},closeTool:function(){T.rc(this,"span_focus"),m.showExitMkr({point:m.panoPt,panoId:m.panoId,panoType:m.panoType,level:m.level}),m.closePano("tool")},setPOI:function(e){"poi"!=this.from&&"alamap"!=this.from||this.panoType!=o.PANO_TYPE_STREET||this.panoView.setPOI(e)},resizeWindow:function(){this.stOverFrame&&this.isOpen&&this.stOverFrame.WindowResize()},showExitMkr:function(n){if(n&&n.panoId&&n.point){var i=this,o=baidu.object.clone(n);t.panoExitMarker?(this.stExitMarker=t.panoExitMarker,this.stExitMarker.show({panoId:o.panoId,panoType:o.panoType},o.point,o.level)):e.async("common:widget/ui/StreetMarker/StreetMarker.js",function(e){i.stExitMarker=new e(o),t.panoExitMarker=i.stExitMarker}),t.panoExitMarker=this.stExitMarker}},isPanoStatus:function(){return t.streetViewTool&&t.streetViewTool.isOpen||this.isOpen?!0:!1},_showErrInf:function(t){var n=this,i="",o="";switch(t.errorType){case"IO_ERROR":i="网络异常，请重新加载!",o="error";break;case"NO_PANO":i="抱歉, 该地方没有全景";break;default:i="抱歉错误了，请重新加载!",o="error"}e.async("common:widget/ui/PanoMsgBox/PanoMsgBox.js",function(e){n.msgBox=new e({data:{info:i,funtype:o}}),n.msgBox.show()})},revert:function(e){var t=this,n=e.panoid,i=e.panotype,a=e.heading?e.heading:"",s=e.pitch?e.pitch:"",r="";i==o.PANO_TYPE_INDOOR&&e.pid&&(n=e.iid,r=e.pid),i==o.PANO_TYPE_INDOOR?baidu.ajax("/?qt=inf&ie=utf-8&uid="+n+"&t="+(new Date).getTime(),{dataType:"json",success:function(e){if(e&&e.content){var o=c.geoToPoint(e.content.geo);t.showPano({point:o,panoId:n,innerId:r,panoType:i,heading:a,pitch:s})}},error:function(){}}):i==o.PANO_TYPE_STREET&&("alamap"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/==e.from&&e.puid?this.revertFromAlamap(e):p.getStreetViewByPID(n,function(e){t.showPano({point:e.content.point,panoId:e.content.panoId,panoType:i,heading:a,pitch:s})},t))},getPanoShare3DImageUrl:function(){var e,t;e=""===this.heading?0:this.heading,t=""===this.pitch?0:this.pitch;var n=u.PANO_URL+"?qt=share",i=o.PanoInteract.getPanoramaPropertyFromFlash("id"),a={panoid:i,heading:e,pitch:t,fovy:65,width:460,height:250,watermark:"baidumap",quality:80};for(var s in a)n=n+"&"+s+"="+a[s];return n},revertFromAlamap:function(e){var t=this,n=e.puid,i=e.pword,a=(e.panoid,"alamap");baidu.ajax("/?qt=inf&ie=utf-8&uid="+n+"&t="+(new Date).getTime(),{dataType:"json",success:function(e){if(e&&e.content){{var s=e.content,r=s.addr;c.geoToPoint(s.geo)}p.getStreetViewByUid(n,function(e){if(0==e.error&&e.content){var s=e.content,h=parseFloat(s.PanoX),d=parseFloat(s.PanoY),p=new BMap.Point(h,d),c={addr:r,uid:n,index:-1,x:s.X,y:s.Y,pid:s.PID,px:h,py:d,name:s.name||"",rank:s.Rank||10,catalog:s.Catalog||"",heading:s.Dir,pitch:s.Pitch},l={point:p,panoId:s.PID,panoType:o.PANO_TYPE_STREET,heading:s.Dir,pitch:s.Pitch,from:a,poi:c};t.showPano(l,a,i),addStat(STAT_CODE.STAT_STREETVIEW,{item:o.PANO_TYPE_STREET,catalog:a,func:"alamap",query:i})}},t)}},error:function(){}})}};return l=baidu.lang.createSingle(l)}(window,map);n.exports=m});
;define("common:widget/pano/base/CatalogMap.js",function(){var a=["其他","正门","房型","设施","正门","餐饮设施","其他设施","正门","设施","观影厅","其他设施"],n=[0,1,2,2,2,2,2,2,2,3,3,3,3,4,5,5,5,6,6,7,8,8,8,9];return{getCatalogInfo:function(e){var o=n[1*e]||0;return{id:o,label:a[o]}}}});
;define("common:widget/pano/base/util.js",function(e,n,t){var r=e("common:widget/ui/config/config.js"),o=e("common:widget/ui/mapUtil/mapUtil.js"),a=r.modelConfig,i=function(){},u=/<[^>]*>|<\/[^>]*>/gm,c={trim:function(){return String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")}}(),converToArray:function(e){var n=c.each(e,function(e){return e},!0);return n},getUniqueId:function(){var e=1;return function(n,t){n?"number"==typeof n?(t=n,n="_$unique_id_"):"undefined"==typeof t&&(t=1):(t=1,n="_$unique_id_");var r=c.each(new Array(t||1),function(t,r){return n+(e+r)},!0);return e+=t||1,1===r.length?r[0]:r}}(),log:function(){return console?function(){console.log.apply(console,arguments)}:i}(),merge:function(){for(var e=c.converToArray(arguments),n={},t=0,r=e.length;r>t;t++){var o=e[t]||{};for(var a in o)o.hasOwnProperty(a)&&(n[a]=o[a])}return n},getRandom:function(){var e=0;return function(){return"_$rid"+e++}}(),each:function(e,n,t){var r,o,a=[],i=e.length;if(t){for(o=0;i>o&&(r=n.call(e,e[o],o,a),void 0!==r&&a.push(r),r!==!0);o++);return a}for(o=0;i>o&&n.call(e,e[o],o)!==!0;o++);return void 0},some:function(e,n){for(var t=0,r=e.length;r>t;t++)if(n(e[t],t)===!0)return!0;return!1},isIE:function(){return!1},setOpacity:function(e,n){e.style.opacity=n},showDetail:function(e,n,t,r,o,a,i,u){window.place.showDetail(e,n,t,r,o,a,i,u)},getSearchResultFromUrl:function(e){var n=new T.Deferred;return T.ajax(e,{dataType:"json",success:function(t){return t&&t.result?void n.resolve(t,e):void n.resolve(null)},error:function(){n.resolve(null)}}),n},getImage3DUrl:function(e,n,t,o,a,i){e=e||r.urlConfig.PANO_3DIMAGE_URL;var u="{baseURL}/?qt=pr3d&fovy=75&quality=80&panoid={panoId}&heading={panoHeading}&pitch={panoPitch}&width={width}&height={height}",c={baseURL:e,panoId:n,panoHeading:t||0,panoPitch:o||0,width:a,height:i};return u.replace(/\{(.*?)\}/g,function(e,n){return c[n]})},getBusLineInfoFromPCMap:function(e,n){function t(e,n,t){var o=0,a=null,i=1/0,u="";return c.each(e,function(e){a=r(e.geo),o=Math.pow(a.x-n,2)+Math.pow(a.y-t,2),i>o&&(i=o,u=e.uid)}),u}function r(e){var n=e.split("|")[2].split(";")[0],t=n.split(",");return{x:t[0],y:t[1]}}var o=window.componentManager.get("PoiSearch"),a="",i="";o&&o.curBslUid&&(a=t(currentComponent.curStops,e,n),i=o.curBslUid);var u=window.componentManager.get("LinesQuery");u&&u.curBslUid&&(a=t(currentComponent.curStops,e,n),i=u.curBslUid);var s=window.componentManager.get("BusLines");return s&&s.json&&s.json.content&&s.json.content[0]&&(a=t(currentComponent.json.content[0].stations,e,n),i=s.json.content[0].uid),i&&a?{buslineUid:i,closestBusStationUid:a}:null},getSearchResultFromPCMap:function(e){var n=window.componentManager.get("PoiSearch")||window.componentManager.get("SearchInView");if(!n)return null;var t=n.modelQuery,r=location.pathname,o=map.getBounds(),i="&l="+map.zoomLevel,u="";if(document.location.href.indexOf("format=1")>-1&&(u="&format=1"),t.indexOf("&l=")>-1&&(i=""),t=t.replace(/%3C/gi,encodeURIComponent(" ")).replace(/%3E/gi,encodeURIComponent(" "))+"&tn="+map.mapType,t.indexOf("&nn=")<0&&(t+="&nn=0"),t.indexOf("b=(")>-1)t=r+a.DATA_URL+t+u+"&ie=utf-8"+i+"&t="+(new Date).getTime();else{var c=Math.min(o.minX,o.maxX),s=Math.max(o.minX,o.maxX),l=Math.min(o.minY,o.maxY),p=Math.max(o.minY,o.maxY);t=r+a.DATA_URL+t+u+"&ie=utf-8"+i+"&b=("+c+","+l+";"+s+","+p+")&t="+(new Date).getTime()}var d=null;if(e){var f=null;for(var m in e)f=m+"="+e[m],t.indexOf(m+"=")>-1?(d=new RegExp(m+"=[^&]+","g"),t=t.replace(d,f)):t+="&"+f}var h=new T.Deferred;return T.ajax(t,{dataType:"json",success:function(e){return e&&e.result?(!e.content||2!=e.content[0].poiType&&4!=e.content[0].poiType||(e.busLineUid=e.content[0].uid),void h.resolve(e,t)):void h.resolve(null)},error:function(){h.resolve(null)}}),h},getCurrentCityByArea:function(e,n,t,r,o){var a=(new Date).getTime(),i=e+","+n+";"+t+","+r;baidu.ajax("/?newmap=1&qt=ncent&ie=utf-8&b="+i+"&l=16&t="+a,{dataType:"json",success:function(e){if(e&&e.content&&e.current_city){return void o(e)}},error:function(){}})},hasRouteVideo:function(){function e(){T.jsonp(t,function(e){if(e)for(var t=0,r=e.length;r>t;t++)if(o==e[t].cityCode)return void n.resolve(!0);n.resolve(!1)})}var n=new T.Deferred,t="/?newmap=1&qt=panoRouteVideo",r=window.currentComponent,o=a.cityCode;return r&&"NavTrans"==r.name?r.tpList.length>0?n.resolve(!1):r.sCity.code==r.eCity.code?e():this.getUpCity(r.sCity.cname,r.eCity.cname).then(function(t,r){t.upCityCode==r.upCityCode?e():n.resolve(!1)}):n.resolve(!1),n},getUpCity:function(){function e(e){var n=new T.Deferred,t="newmap=1&wd="+encodeURI(e);return baidu.ajax("/?qt=s",{method:"get",dataType:"json",data:t,success:function(e){var t=e?e.current_city:null;n.resolve(t)}}),n}for(var n=new T.Deferred,t=Array.prototype.slice,r=[],o=t.call(arguments),a=[],i=0,u=o.length;u>i;i++)a.push(e(o[i]));var c=T.when.apply(null,a);return c.then(function(){for(var e=t.call(arguments),o=0,a=e.length;a>o;o++){var i=e[o];r.push({upCityCode:i.up_cityid?i.up_cityid:i.code})}n.resolve.apply(null,r)}),n},getRouteVideoParamFromPCMap:function(e){var n=new T.Deferred;if("NavTrans"==currentComponent.name){for(var t=r.urlConfig.PANO_ROUTE_VIDEO_URL,o=r.urlConfig.PANO_VIDEO_SERVER_URL,a=r.urlConfig.PANO_3DIMAGE_URL,i=null,u=0,c=e.length;c>u;u++)if(e[u].src){i=e[u];break}var s=i?i.src.replace("?qt=pr3d","?qt=share").replace("&width=196&height=100",""):"",l=currentComponent.getPanoNavParams(),p={currentCity:l.currentCity,sc:l.sc,ec:l.ec,strategy:l.strategy,drag:-1,day:l.day,bound:l.bound,t:(new Date).getTime(),time_index:l.time_index,extinfo:l.extinfo,start:encodeURI(l.start),end:encodeURI(l.end),level:l.level,et:-1,st:-1,udt:"201400616",qt:"routeVideo"},d=new T.Deferred;if(p.sc!=p.ec){var f=currentComponent;this.getUpCity(f.sCity.cname,f.eCity.cname).then(function(e,n){p.sc=e.upCityCode,p.ec=n.upCityCode,d.resolve()})}else d.resolve();return d.then(function(){var e={imageUrl:s,videoParam:t+"/?"+T.url.jsonToQuery(p),playerUrl:"../swf/pano_whole/StreetscapePlayer_d23678a.swf"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/swf/pano_whole/StreetscapePlayer_d23678a.swf*/,offsetLeft:314,errorImageUrl:"../images/pano_whole/img_error_8d3eb72.png"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/pano_whole/img_error_8d3eb72.png*/,videoServerUrl:o+"/?qt=video",imageServerUrl:a+"?newmap=1&qt=pr3d"};n.resolve(e)}),n}},copy:function(e,n){var t=typeof e;if(t=t.toLowerCase(),T.isArray(e))return c.each(e,function(e){return c.copy(e,n)},!0);if(T.isObject(e)){var r,o={};for(var a in e)r=n?a.toLowerCase():a,o[r]=c.copy(e[a],n);return o}return e},bind:function(e,n){return function(){e.apply(n,arguments)}},clearTag:function(e){return e?e.replace(u,""):""},parse2Geo:function(e){return o.parse2Geo(e)},getPointFromGeoStr:function(e){var n=e.split("|");if("1"!==n[0])return null;var t=n[2].split(";")[0];return t=t.split(","),new BMap.Point(t[0],t[1])},getAngleFromP2P:function(e,n){var t=e,r=180*Math.atan(Math.abs((n.x-t.x)/(n.y-t.y)))/Math.PI;return n.x>=t.x&&n.y<=t.y&&(r=180-r),n.x<=t.x&&n.y<=t.y&&(r=180+r),n.x<=t.x&&n.y>=t.y&&(r=360-r),r},getDomSize:function(e){var n=e.parentNode,t=e.nextSibling,r=document.createElement("div");r.style.cssText="position:absolute;top:-9999px;left:-9999px",n.removeChild(e),r.appendChild(e),document.body.appendChild(r);var o=e.offsetWidth,a=e.offsetHeight;return r.removeChild(e),n.insertBefore(e,t),document.body.removeChild(r),{width:o,height:a}},parseUrlParam:function(e){if(e.indexOf("?")>-1)var n=e.slice(e.indexOf("?")+1);else{if(!(e.indexOf("#")>-1))return;var n=e.slice(e.indexOf("#")+1)}if(""!=n){for(var t={},r=n.split("&"),o=0;o<r.length;o++){var a=r[o].split("=");if(a[1]){var i=a[1].indexOf("#");a[1]=i>-1?a[1].slice(0,i):a[1],t[a[0]]=a[1]}}return t}},monitorReport:function(e,n,t,r,o,a){function i(e,n){var t="",r="";return e?n>2e3?(t="slow",r=3e3>n?"req_slow2":6e3>n?"req_slow3":"req_slow6"):(t="succ",r="succ"):(t="fail",r="con_fail"),{subtype:t,subvalue:r}}function u(e){var n=[];for(var t in e)n.push(t+"="+e[t]);n=n.join("&");var r="http://log.map.baidu.com/tn.gif?"+n,o=new Image;o.src=r}var c=i(n,t);"succ"==c.subtype&&(o=.01*o),Math.random()<o&&u({product:"Pano",module:"Pano_"+e,subtype:c.subtype,subvalue:c.subvalue,value:t,detail:encodeURIComponent(r),logid:a,represent:o>1?1:o,time:Math.floor(.001*(new Date).getTime())})},startClock:function(e,n){var t=this;window._pano_timer||(window._pano_timer={});var r=window._pano_timer;window.onbeforeunload=function(){t.stopClock(e)},r[e]||(r[e]={name:e,state:1,start:(new Date).getTime(),fn:n})},stopClock:function(e){var n=window._pano_timer;if(n&&n[e]){var t=n[e],r=t.fn;r&&r.call(t,Math.round(((new Date).getTime()-t.start)/1e3)),delete n[e]}},onHashChange:function(e){function n(){var e=location.href,t=e.slice(e.indexOf("#")+1);t!=o&&(o=t,_applyHashChangeHandler()),window._checkHashTimer=setTimeout(n,500)}if(window._hashChangeHandlers)e&&window._hashChangeHandlers.push(e);else{var t=window._hashChangeHandlers=[];if(e&&t.push(e),window._applyHashChangeHandler=function(){for(var e=0;e<t.length;e++)t[e].apply(null)},"addEventListener"in document.body)window.addEventListener("hashchange",window._applyHashChangeHandler);else{var r=location.href,o=r.slice(r.indexOf("#")+1);n()}}},offHashChange:function(){window._hashChangeHandlers=null,"removeEventListener"in document.body&&(window.removeEventListener("hashchange",window._applyHashChangeHandler),window._applyHashChangeHandler=null),window._checkHashTimer&&clearTimeout(window._checkHashTimer)},revertStreetView:function(e){var n="",t="";return e.pid?(t=e.pid,n=e.iid||""):"inter"===e.panotype?n=e.panoid:t=e.panoid,"alamap"===e.from&&addStat(STAT_CODE.STAT_PANORAMA,{item:e.panotype,catalog:"alamap",func:"alamap",query:e.pword}),{panoId:t,panoIId:n,panoType:e.panotype,panoHeading:e.heading,panoPitch:e.pitch,panoZoom:e.l,panoShareParam:e.psp,from:"share"}},getUgcUploadUrl:function(){return"http://pai.baidu.com/?from=pcmap"},isSupportVideo:function(){var e=navigator.appVersion;if(-1!==e.indexOf("MSIE 9.0"))return!1;try{var n=document.createElement("video");return n&&n.canPlayType?!0:!1}catch(t){return!1}}};!function(e){var n=document.body.filters;n&&(e.isIE=function(){return!0},e.setOpacity=function(e,n){e.style.filter="alpha(opacity="+parseInt(100*n)+")"})}(c),function(){var e=history.replaceState,n=navigator.userAgent.toLowerCase(),t=n.indexOf("lbbrowser")>-1;c.isSupportPushStatus=!e||t?function(){return!1}:function(){return!0}}(c),c.createTask=function(){var e=function(e){this._opts=c.merge({timeout:5e3},e),this._queue=[]};return e.prototype={add:function(e,n){return this._queue.push({fn:e,timeout:void 0===n?this._opts.timeout:n}),this},start:function(){for(var e,n,t=this._queue,r=0,o=t.length;o>r;r++)if(n=t[r],0===r){var a=n.fn.call(null);a&&"function"==typeof a.state&&"resolved"!==a.state(),e=baidu.when(a)}else e=e.then(function(e){return function(){var n=e.fn.call(null);return n&&"function"==typeof n.state&&"resolved"!==n.state(),n}}(n,r));return e}},e.prototype.constructor=e,function(n){return new e(n)}}(),t.exports=c});
;define("common:widget/pano/base/service.js",function(t,e,n){function a(t,e,n,a){if(e){var o=arguments.length;3==o&&(a=n,n=null);var r=new T.Deferred;e.t=(new Date).getTime();var i=[];for(var u in e)void 0!==e[u]&&i.push(u+"="+e[u]);i=i.join("&");var c=t+i,l=function(t){n&&n(t),r.resolve(t)};return baidu.jsonp(c,l,{cbtype:a?a:"fn"}),r}}var o=t("common:widget/ui/config/config.js"),r=t("common:widget/pano/base/util.js"),i=t("common:widget/pano/base/CatalogMap.js"),u=o.mapVersion,c=o.urlConfig,l=function(){var t=null,e=function(t){var e=t.getFullYear(),n=t.getMonth()+1,a=t.getDate();return n=10>n?"0"+n:n,a=10>a?"0"+a:a,[e,n,a].join("-")};return function(){if(!t){t={};var n=new Date,a=new Date;a.setDate(n.getDate()+2);var o=new Date;o.setDate(n.getDate()+3),t.start=e(a),t.end=e(o)}return t}}(),s=u.UDT_VERSION||"20140317",f=c.PANO_URL+"?udt="+s+"&",p=c.PANO_URL+"?qt=guide&",d="/?",g=c.PANO_PHPUI_URL+"/?",v="/detail?",h=c.PANO_URL+"?qt=search&",y={getPanoInfoByUid:function(t,e){var n=a(f,{qt:"poi",uid:t});return e?n.then(function(t){e(t)}):n},getPanoPoiInfoByUid:function(t,e){var n=new T.Deferred;return a(d,{qt:"inf",uid:t},"callback").then(function(t){e&&e(t),n.resolve(t)}),n},getHotelInfoByUid:function(t,e){var n=l(),o=a(v,{qt:"ota",st:n.start,et:n.end,uid:t},"callback");return e?o.then(function(t){e(t)}):o},getMovieInfoByUid:function(t,e){var n=a(v,{qt:"timetable",uid:t,from:"pc",sfrom:"map",sflag:"bubble"},"callback");return e?n.then(function(t){e(t)}):n},getIndoorPoiInfoByUid:function(t){var e=new T.Deferred,n=0;return function o(){a(g,{qt:"poidetail",uid:t,t:(new Date).getTime()}).then(function(t){n++,0==t.result.error_type||200==t.result.error_type?e.resolve(t):2>n?o():e.resolve(t)})}(),e},getGuideData:function(t,e){function n(t){var e=[],n=[],a=[],o=null,r=!1,u=0,c=t.length;for(u=0,c=t.length;c>u;u++)if(t[u].Catalog){r=!0,o={exit:[],other:[]};break}for(var u=0,c=t.length;c>u;u++){var l=t[u];if(7!=l.Type||isPhotoTourSupported){var s={photoUrl:null,name:l.Info,type:l.Type,catalog:l.Catalog,data:{tourId:l.TourID,floor:l.Floor,panoId:l.PID,panoHeading:l.Dir,panoPitch:l.Pitch,type:l.Type,panoX:l.PanoX,panoY:l.PanoY,x:l.X,y:l.Y,uid:l.UID,rank:l.Height}};if(r)if(3===s.type)o.exit.push(s);else{var f=i.getCatalogInfo(s.catalog);o[f.id]||(o[f.id]=[]),o[f.id].push(s)}0===l.Type?n.push(s):8===l.Type?a.push(s):e.push(s)}}return{panoAllumData:e,topicData:a,panoTimelineData:n,catalogData:o}}var a=p+"sid="+t;baidu.jsonp(a,function(t){var a={},o=!0;t&&0==t.result.error&&t.content&&(a=n(t.content),o=!1),e({content:a.panoAllumData,topicData:a.topicData,panoTimelineData:a.panoTimelineData,catalogData:a.catalogData,error:o})},{cbtype:"fn"})},getStreetBriefByLocation:function(t,e){if(t.point&&"function"==typeof e){var n=t.point||{},a=t.level||15,o=t.mode||"day",r=f+baidu.url.jsonToQuery({qt:"qsdata",x:n.lng||n.x,y:n.lat||n.y,l:a,action:0,mode:o,t:(new Date).getTime()});baidu.jsonp(r,function(t){if(t&&t.result&&0==t.result.error&&t.content){var n=t.content,a=n.id,o=parseFloat(n.x/100),r=parseFloat(n.y/100),i=new BMap.Point(o,r);e({type:"brief",content:{id:a,point:i},error:0})}else e({error:1})},{cbtype:"fn"})}},getNavSearch:function(t){return a(d,t,null,"callback")},getNavSteps:function(t){return a(g+"qt=routeSteps&",t,null,"callback").then(function(t){var e=t.content.traffic_steps,n=r.each(t.content.steps,function(t,n){var a={rx:t.RX/100,ry:t.RY/100,x:t.X/100,y:t.Y/100,dir:t.dir,pid:t.pid},o=e[n];o||(o={end:[1],status:1}),a.instructions=r.clearTag(t.instructions);var i=0,u=r.each(o.end,function(t,e){var n=Math.ceil(100*t);return i+n>100&&(n=100-i),i+=n,{value:n,status:o.status[e]}},!0);return 100>i&&(u[u.length-1].value+=100-i),a.traffic=u,a},!0);return n[0].pid||(n=n.slice(1)),t.content.steps=n,delete t.content.traffic_steps,t})},getClassifySearchData:function(t,e,n,o){function i(t,e){if(!t||0===t.content.length)return null;var n=t.content;return r.each(n,function(t){return{poiuid:t.UID,pid:t.PID,panoIId:t.IID,poiType:"poi",catalog:e,name:t.name,rank:t.Height,heading:t.Dir,pitch:t.Pitch,x:t.X,y:t.Y,px:t.PanoX,py:t.PanoY,index:-1}},!0)}var u={0:"",1:"FE02",2:"FE01",3:"FE06",4:"FE0A",5:"FEFE"},c=a(h,{x:t,y:e,radius:200,tag:n},"fn");return o?c.then(function(t){t=i(t,u[n]),o(t)}):c},getComponentResultByQuery:function(t){var e="/?qt="+t,n=new T.Deferred;return T.ajax(e,{dataType:"json",success:function(t){return t&&t.result?void n.resolve(t,e):void n.resolve(null)},error:function(){n.resolve(null)}}),n},getPanoPoints:function(t,e){var n=t.join("|");e=e||"bus";var a="udt="+s+"&qt=batchdata&from="+e+"&key="+n,o=new T.Deferred;return baidu.ajax("/?qt=panobatch",{method:"post",dataType:"json",data:a,success:function(t){o.resolve(t)}}),o},getBuslineByUid:function(t,e){var n=a(d,{qt:"bsl",bsltp:"1",newmap:"1",uid:t,c:e,t:(new Date).getTime()},null,"callback"),o=this;return n.then(function(t){var e=t.content[0].stations,n=t.content[0].name,a=[],i="",u=null,c="";0==t.result.linetype||6==t.result.linetype?c="010A05":1==t.result.linetype&&(c="010A03");for(var l=0,s=e.length;s>l;l++)i=e[l].geo,i=i.split("|")[2].split(";")[0],a.push(i),u=i.split(","),e[l].point={x:u[0],y:u[1]};return o.getPanoPoints(a,"busline").then(function(t){return r.each(a,function(n,a){t.content[a]&&(e[a].pano=t.content[a])}),{buslineName:n,stations:e,catalog:c}})})},getPanoCityPageData:function(t){return a(d,{qt:"panoReco",code:t,t:(new Date).getTime()},null,"callback")},getSdataByPid:function(){var t={};return function(e){var n=new T.Deferred;return t[e]?n.resolve(t[e]):a(f,{qt:"sdata",pc:1,sid:e},null,"fn").then(function(a){a&&a.result||n.resolve(null);var o=a.content[0]||a.content,i=r.copy(o,!0);t[e]=i,n.resolve(i)}),n}}(),getIndoorData:function(t){var e=new T.Deferred;return a(f,{qt:"idata",iid:t},null,"fn").then(function(t){if(!t||!t.result)return null;var n=(t.content[0]||t.content).interinfo,a=r.copy(n,!0);e.resolve(a)}),e},getActivityPano:function(){return a(d,{qt:"panoActivity"},null,"callback")},getCopyRightData:function(){return a(d,{qt:"panoCMS",file:"pano_copyright"},null,"callback")},getTourGuideData:function(t){var e=new T.Deferred;if("d270a38b230b50fced74f8f7"==t)var n={Paths:[{tourId:"1",tourName:"太和殿",tourImage:"../../../../panofeedback/panoPhotoTour/1/scene.jpg"/*tpa=http://webmap0.map.bdstatic.com/panofeedback/panoPhotoTour/1/scene.jpg*/,X:12958111,Y:4826928},{tourId:"2",tourName:"御花园",tourImage:"../../../../panofeedback/panoPhotoTour/2/scene.jpg"/*tpa=http://webmap0.map.bdstatic.com/panofeedback/panoPhotoTour/2/scene.jpg*/,X:12958111,Y:4826928},{tourId:"3",tourName:"狮子",tourImage:"../../../../panofeedback/panoPhotoTour/3/scene.jpg"/*tpa=http://webmap0.map.bdstatic.com/panofeedback/panoPhotoTour/3/scene.jpg*/,X:12958111,Y:4826928}],defaultId:"1",name:"北京故宫 "};return e.resolve(n),e}};n.exports=y});
;define("common:widget/ui/PanoService/PanoService.js",function(t,e,n){var o=t("common:widget/ui/config/config.js"),r=o.mapVersion,i=o.urlConfig,a=function(){var t=r.UDT_VERSION||"20130819",e=i.PANO_URL+"?udt="+t+"&",n={getStreetViewByUid:function(t,n,o){if(t&&"function"==typeof n){o=o||window;var r=e+baidu.url.jsonToQuery({qt:"poi",uid:t,t:(new Date).getTime()});baidu.jsonp(r,function(t){if(t&&t.result&&0==t.result.error&&t.content&&t.content.length>0){var e=t.content[0];n.call(o,{content:e.poiinfo,error:0})}else n.call(o,{error:1})},{cbtype:"fn"})}},getStreetBriefByLocationMove:function(t,n,o){if(t.point&&"function"==typeof n){o=o||window;var r=t.point||{},i=t.level||15,a=t.mode||"day",c=e+baidu.url.jsonToQuery({qt:"qsdata",x:r.lng||r.x,y:r.lat||r.y,l:i,action:0,time:a,t:(new Date).getTime()});baidu.jsonp(c,function(r){if(r&&r.result&&0==r.result.error&&r.content){var i=r.content,a=i.id,c=parseFloat(i.x/100),l=parseFloat(i.y/100),u=new BMap.Point(c,l),f=e+baidu.url.jsonToQuery({qt:"pdata",sid:a,pos:"0_0",z:"0"});n.call(o,{type:"brief",content:{id:a,rname:i.RoadName||"",panoImg:f,point:u},error:0,from:t.from||""})}else n.call(o,{error:1})},{cbtype:"fn"})}},getStreetBriefByLocation:function(t,n,o){if(t.point&&"function"==typeof n){o=o||window;var r=t.point||{},i=t.level||15,a=t.mode||"day",c=e+baidu.url.jsonToQuery({qt:"qsdata",x:r.lng||r.x,y:r.lat||r.y,l:i,action:0,time:a,t:(new Date).getTime()});baidu.jsonp(c,function(e){if(e&&e.result&&0==e.result.error&&e.content){var r=e.content,i=r.id,a=parseFloat(r.x/100),c=parseFloat(r.y/100),l=new BMap.Point(a,c);n.call(o,{type:"brief",content:{id:i,point:l},error:0,from:t.from||""})}else n.call(o,{error:1})},{cbtype:"fn"})}},getStreetViewByPID:function(t,n,o){if("function"==typeof n){o=o||window;var r=e+baidu.url.jsonToQuery({qt:"sdata",sid:t,t:(new Date).getTime()});baidu.jsonp(r,function(t){if(t&&0==t.result.error&&t.content&&t.content.length>0){var e=t.content[0],r=e.ID,i=parseFloat(e.X/100),a=parseFloat(e.Y/100),c=new BMap.Point(i,a);"inter"==e.Type&&(r=e.Inters[0].IID),n.call(o,{content:{panoId:r,point:c},error:0})}else n.call(o,{error:1})},{cbtype:"fn"})}},checkBounds:function(t,n,o){if("function"==typeof n){o=o||window,t=t||map.getBounds();var r=e+baidu.url.jsonToQuery({qt:"qmdata",bx:t.getMinX(),by:t.getMinY(),tx:t.getMaxX(),ty:t.getMaxY(),t:(new Date).getTime()});baidu.jsonp(r,function(t){if(t&&0==t.result.error&&t.content){var e=t.content.ptcnt||0;n.call(o,{content:{ptcnt:e},error:0})}else n.call(o,{error:1})},{cbtype:"fn"})}}};return n}();n.exports=a});
;define("common:widget/pano/PanoInterface/PanoInterface.js",function(n,o,t){var e,r,a=n("common:widget/pano/Transition/Transition.js"),i=!1,u=function(){var n=!1,o=0,t=null;if(window.ActiveXObject){if(t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")){n=!0;var e=t.GetVariable("$version");o=e.match(/[\d\.]+/)}}else navigator.plugins&&navigator.plugins.length>0&&(t=navigator.plugins["Shockwave Flash"],t&&(n=!0,o=t.description.match(/[\d\.]+/)));return o=1*o[0],u=n?function(){return o}:function(){return!1},n?o:!1},c=function(){var n,o=document.createElement("canvas"),t=!0;try{n=o.getContext("experimental-webgl")||o.getContext("webgl")}catch(e){}return n||(t=!1),o=null,n=null,t};c()?addStat(STAT_CODE.STAT_PANORAMA,{item:"pano_render_webgl"}):addStat(STAT_CODE.STAT_PANORAMA,{item:"pano_render_flash"}),t.exports={showPano:function(){var o=u();if(!o||10>=o)return void alert("您的电脑尚未安装 Flash 或版本过低，请升级！");var t={},c=arguments,s=c[0];i!==!0&&(i=!0,a.checkSupport(s.from),function(){var o=new T.Deferred;return e?o.resolve():n.async(["common:widget/pano/base/service.js","common:widget/pano/Root.js"],function(n,t){e=t,r=n,o.resolve()}),o}().then(function(){return s.research===!0?r.getPanoInfoByUid(s.searchParam.uid):s.panoIId?r.getIndoorData(s.panoIId):s.panoId?r.getSdataByPid(s.panoId):t}).then(function(n){return n!==t&&n?n.content?(n=n.content[0].poiinfo,{x:n.X,y:n.Y,dir:n.Dir}):n.x&&n.y?{x:n.x/100,y:n.y/100,dir:n.heading}:n.iid?{x:n.ipoint.x/100,y:n.ipoint.y/100,dir:0}:t:t}).then(function(n){var o=n.x,r=n.y,u=n.dir;if(i=!1,n===t||!o||!r)return void e.showPano.apply(e,c);var s=new BMap.Point(o,r),p=u||0;a.enter(null,null,s,p,function(){e.showPano.apply(e,c)})}))},showPhotoTour:function(o,t){window.isPhotoTourSupported&&n.async("common:widget/pano/PhotoTour/PhotoTourMain.js",function(n){new n(o,t)})},closePano:function(){e&&e.closePano.apply(e,arguments)}},window.isPhotoTourSupported=function(n){var o=[];window.Worker||o.push("not support WebWorker"),window.Float32Array||o.push("not support FLoat32Array"),!window.URL&&window.webkitURL&&o.push("not support URL"),window.Blob||o.push("not support Blob"),window.Promise||o.push("not support Promise");try{var t=c();if(!t)throw"Error creating WebGL context."}catch(e){o.push("not support webgl")}return n&&console.log(o),o.length>0?!1:!0}()});
;define("common:widget/pano/Transition/Util.js",function(){var e=navigator.userAgent.toLowerCase(),t={mapPosToScreenPos:function(e,t){var r=(document.body.clientWidth,document.body.clientHeight,T("#MapHolder").offset()),n={x:e+r.left,y:t+r.top};return n},screenPosToMapPos:function(e,t){var r=(document.body.clientWidth,document.body.clientHeight,T("#MapHolder").offset()),n={x:e-r.left,y:t-r.top};return n},easeIn:function(e){return Math.pow(e,2)},easeOut:function(e){return Math.pow(e,.5)},easeFrom:function(e){return Math.pow(e,4)},easeTo:function(e){return Math.pow(e,.25)},returnTrue:function(){return!0},returnFalse:function(){return!1},isSupportCanvas:function(){var e=!1;try{var t=document.createElement("canvas"),r=t.getContext("2d");e=r&&r.drawImage?!0:!1}catch(n){e=!1}return this.isSupportCanvas=e?this.returnTrue:this.returnFalse,e},isSupportTransform3d:function(){var e=!1;try{var t=document,r=t.body,n=t.createElement("div");n.className="test_css3d";var o=t.createElement("style");o.innerHTML="@media (transform-3d),(-webkit-transform-3d){.test_css3d{position:absolute;height:3px;width:3px}}",r.appendChild(o),r.appendChild(n),e=3===n.clientHeight?!0:!1,r.removeChild(o),r.removeChild(n)}catch(i){e=!1}return this.isSupportTransform3d=e?this.returnTrue:this.returnFalse,e},isSougouBrowser:function(){var t=e.indexOf("se 2.x")>-1?!0:!1;return this.isSougouBrowser=t?this.returnTrue:this.returnFalse,t},isSafariBrowser:function(){var t=e.indexOf("macintosh")>-1?!0:!1,r=e.indexOf("chrome")>-1?!0:!1,n=t&&!r;return this.isMacSafariBrowser=n?this.returnTrue:this.returnFalse,n}};return t});
;define("common:widget/pano/Transition/Transition.js",function(n){var o=n("common:widget/pano/Transition/Util.js"),t=null,i=null,a=!0,e={checkSupport:function(n){a=o.isSupportCanvas()&&o.isSupportTransform3d()&&"share"!==n?!0:!1},enter:function(i,r,c,s,u){a?(this.onPlayStart=u,n.async(["common:widget/pano/Transition/MapLayer/EnterLayer.js"],function(n){var u=void 0;if(c){c instanceof BMap.Point||!c.lat||!c.lng||(c=new BMap.Point(c.lng,c.lat));var l=window.map.pointToPixel(c);u=o.mapPosToScreenPos(l.x,l.y)}t=new n(i,c,r,u,s,function(n){n===!0&&(a=!1),e.onPlayStart()},function(){e.onPlayEnd()})})):u()},exit:function(t,r,c,s,u){return a?void n.async(["common:widget/pano/Transition/MapLayer/ExitLayer.js"],function(n){var a=window.map,l=o.mapPosToScreenPos(a.width/2,a.height/2);i=new n(t,c,r,l,s,function(){e.close()}),u()}):void u()},onShow:function(n){a?this.onPlayEnd=n:n()},close:function(){a&&(t&&(t.fadeOut(),t=null),i&&(i.fadeOut(),i=null))},onPlayStart:function(){},onPlayEnd:function(){}};return e});
;define("common:widget/ui/SyncMgr/SyncMgr.js",function(t,o,a){var e=t("common:widget/ui/constant/Constant.js"),n=t("common:widget/ui/util/util.js"),i=t("common:widget/ui/userMgr/userMgr.js"),r=t("common:widget/ui/config/config.js"),c=r.modelConfig,s=(r.mapConfig,"/user"),d="/upload",l="/download",u="webmap",p=7,f=0,v={0:{ck:3,txt:"(较快捷)"},4:{ck:6,lk:2,txt:"(不坐地铁)"},2:{ck:4,txt:"(少换乘)"},3:{ck:5,lk:0,txt:"(少步行)"},5:{lk:3},6:{lk:4},t:"公交："},h={0:{ck:0,lk:0,txt:"(最少时间)"},1:{ck:1,lk:1,txt:"(最短路程)"},2:{ck:2,lk:2,txt:"(不走高速)"},t:"自驾："},g={},w={data:null,timer:null,local_data_version:null,server_data_version:null,SORT_TYPE:1,favCloudData:[],pk_dict:{0:h,5:h,1:v,6:v,7:v,2:{t:"步行："},9:{0:{ck:3,txt:"(较快捷)"},1:{ck:7,txt:"(出发较早)"},2:{ck:8,txt:"(到达较早)"},3:{lk:0},7:{lk:1},8:{lk:2},t:"公交："}},init:function(){var t=this;t.download(function(o){t.favCloudData=t.processCloudData(o.content.data),t.showAllPoi()})},processCloudData:function(t){for(var o=[],a=0,e=t.length;e>a;a++)t[a].data&&3!==t[a].data.pathtype&&o.push(t[a]);return o},getData:function(t){if(!t)return this.favCloudData.concat();for(var o=[],a=0;a<this.favCloudData.length;a++)t==this.favCloudData[a].type&&o.push(this.favCloudData[a]);return o},showAllPoi:function(t){t=t||w.favCloudData;for(var o,a=null,e=null,n=null,i=0,r=t.length;r>i;i++)a=t[i],o=parseInt(a.type,10),e=w.converToOriginal(a.data),e&&e.point&&(n=w.createMark(e,{from:"fav"}),g[a.id]=n)},createMark:function(t,o){o=o||{};var a=this,e=t.point.split("|"),n=new BMap.Point(e[0],e[1]),i=t.title,r=new BMap.Marker(n,{enableMassClear:!1,title:i});r.setTop(!0,27e7);var c=new BMap.Icon("../../../../../webmap2.map.bdstatic.com/newmap/static/common/images/fav-icon-map_51dcdc8.png"/*tpa=http://webmap2.map.bdstatic.com/newmap/static/common/images/fav-icon-map_51dcdc8.png*/,new BMap.Size(14,14),{infoWindowOffset:new BMap.Size(7,0)});return r.setIcon(c),r.addEventListener("click",function(){a.openInfoWnd(this,{data:t})}),map.addOverlay(r),r},openInfoWnd:function(t,o){o=o||{};var a=this,e=o.data,i=t.getPoint(),r={fav:1,title:e.title||"",content:e.content||"",uid:e.uid||""};if(e.uid){var c="/?qt=inf&uid="+e.uid+"&ie=utf-8&t="+(new Date).getTime();baidu.ajax(c,{dataType:"json",success:function(n){n&&n.content&&a.getInfoData(n,r,i,e,t,o)},error:function(){}})}else r.userSign=1,n.loadSearchInfo(function(a){var n=a.createSearchInfoWnd(r,{x:i.lng,y:i.lat,cityCode:e.cityCode});a.openSearchInfoWndPOI(n,t,o)})},getInfoData:function(t,o,a,i,r,c){var s=t.content,d=s.addr,l=s.tel,u=s.detail&&s.ty==e.GEO_TYPE_POINT||s.poiType==e.POI_TYPE_BUSLINE||s.poiType==e.POI_TYPE_SUBLINE;(s.poiType==e.POI_TYPE_BUSSTOP||s.poiType==e.POI_TYPE_SUBSTOP)&&(d=T.array.unique(d.split(";")).join("; ")),l&&(l=l.replace(/,/g,", ")),n.loadSearchInfo(function(t){var e=t.createSearchInfoWnd(T.object.extend(o,{addr:d,tel:l,hasDetail:u,detail:s.detail,ext_type:s.ext_type,uid:s.uid,poiType:s.poiType,ext:s.ext,cp:s.cp,cla:s.cla,catId:s.new_catalog_id||""}),{x:a.lng,y:a.lat,cityCode:i.cityCode});t.openSearchInfoWndPOI(e,r,c)})},checkInFav:function(t){if(t&&"share"==t.from){for(var o=t.json,a=0;a<this.favCloudData.length;a++){var e=this.converToOriginal(this.favCloudData[a].data);if(e.point==o.point&&e.title==o.title&&e.content==_sign.deCodeShare(o.content))return a}return-1}if(t&&("poi"==t.from||"nomal"==t.from)){var o=t.json;o.content&&(o.content=o.content.replace(/&nbsp;/g," "));for(var a=0;a<this.favCloudData.length;a++){var e=this.converToOriginal(this.favCloudData[a].data);if(e.point==o.point&&e.title==o.title&&e.content==o.content)return a;if(e.uid&&e.uid===o.uid)return a}return-1}},download:function(t,o){o=o||{};var a={plateform:u,local_data_version:"0",type:"",sync_data_version:"",page_index:"",page_size:"",collection:""},e=T.object.extend(a,o),i=s+l+"?"+n.jsonToQuery(e);this._get(i,t)},upload:function(t,o){if(t){"[object Object]"==Object.prototype.toString.call(t)&&(t=[].concat(t));for(var a=0,e=t.length;e>a;a++)2==t[a].action&&delete t[a].data;var n={plateform:u,post_data:this.formatData(t)},i=s+d;this._post(i,n,o)}},converToGe:function(t){if(!t)return"";var o={};if(o.name=t.title||"",o.content=(t.content||"").replace(/&nbsp;/g," "),o.geoptx=12957320,o.geopty=4825100,t.point){var a=t.point.split("|");o.geoptx=parseFloat(a[0],10),o.geopty=parseFloat(a[1],10)}return o.cityid=parseInt(t.cityCode||c.cityCode,10),o.poistyle=parseInt(t.cur||13,10),o.uid=t.uid||"",o.poitype=parseInt(t.poitype||0,10),o.panoGuid=t.panoGuid||"",o},converToOriginal:function(t){if(!t)return null;var o={};return o.title=t.name||"",o.content=(t.content||"").replace(/&nbsp;/g," "),o.point=t.geoptx&&t.geopty?t.geoptx+"|"+t.geopty:null,o.cityCode=t.cityid||"",o.cur=t.poistyle||13,o.uid=t.uid||"",o.poitype=t.poitype||"",o.panoGuid=t.panoGuid||"",o},formatData:function(t){if(t){for(var o=0,a=["["],e=t.length;e>o;o++){var n=T.json.stringify(t[o]);e>o+1&&(n+=","),a.push(n)}return a.push("]"),'{"data":'+a.join("")+"}"}},showError:function(t,o,a){if(1==arguments.length)return void this.showTipInfo(t);if(/\/upload/.test(t)){if(a&&a.json&&a.json.content&&a.json.content.data)for(var e=a.json.content.data,n=0,i=e.length;i>n;n++)if(e[n].status==p)return void this.showTipInfo("已达收藏数量上限");switch(o){case p:this.showTipInfo("已达收藏数量上限");break;default:return void this.showTipInfo("操作失败")}}},showTipInfo:function(t,o,a,e){var a=a||"favBtn",o=o||"J_favInfo",e=e||"",i="",r=this,c=function(){T.rc(T.G(o),"hide"),r.favTime=setTimeout(function(){T.ac(T.G(o),"hide")},2e3)};T.g(o)?(T.g(o).innerHTML='<div class="jct"><div class="j"></div></div><div class="jext">'+t+"</div>",T.g(o).className=e,c()):(6==T.browser.ie&&(n.beforeEndHTML(T.G(a),'<div id="'+o+'_width" style="position:absolute;top:-1000px;"><div class="jct"><div class="j"></div></div><div class="jext">'+t+"</div></div>"),i='style="width:'+T.g(o+"_width").clientWidth+'px"'),n.beforeEndHTML(T.G(a),'<div id="'+o+'" class="'+e+'" '+i+'><div class="jct"><div class="j"></div></div><div class="jext">'+t+"</div></div>"),c())},_get:function(t,o){var a=this,e=(new Date).getTime(),t=t+"&v="+e;T.ajax(t,{dataType:"json",success:function(e,n){return e?(n.slow&&ErrorMonitor("fav","req_slow"+n.slow,"get",void 0,{xhr:n,type:"slow",url:t}),e&&!n.slow&&ErrorMonitor("fav","succ","",void 0,{xhr:n,type:"succ",url:t}),void(e&&e.status==f?o&&o(e):a.showError(t,e.status))):(ErrorMonitor("fav","res_null","get",void 0,{xhr:n,type:"fail",url:t}),void a.showError("数据错误"))},error:function(o){ErrorMonitor("fav","req_fail","get",void 0,{xhr:o,type:"fail",url:t}),a.showError("连接服务失败")}}),ErrorMonitor("fav","BASE")},_post:function(t,o,a){var e=this;baidu.ajax(t,{dataType:"json",method:"post",data:n.jsonToQuery(o),success:function(o,n){if(o=o||{},o.status==f)try{a&&a(o)}catch(i){ErrorMonitor("fav","res_error",t,void 0,{xhr:n,url:t,type:"fail"}),e.showError("执行错误")}else e.showError(t,o.status,{json:o})},error:function(o){ErrorMonitor("fav","res_error",t,void 0,{xhr:o,url:t,type:"fail"}),e.showError("连接服务失败")}})},goFav:function(t){this.checkFav(this.goFavFun,this,t)},goFavFun:function(t){var o,a=this,e=0,n=function(){var t="已从收藏夹中删除",n=o&&T.g("poifav_"+o);if(!e){n&&(T.ac(n,"poi-fav-selected"),n.title="取消收藏");var i=T.G("JiwFav");i&&(T.rc(i,"fav"),T.ac(i,"has_fav"),i.title="取消收藏"),t="成功添加到收藏夹"}a.showTipInfo(t)};if(t){o=t.uid;var i={fav:1,cityCode:t.cityCode,content:t.content,point:t.point,title:t.title,cur:t.cur,uid:t.uid,panoGuid:t.panoGuid||""},r=a.checkInFav({from:"poi",json:i});-1==r?a.addFav(i,n,this):(e=1,a.deleteFavByIndex(r,n,this))}},deleteFavByIndex:function(t,o,a){var e=this,n="",i=e.favCloudData[t],r=i.id,c=Array.prototype.slice.call(arguments,3);r&&(n=i.data.uid,i.action=2,e.upload(i,function(){var i=T.G("JiwFav");i&&(T.rc(i,"has_fav"),T.ac(i,"fav"),i.title="加入收藏夹");var s=n&&T.g("poifav_"+n);s&&(T.rc(s,"poi-fav-selected"),s.title="加入收藏夹"),e.favCloudData.splice(t,1),window.FavInst&&window.FavInst.goPage(window.FavInst.currentPageIndex),g[r]&&map.removeOverlay(g[r]),o&&o.apply(a,c)}))},addFav:function(t,o,a){var e=this,t=this.converToGe(t),n={action:0,data:t,type:0},i=Array.prototype.slice.call(arguments,3);addStat("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/oldfav.poi.add","click"),this.upload(n,function(t){n.id=t.content.data[0].id,e.favCloudData.unshift(n),window.FavInst&&window.FavInst.goPage(),o&&o.apply(a,i)})},checkFav:function(t,o){function a(){1==i.userState.isOnline?t&&t.apply(o||window,n):0==i.userState.isOnline&&(i.login(),window.FavInst&&window.FavInst.showDefText())}var e=this,n=Array.prototype.slice.call(arguments,2);e.checkFavTimer&&window.clearInterval(e.checkFavTimer),i.userState?a():e.checkFavTimer=window.setInterval(function(){i.userState&&(a(),window.clearInterval(e.checkFavTimer))},100)}};window.SyncMgr=w,a.exports=w});
;define("common:widget/ui/userMgr/userMgr.js",function(e,i,t){function a(e){var i=e.split("@");return i[0].length<3?e:(i[0]=i[0].charAt(0)+i[0].charAt(1)+"****"+i[0].charAt(i[0].length-1),i[0]+"@"+i[1])}function s(e){return e.substr(0,3)+"*****"+e.substr(e.length-3)}function n(e){if(!e)return"";var i="",t=e.uName,n=e.email,o=e.mobile;e.incomplete&&(t=e.displayname),t?i=t:n?i=a(n):o&&(i=s(o)),"thirdappid"in e&&!e.uName&&!e.email&&!e.mobile&&(i='<img src="http://passport.bdimg.com/passApi/img/icon_'+e.thirdappid+'_16.png" style="vertical-align:middle;padding-right:2px">'+i);var l=['<ul><li id="usernameInfo" style="height:22px;" class="uname mn-lk-w">'];return l.push(e.uName?'<a id="username" class="mn-lk" target="_blank" href="../../../../../map.baidu.com/ugc/user/index.htm"/*tpa=http://map.baidu.com/ugc/user/index*/>'+i+"<em></em></a>":'<a id="username" class="mn-lk" href="https://passport.baidu.com/v2/?ucenteradduname">'+i+"<em></em></a>"),l.push('<div id="popUserInfoId" style="width:80px;right:0;visibility:hidden;" class="mn-tip"><ul class="mn"><li>'),l.push(e.uName?'<a class="my-info" target="_blank" href="../../../../../map.baidu.com/ugc/user/index.htm"/*tpa=http://map.baidu.com/ugc/user/index*/>我的主页</a>':'<a class="my-info" href="https://passport.baidu.com/v2/?ucenteradduname">我的主页</a>'),l.push('</li><li><a class="my-info" href="'+p+'">帐号设置</a></li><li><a class="logout" href="javascript:void(0)">退出</a></li></ul></div>'),l.push('<li class="line">|</li>'),l.push('<li class="book-order"><a class="action" href="javascript:void(0);" >&nbsp;订单查询<em></em></a></li>'),l.push('<li class="line">|</li>'),l.push('<li><a href="http://nlbc.baidu.com/lbs-lbc/?from=maptop" target="_blank" class="lbc_txt">商户免费标注</a><a href="http://developer.baidu.com/map/" target="_blank" >地图API</a></li>'),l.push('<li class="line">|</li>'),l.push('<li><a href="http://www.baidu.com/"  target="_blank" >百度首页</a></li>'),l.join("")}function o(){v?v.show():r.getLink(function(e){baidu.sio(u+"passApi/js/uni_login_wrapper.js?cdnversion="+(new Date).getTime()).callByBrowser(function(){baidu.g("passport-login-pop")||(v=passport.pop.init({apiOpt:{staticPage:m,product:"ma",charset:"utf-8",u:e||location.href,memberPass:!0,safeFlag:0},cache:!1,authsite:b,authsiteCfg:{act:"implicit",u:e||location.href},tangram:!0}),v.show())})})}function l(e,i){var t=_++;e.innerHTML='<ul class="login-tab">                 <li class="tab-item tab-item-left tab-selected">                     <a href="#" onclick="return false;" hidefocus="true">普通登录</a>                 </li>                 <li class="tab-item tab-item-right">                     <a href="#" onclick="return false;" hidefocus="true">手机登录</a>                 </li>            </ul>            <div id="ss_pass_login_form'+t+'" class="tang-pass-loginPanel"></div>            <div id="otherLogin'+t+'" class="pass-phoenix-list" style="margin-left:55px;"></div>            <div class="nopass">没有百度帐号？<a href="https://passport.baidu.com/v2/?reg&regType=1&tpl=ma" target="_blank">立即注册</a></div>',baidu.sio(u+"phoenix/account/jsapi?a="+(new Date).getTime()).callByBrowser(function(){baidu.phoenix.require(b,{target:"otherLogin"+t,tpl:"map",act:"implicit",html:{tsina:"新浪微博",renren:"人人网",qzone:"qq号",tqq:"腾讯微博"},u:i||location.href})}),baidu.sio(u+"passApi/js/wrapper.js?cdnversion="+(new Date).getTime()).callByBrowser(function(){function e(e,i){i.children("li").each(function(t){baidu(this).click(function(a){a.preventDefault(),i.children("li").removeClass("tab-selected"),baidu(this).addClass("tab-selected"),e.switchTo(["normal","phone"][t])})})}passport.use("login",{tangram:!1},function(a){var s=new a.passport.login({product:"map",staticPage:m,u:i||location.href,charset:"",memberPass:!0,safeFlag:0});s.on("loginSuccess",function(){top.location.reload()}),baidu("#ss_pass_login_form"+t).html(""),s.render("ss_pass_login_form"+t),e(s,baidu("#ss_pass_login_form"+t).prevAll("ul.login-tab"))})})}var r=e("common:widget/ui/mapShare/MapShare.js"),u="https://passport.baidu.com/",c="../../../../../map.baidu.com/-qt=ssn"/*tpa=http://map.baidu.com/?qt=ssn*/,p="http://passport.baidu.com/?center&tpl=ma&aid=7&default_tab=4",d="&tpl=ma",m="http://"+location.host+"/v3Jump.html",h="1",f="0",g=['<ul class="order-list">','<li><a target="_blank" class="order-list-movie" href="http://webmap0.map.bdstatic.com/detail?qt=orderlist&type=movie">电影订单</a></li>',"</ul>"].join("");if(6==T.browser.ie||7==T.browser.ie)var b=["tsina","renren","tqq"];else var b=["qzone","tsina","renren","tqq"];var v,_=0,w={loginStatus:!1,init:function(e){this.update({onsuccess:function(){e&&e()}}),this.generateOrder()},generateOrder:function(){var e;baidu.dom("#user_info").delegate(".book-order","mouseenter",function(){var i=baidu(this).find(".order-list");e&&clearTimeout(e),0==i.length&&(i=baidu(this).append(baidu(g))),i.show()}).delegate(".book-order","mouseleave",function(){var i=baidu(this).find(".order-list");i.length>0&&(e=setTimeout(function(){i.hide()},50))}).delegate(".order-list-hotel","click",function(){var e=w.userState&&w.userState.isOnline||"0";window.addStat(1,{da_src:"inf.order_hotel",from:"map",user:e})})},getState:function(e){T.jsonp(c,function(i){i&&e(i)})},login:function(e,i){e?l(e,i):o()},logout:function(){r.getLink(function(e){window.location.href=u+"?logout"+d+"&u="+encodeURIComponent(e)})},update:function(e){e=e||{};var i=this,t=(T.g("login"),T.g("logout_user_info")),a=T.g("login_user_info");T("#login").on("click",function(e){e=window.event||e,baidu.event.preventDefault(e),i.login(),e.returnValue=!1}),i.loginStatus=!1,this.getState(function(s){function o(){i.tipTimer=setTimeout(function(){T.g("popUserInfoId").style.visibility="hidden"},200)}switch(i.userState=s,s.isOnline){case h:t.style.display="none",a.style.display="inline",a.innerHTML=n(s),T.g("username").onmouseover=function(){T.g("popUserInfoId").style.visibility="visible"},T.g("username").onmouseout=o,T.g("popUserInfoId").onmouseover=function(){window.clearTimeout(i.tipTimer)},T.g("popUserInfoId").onmouseout=o,baidu("#popUserInfoId a.logout").one("click",function(e){i.logout(),e.preventDefault()}),e&&e.onsuccess&&e.onsuccess(s),i.loginStatus=!0;break;case f:t.style.display="block",a.style.display="none"}})}};t.exports=w});
;define("common:widget/ui/signMgr/signMgr.js",function(e,n,a){function o(){var n=arguments;window.MapSignInst?o.fun(n):e.async(["common:widget/com/MapSign/MapSign.js","common:widget/ui/searchInfoWindow/searchInfoWindow.js"],function(e,a){new e({cinfo:{arg:n,searchInfoWindow:a}})})}var t=e("common:widget/com/componentManager.js"),r=e("common:widget/ui/mapShare/MapShare.js"),i=function(e){var n=T.g("shareInupt"),a=T.g("cpShareCon");e&&e.url&&(s=!0,a.style.display="inline",n.value=e.url,n.focus(),n.select(),window._iwUrlCbk&&window._iwUrlCbk(e.url))};o._USERSHARE=1,o._USERFAV=1,o.fun=function(e){1==e.length&&MapSignInst[e[0]](),e.length>1&&MapSignInst[e[0]](e[1])},o.userTagPanl=null,o.exituserSign=function(){o.userTagPanl&&o.userTagPanl.isVisible()&&MapSignInst.exituserSign()},o.mapSign={pointInfo:{list:{}},polylineInfo:{list:{}},remarkInfo:{list:{}}},o.temp={event:{}},o.deCodeShare=function(e){var e=e||"";return e.replace(/&amp;/g,"&").replace(/&lt;br\/&gt;/g,"<br/>")},o.cpShare=function(){var e=T.g("shareInupt").value;return o.cpShare.timer&&clearTimeout(o.cpShare.timer),window.clipboardData&&(window.clipboardData.clearData(),window.clipboardData.setData("Text",e)),T.g("usSharMes")&&(T.g("usSharMes").style.display="block"),o.cpShare.timer=setTimeout(function(){T.g("usSharMes")&&(T.g("usSharMes").style.display="none")},1e3),e},o.cpShareFF=function(){var e=(T.g("shareInupt").value,baidu.swf.createHTML({id:"signLinkBtnFlh",url:"../swf/fClipboard.swf"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/swf/fClipboard.swf*/,width:"44",height:"24",wmode:"transparent",ver:"9.0.0"}));o.cpShareFF.checkFlash=function(){var e=baidu.swf.getMovie("signLinkBtnFlh");e&&e.flashInit&&e.flashInit()&&(clearInterval(o.cpShareFF.timer),e.setHandCursor(!0),e.setContentFuncName("_sign.cpShareFF.getPasteData"),e.setMEFuncName("_sign.cpShareFF.mouseEventHandler"))},o.cpShareFF.getPasteData=function(){var e=o.cpShare();return e},o.cpShareFF.mouseEventHandler=function(e){var n=T.g("cpShareCon");"mouse_over"==e?n.className="on":"mouse_down"==e?n.className="down":"mouse_up"==e?n.className="on":"mouse_out"==e&&(n.className="")},T.g("cpShareCon").innerHTML=e,o.cpShareFF.timer=setInterval(o.cpShareFF.checkFlash,500)},o.goShare=function(e){T.g("iw_tool_box")?T.g("iw_tool_box").style.top="-2000px":null;var n=T.g("iw_share_con");t.load("SharePanel",{dom:n,cinfo:{from:"iwshare",data:e},onload:function(){n.style.display="",o._goShare(e)}})},o._goShare=function(e){T.g("shareInupt").style.display="block",T.g("cpShareCon_").style.display="none"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/;var e=e&&e.uid?e:null,n=(T.g("shareInupt"),T.g("cpShareCon")),a="../../../../../map.baidu.com/-.htm"/*tpa=http://map.baidu.com/?*/;if(T.browser.chrome&&(T.g("iwBoxShareInput").style.padding="0 93px 0 2px"),T.g("shareInupt").onfocus=function(){this.select()},T.browser.ie){if(n){var t=function(e){0==e.button&&(this.className="down")},c=function(){this.className="on"},p=function(){this.className=""};n.onclick=function(){o.cpShare()},T.on(n,"mouseover",c),T.on(n,"mousedown",t),T.on(n,"mouseup",c),T.on(n,"mouseout",p),o.temp.event.shareCopy=[{obj:n,type:"mouseover",fun:c},{obj:n,type:"mousedown",fun:t},{obj:n,type:"mouseup",fun:c},{obj:n,type:"mouseout",fun:p}]}}else o.cpShareFF();var l=function(){var e=r.SHARE_PROC_URL+"?url="+encodeURIComponent(a)+"&web=true";s=!1,T.jsonp(e,i),clearTimeout(u),u=setTimeout(function(){0==s&&i({url:a})},3e3)};if(e)a+="shareurl=1&poiShareUid="+e.uid+"&cityCode="+e.cityCode+"&tn="+map.mapType,map._isHybirdShow&&(a+="&hb="+BMAP_TYPE_HYBIRD),l();else{var h=MapSignInst.temp.iw.index,g=o.mapSign.pointInfo.list[h];MapSignInst.getSignLink(baidu.json.stringify(g),function(e){if(1!=e.result)return T.g("shareInupt").style.display="none",n.style.display="none",T.g("cpShareCon_").style.display="block",void(T.g("cpShareCon_").innerHTML="有不符合相关法规政策的词，请修改");var o=e.content.shareId;a+="poiShareId="+o,a+="&tn="+map.mapType,map._isHybirdShow&&(a+="&hb="+BMAP_TYPE_HYBIRD),l()},"single")}},o.reShare=function(){if(T.g("iw_share_con").style.display="none",o.temp.event.shareCopy&&o.temp.event.shareCopy.length>0)for(var e=o.temp.event.shareCopy,n=0;n<e.length;n++){var a=e[n];T.un(a.obj,a.type,a.fun)}};var s=!0,u=null;o.parseShare=function(e){var n="/userflag/share.php?act=read_share&shareId="+e+"&t="+(new Date).getTime();baidu.ajax(n,{dataType:"json",success:function(e){if(e=e||{},1==e.result){var n=e.content;o("parseAllShare",n)}else o(),alert("数据已经删除")},error:function(){}})},window._sign=o,a.exports=o});
;define("common:widget/ui/mapShare/MapShare.js",function(n,t,o){function i(n){for(var t in n)return 0;return 1}function e(n,t,o){var i="",e=t;o.width&&(i=' style="width:'+o.width+'px"');var p='<div id="mapCommonTip" class="map_cTip"'+i+'><div class="tip">'+n+"</div><button ></button></div>";T.g("mapCommonTip")?T.g("mapCommonTip").style.display="":r.beforeEndHTML(e.getContainer(),p),T.g("mapCommonTip").style.left=parseInt(e.width)/2-o.width/2+"px",setTimeout(function(){a()},2e3),baidu("#mapCommonTip button").on("click",function(){a()})}function a(){T.g("mapCommonTip")&&(T.g("mapCommonTip").style.display="none")}var p,l,r=n("common:widget/ui/util/util.js"),s=n("common:widget/ui/config/config.js"),m=s.modelConfig,f={SHARE_PROC_URL:"http://j.map.baidu.com/",listIndex:null,mapSpotInf:null,mapInfo:{},getLink:function(n,t,o){this.cbk=n||function(){},this.getMap(),this.getList(),this.getSpotInfo(),this.getPopList(),this.getComponent(),this.getScrMode(),this.getPoiShare(),o=o||{};var a=this,r=[];for(var s in a.mapInfo)null!=a.mapInfo[s]&&""!=a.mapInfo[s]&&r.push(s+"="+a.mapInfo[s]);if(a.oUrl="http://map.baidu.com/?newmap=1&shareurl=1&"+r.join("&"),t&&!o.sms)return a.oUrl;var m=function(){var n=f.SHARE_PROC_URL+"?url="+encodeURIComponent(a.oUrl)+"&web=true";p=!1,T.jsonp(n,function(n){p=!0,a.cbk(n&&n.url||this.oUrl)}),clearTimeout(l),l=setTimeout(function(){0==p&&a.cbk(a.oUrl)},3e3)},u=baidu.json.parse(baidu.json.stringify(_sign.mapSign));if(i(u.pointInfo.list)&&i(u.polylineInfo.list)&&i(u.remarkInfo.list)){if(t)return n&&n(a.oUrl),a.oUrl;m()}else{for(var d in u.pointInfo.list)0==u.pointInfo.list[d].save&&delete u.pointInfo.list[d];for(var d in u.remarkInfo.list)0==u.remarkInfo.list[d].type&&delete u.remarkInfo.list[d];if(i(u.pointInfo.list)&&i(u.polylineInfo.list)&&i(u.remarkInfo.list)){if(t)return n&&n(a.oUrl),a.oUrl;m()}else MapSignInst.getSignLink(baidu.json.stringify(u),function(o){if(1!=o.result)return e("有不符合相关法规政策的词，请修改",map,{width:235}),t?(n&&n(a.oUrl),a.oUrl):void m();var i=o.content.shareId;return a.oUrl+="&mapShareId="+i,t?(n&&n(a.oUrl),a.oUrl):void m()},"all")}},getScrMode:function(){this.mapInfo.sc=map.fullScreenMode?1:0},getMap:function(){this.mapInfo.l=map.zoomLevel,this.mapInfo.tn=map.mapType,this.mapInfo.hb=map._isHybirdShow?BMAP_TYPE_HYBIRD:null;var n=map.centerPoint;this.mapInfo.c=n.lng.toFixed(0)+","+n.lat.toFixed(0),this.mapInfo.cc=map.currentCity},getComponent:function(){var n=window.currentComponent,t="";n&&n.modelQuery?t=n.modelQuery.replace(/&b=\((-?\d+)(\.\d+),(-?\d+)(\.\d+);(-?\d+)(\.\d+),(-?\d+)(\.\d+)\)/gi,""):n&&"City"==n._className&&(t="cur&wd="+m.cityName+"&c="+m.cityCode),this.mapInfo.s=encodeURIComponent(decodeURIComponent(t))},getList:function(){this.mapInfo.i=null!=this.listIndex?this.listIndex.toString().replace("|",encodeURIComponent("|")):null},getPopList:function(){this.mapInfo.pi=null!=this.popIndex?this.popIndex:null},getPoiShare:function(){var n=location.href,t=r.getParam(n);t&&t.poiShareUid&&(this.mapInfo.poiShareUid=t.poiShareUid)},setPoiShowAll:function(n){this.mapInfo.poiall=n?1:null},setSmSCode:function(n){this.mapInfo.sms=n?n:null},getSpotInfo:function(){this.mapInfo.msi=null!=this.mapSpotInf?this.mapSpotInf:null},setParam:function(n,t){n&&"[object String]"===Object.prototype.toString.call(n)&&(t?this.mapInfo[n]=t:delete this.mapInfo[n])}};o.exports=f});
;define("common:widget/ui/toolShare/ToolShare.js",function(e,o,t){var n=e("common:widget/ui/util/util.js"),i=e("common:widget/com/componentManager.js"),c=(e("common:widget/ui/searchBox/searchBox.js"),{SHARE_PROC_URL:"http://j.map.baidu.com/",long_url:"",keyList:{tsina:{title:"分享到新浪微博",code:1307,cbkcode:1317},tqq:{title:"分享到腾讯微博",code:1308,cbkcode:1318},qzone:{title:"分享到QQ空间",code:1306,cbkcode:1316},renren:{title:"分享到人人网",code:1309,cbkcode:1319},baidu:{title:"分享到百度搜藏",code:1310,cbkcode:1320},kaixin001:{title:"分享到开心网",code:1311,cbkcode:1321},hi:{title:"分享到百度空间",code:1312,cbkcode:1322},douban:{title:"分享到豆瓣网",code:1313,cbkcode:1323},tsohu:{title:"分享到搜狐微博",code:1314,cbkcode:1324},msn:{title:"分享到Myspace",code:1315,cbkcode:1325},fx:{title:"分享到飞信",code:1326,cbkcode:1327}},addCbkStat:function(){var e=window.location.hash;if(e)for(var o=e.split("#"),t="",n=0,i=o.length;i>n;n++)if(o[n].indexOf("bshare")>=0){t=o[n];break}},_procCbk:function(e){this._rec=!0,this._getLinkCbk(e&&e.url||this.oldUrl)},getLink:function(e,o){this._getLinkCbk=o;{var t=this,i=this.oldUrl="http://map.baidu.com/?shareurl=1&"+n.jsonToQuery(e);this.SHARE_PROC_URL+"?url="+encodeURIComponent(i)+"&web=true&callback=toolShare._procCbk"}t._rec=!1,baidu.jsonp(this.SHARE_PROC_URL+"?url="+encodeURIComponent(i)+"&web=true",function(e){t._procCbk(e)}),clearTimeout(t._timer),this._timer=setTimeout(function(){0==t._rec&&t._getLinkCbk(i)},3e3)},open:function(o,t){window.temp.linkPop&&window.temp.linkPop.close(),t=t||{from:"mapshare"},t.shareText=this.shareText;var n={title:"您可将当前地图上的内容分享给好友",addDom:T.g("tool_container"),content:"",height:94,width:T.browser.ie>=8?368:358,close:function(){window.temp.linkPop=null,T.rc(T.g("link"),"span_focus")}};e.async("common:widget/ui/Popup/Popup.js",function(e){var c=window.temp.linkPop=new e(n);c.addConnectDom(o),c.render(),c.hide(),c.getDom().style.right="68px",c.getDom().style.top="block"===T("#title_trafficCtrl").parents(".map_popup").css("display")?"98px":"38px",i.load("SharePanel",{dom:c.content,cinfo:t,onload:function(){c.show()}})})},_open:function(e,o){e=e||window.event,n.stopBubble(e),this.open("",o)},fixName:function(e){return e?"【"+e+"】":""},Tween:function(e,o,t,n){return t*((e=e/n-1)*e*e+1)+o},getMInfo:function(){return{}},setShareText:function(e){e=e||{};var o="";for(var t in e)o=o+" "+e[t];this.shareText=o}});t.exports=c});
;define("common:widget/ui/mapRevert/MapRevert.js",function(require,exports,module){var util=require("common:widget/ui/util/util.js"),comMgr=require("common:widget/com/componentManager.js"),config=require("common:widget/ui/config/config.js"),searchBox=require("common:widget/ui/searchBox/searchBox.js"),PanoUtil=require("common:widget/ui/PanoUtil/PanoUtil.js"),traffic=require("common:widget/ui/Traffic/Traffic.js"),signMgr=require("common:widget/ui/signMgr/signMgr.js"),aqiMgr=require("common:widget/ui/AQIMgr/AQIMgr.js"),PanoInterface=require("common:widget/pano/PanoInterface/PanoInterface.js"),modelConfig=config.modelConfig,MapRevert={isRevert:!1,revert:function(){var e=location.href,a=util.getParam(e);if(a=util.extendHashParam(e,a),!a)return!1;if(null!=a.q){var o=0;for(var r in a)o++;1==o&&window.setTimeout(function(){try{T.g("PoiSearch").value=decodeURIComponent(a.q)}catch(e){}},300)}return a.mapShareId&&signMgr.parseShare(a.mapShareId),a.poiShareUid&&(a.s=encodeURIComponent("inf&uid="+a.poiShareUid+"&c="+a.cityCode)),a.s?(this.setModel(a),!0):a.poiShareId?(this.revertPoiShare(a),!0):1==a.aqi&&a.cname?(aqiMgr.revert(decodeURIComponent(a.cname)),!0):!1},setModel:function(param){var me=this,opts={cinfo:{cityInit:1},onload:function(){var e=param.tn||param.mt;if(param.c){var a=param.c.split(","),o={};if(2==a.length){{parseFloat(a[0]),parseFloat(a[1])}o=new BMap.Point(parseFloat(a[0]),parseFloat(a[1])),e==BMAP_TYPE_DIMENSIONAL&&(o=BMap.Project.convert3DTo2D(map.currentCity,o)),map.setMapType(e),map.centerAndZoom(o,parseInt(param.l))}}param.panoid&&param.panotype&&me.revertStreetView(param)}};if(null!=param.l&&"number"==typeof parseInt(param.l)&&(opts.cinfo._maplevel=parseInt(param.l)),null!=param.c){var p=param.c.split(",");if(2==p.length){var lng=parseFloat(p[0]),lat=parseFloat(p[1]),point=new BMap.Point(p[0],p[1]);opts.cinfo._centerPoint=point}}var index=param.i;null!=index&&(opts.cinfo._index=index,opts.cinfo.index=index);var showAll=param.poiall;showAll&&(opts.cinfo.poiall=1);var smsCode=param.sms;smsCode&&(opts.cinfo.sms=smsCode),traffic.setBtn(!!param.tfc,!0);var poPindex=param.pi;null!=poPindex&&(opts.cinfo._popIndex=parseInt(poPindex)),null!=param.ttype&&(opts.cinfo.trafType=param.ttype);var popPoint=param.b;if(null!=popPoint){var p=popPoint.split(",");if(2==p.length){var lng=parseFloat(p[0]),lat=parseFloat(p[1]),point=new BMap.Point(p[0],p[1]);opts.cinfo._popPoint=point}}param.s=param.s.replace(/%u[0-9a-zA-Z]{4}/gi,function(e){return encodeURIComponent(unescape(e))});var qs=[];try{qs=decodeURIComponent(param.s).split("&")}catch(e){return void comMgr.load("Error",{dom:T.g("MapInfo")})}for(var query="",i=0,l=qs.length;l>i;i++){var tempQ=qs[i].split("=");if(0!=tempQ.length)if(1!=tempQ.length){var q=tempQ.slice(1).join("");("ec"==tempQ[0]||"en"==tempQ[0])&&(q=q.replace(/\+/g," ")),query+="&"+tempQ[0]+"="+encodeURIComponent(decodeURIComponent(q))}else query+=tempQ[0]}if(query=0==query.indexOf("&")?query.substring(1):query,!query.match(/.*&c=\d{1,3}.*/)){var cc=modelConfig.cityCode;if(_OLR&&_OLR.index)try{eval("var ccd ="+_OLR.index),cc=ccd.content.code}catch(e){cc=modelConfig.cityCode}null==query.match(/tpl:/)&&(query+="&c="+cc)}var queryType=T.trim(qs[0]);switch("alamap"==param.from&&(query+="&provider=pc-aladin"),queryType){case"bt":query=query.replace(/wd1=(.*)&/,"sn=2$$$$$$$$$$$$$1$$$$$$&"),query=query.replace(/wd2=(.*)&/,"en=2$$$$$$$$$$$$$1$$$$$$&"),query&&query.indexOf("&exptype=")<0&&(query+="&exptype=dep&exptime=&version=5");case"nav":query=query.replace(/wd1=(.*)&/,"sn=2$$$$$$$$$$$$$1$$$$$$&"),query=query.replace(/wd2=(.*)&/,"en=2$$$$$$$$$$$$$1$$$$$$&");break;case"s":}opts.dom=T.g("MapInfo"),query.match(/tpl:City/)?comMgr.load("City",opts):comMgr.go(query,opts),searchBox.parseShare(decodeURIComponent(param.s))},revertPhotoTour:function(e,a){PanoInterface.showPhotoTour(e,a)},revertStreetView:function(e){var a="",o="";e.pid?(o=e.pid,a=e.iid||""):"inter"===e.panotype?a=e.panoid:o=e.panoid,PanoInterface.showPano({panoId:o,panoIId:a,panoType:e.panotype,panoHeading:e.heading,panoPitch:e.pitch,panoZoom:e.l,panoShareParam:e.psp,from:"share"}),"alamap"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/===e.from?addStat(STAT_CODE.STAT_PANORAMA,{item:e.panotype,catalog:"alamap",func:"alamap",query:e.pword}):addStat(STAT_CODE.STAT_PANORAMA,{from:"share",item:e.panotype})},revertPoiShare:function(e){comMgr.start_event=(new Date).getTime(),comMgr.load("PoiShare",{onload:function(){var a=e.tn||e.mt;map.mapType!==a&&map.setMapType(a)}})},init:function(){this.revert()||(comMgr.load("City",{cinfo:{cityInit:1},onload:function(){var e="../../../../../map.baidu.com/index.htm#panoid=0100220000130728103000405J3&panotype=street&heading=2&pitch=-2&l=13&tn=B_NORMAL_MAP&sc=0&newmap=1&shareurl=1&pid=0100220000130728103000405J3&psp={%22PanoModule%22%3A{%22markerUid%22%3A%224eb3b53350e1746c4302450c%22}%2C%22PoiInfoPanelModule%22%3A{%22uid%22%3A%224eb3b53350e1746c4302450c%22}}"/*tpa=http://map.baidu.com/#panoid=0100220000130728103000405J3&panotype=street&heading=2&pitch=-2&l=13&tn=B_NORMAL_MAP&sc=0&newmap=1&shareurl=1&pid=0100220000130728103000405J3&psp={%22PanoModule%22%3A{%22markerUid%22%3A%224eb3b53350e1746c4302450c%22}%2C%22PoiInfoPanelModule%22%3A{%22uid%22%3A%224eb3b53350e1746c4302450c%22}}*/,a="../../../../../map.baidu.com/index.htm#panoid=0100220000130728103000405J3&panotype=street&heading=2&pitch=-2&l=13&tn=B_NORMAL_MAP&sc=0&newmap=1&shareurl=1&pid=0100220000130728103000405J3&psp={%22PanoModule%22%3A{%22markerUid%22%3A%224eb3b53350e1746c4302450c%22}%2C%22PoiInfoPanelModule%22%3A{%2"/*tpa=http://map.baidu.com/#panoid=0100220000130728103000405J3&panotype=street&heading=2&pitch=-2&l=13&tn=B_NORMAL_MAP&sc=0&newmap=1&shareurl=1&pid=0100220000130728103000405J3&psp={%22PanoModule%22%3A{%22markerUid%22%3A%224eb3b53350e1746c4302450c%22}%2C%22PoiInfoPanelModule%22%3A{%2*/,o="../../../../../map.baidu.com/index.htm#panoid=0100220000130728103037820J3&panotype=street&heading=359&pitch=8&l=18&tn=B_NORMAL_MAP&sc=0&newmap=1&shareurl=1&pid=0100220000130728103037820J3&psp=%7B%22PanoModule%22%3A%7B%22markerUid%22%3A%22af2a37c998544528e6e965e7%22%7D%2C%22PoiInfoPanelModule%22%3A%7B%22uid%22%3A%22af2a37c998544528e6e965e7%22%7D%7D"/*tpa=http://map.baidu.com/#panoid=0100220000130728103037820J3&panotype=street&heading=359&pitch=8&l=18&tn=B_NORMAL_MAP&sc=0&newmap=1&shareurl=1&pid=0100220000130728103037820J3&psp=%7B%22PanoModule%22%3A%7B%22markerUid%22%3A%22af2a37c998544528e6e965e7%22%7D%2C%22PoiInfoPanelModule%22%3A%7B%22uid%22%3A%22af2a37c998544528e6e965e7%22%7D%7D*/,r=location.href;r===e&&(r=o),r===a&&(r=o);var t=util.getParam(r);t=util.extendHashParam(location.href,t),t&&t.panoid&&t.panotype&&MapRevert.revertStreetView(t),isPhotoTourSupported&&t&&t.tourIId&&t.tourId&&MapRevert.revertPhotoTour(t.tourIId,t.tourId)}}),document.fmwd.word.focus())}};module.exports=MapRevert});
;define("common:widget/ui/sms/sms.js",function(t,e,n){function o(t,e){var n=t.getDom(),o=map.getSize(),i=T.dom.getPosition(map.getContainer());width=o.width,height=o.height,x=width<=e.width?0:parseInt(width/2)-parseInt(e.width/2),y=height<=e.height?0:parseInt(height/2)-parseInt(e.height/2),x+=i.left,y+=i.top,e&&"undefined"!=typeof e.right?n.style.right=e.right+"px":n.style.left=e&&"undefined"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/!=typeof e.left?e.left+"px":x+"px",n.style.top=e&&"undefined"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/!=typeof e.top?e.top+"px":e&&"undefined"!=typeof e.bottom?e.bottom+"px":y+"px"}function i(t,e,n,i,s,r){o(l.spop,d),t==u.target||(e?u.uid==e:0)||(u.target=t,u.uid=e?e:null,m(function(o){p.load("SMS",{dom:l.spop.content,cinfo:{infoWin:l.spop,tplUrl:o.tplUrl,oldUrl:o.oldUrl,curUrl:o.curUrl,target:t,uid:e||"",type:n||0,uidType:r}})},e,n,i))}var p=t("common:widget/com/componentManager.js"),s=t("common:widget/ui/constant/Constant.js"),r=(t("common:widget/ui/util/util.js"),t("common:widget/ui/mapShare/MapShare.js")),l={config:{DETAIL_URL:"../../../../../map.baidu.com/-newmap=1&.htm"/*tpa=http://map.baidu.com/?newmap=1&*/,NEWSEND_URL:"/ag/sms/sendnew/",READY_URL:"/ag/sms/readynew?url=",BMW_INFO:"http://"+location.host+"/?qt=inf&ie=utf-8",BMW_DATA_URL:"http://"+location.host+"/car/send"},spop:null},u={target:null,uid:null},d={isTitle:!1,content:"",extClass:"loginStyle",width:655,height:457,clickClose:!1,close:function(){u.target=null,u.uid=null,r.setSmSCode(0);var t=currentComponent;t&&t.cinfo.sms&&(t.cinfo.sms=null)},free:function(){delete l.spop}},c={POI:"s=inf%26uid%3D_UID_%26c%3D_CITY_%26newmap%3D1%26it%3D1",LINE:"s=bsl%26bsltp%3D0%26uid%3D_UID_%26c%3D_CITY_%26newmap%3D1"},a=function(t){switch(parseInt(t,10)){case s.POI_TYPE_NORMAL:return c.POI;case s.POI_TYPE_BUSSTOP:return c.POI;case s.POI_TYPE_BUSLINE:return c.LINE;case s.POI_TYPE_SUBSTOP:return c.POI;case s.POI_TYPE_SUBLINE:return c.LINE}},m=function(t,e,n,o){r.getLink(function(i){var p=encodeURIComponent(i),s={oldUrl:p};e&&"undefined"!=typeof n?(r.setSmSCode(e),s.curUrl="&current_url="+p):s.curUrl="",e&&"undefined"!=typeof n?s.tplUrl=encodeURIComponent(l.config.DETAIL_URL+a(n).replace("_UID_",e).replace("_CITY_",o)):(r.setSmSCode(e),s.tplUrl=p),t&&t(s)},!0,{sms:!0,uid:e})},f=function(e,n,o,p,s,r){if(l.spop){if(l.spop.visible)return;l.spop.render(),l.spop.show(),i(e,n,o,p,s,r)}else t.async("common:widget/ui/Popup/Popup.js",function(t){l.spop=new t(d),l.spop.addConnectDom(e),l.spop.render(),l.spop.hide(),i(e,n,o,p,s,r)});return!1};l.ready=f,n.exports=l});
;define("common:widget/ui/Traffic/Traffic.js",function(t,i,n){var o=t("common:widget/ui/tools/tools.js"),f=t("common:widget/ui/PanoUtil/PanoUtil.js");n.exports={setHighLevel:function(){"B_NORMAL_MAP"==map.mapType&&this.setBtn(this.need2ShowTraffic())},setBtnStatus:function(){var t=this.need2ShowTraffic();this.setBtn(t)},setBtn:function(t,i){var n=window,f=this,e=T.g("tool_traffic");t?(e.onclick=function(t){t=t||window.event,n.trafficCtrl||f.loadTrafficCtrl(),baidu.event.preventDefault(t)},i&&f.loadTrafficCtrl()):n.trafficCtrl&&n.trafficCtrl.hide(),e&&(e.style.display=t?"":"none"),o.resetWidth()},need2ShowTraffic:function(){if(window.PanoMap&&window.PanoMap.isOpen||f&&f.isOpen)return!1;var t=map.getZoom(),i=map.mapType;return t&&i!=BMAP_TYPE_DIMENSIONAL},exit:function(t){t=t||"",window.trafficCtrl&&window.trafficCtrl.close({type:t})},loadTrafficCtrl:function(){window.isPrint||t.async(["common:widget/ui/TrafficEvent/TrafficEvent.js","common:widget/com/TrafficControl/TrafficControl.js"],function(t,i){window.trafficCtrl=new i,trafficCtrl.show(),trafficCtrl.open()})}}});
;define("common:widget/ui/tools/tools.js",function(o,n,t){function e(){for(var o=T.g("tool_container_con"),n=o.childNodes,t=[],e=0,i=n.length;i>e;e++)1==n[e].nodeType&&t.push(n[e]);return t}function i(){_.addEventListener("onFullScreen",function(){V.resetWidth()}),_.addEventListener("onExitFull",function(){V.resetWidth()})}function s(){if(window.searchInViewCtrl){var n=window.searchInViewCtrl;0==n.isOpen?(addStat("indextool.searchinview.opensearchinview"),n.prepare()):n.setStatus(),n.hasClickButton=!0}else o.async("common:widget/ui/searchInViewControl/SearchInViewControl.js",function(o){var n=window.searchInViewCtrl=new o;n.prepare(),n.hasClickButton=!0}),addStat("indextool.searchinview.opensearchinview")}function a(o){var n=o&&1==o.nodeType?o:this;n._opened||(T.rc(n,"span_focus"),T.ac(n,"span_over"))}function u(o){var n=o&&1==o.nodeType?o:this;T.rc(n,"span_over"),n._opened||T.rc(n,"span_focus")}function r(o){var n=o&&1==o.nodeType?o:this,t=1;T.browser.ie||(t=0),o&&o.button!=t||(T.rc(n,"span_over"),T.ac(n,"span_focus"))}var c=(o("common:widget/ui/stat/CodeStat.js"),o("common:widget/ui/config/config.js")),l=o("common:widget/ui/constant/Constant.js"),d=o("common:widget/ui/indexUtil/IndexUtil.js"),p=o("common:widget/com/componentManager.js"),m=(o("common:widget/ui/mapInfo/mapInfo.js"),o("common:widget/ui/toolShare/ToolShare.js")),f=c.modelConfig,g=o("common:widget/ui/signMgr/signMgr.js"),_=o("common:widget/ui/fullScreen/fullScreen.js"),w=(o("common:widget/ui/AQIMgr/AQIMgr.js"),T.g("curCity")),h=T.g("tool_sehInView"),v=T.g("tool_traffic"),C=T.g("tool_tollCon"),S=T.g("tool_fullScr"),M=T.g("tools_box"),b=(T.g("boxBtn"),T.g("specialBtn")),x=(T.g("favBtn"),T.g("measure")),y=T.g("capwrap"),I=T.g("signwrap"),E=T.g("link"),L=T.g("print"),j=T.g("tool_pano_share"),k=T.g("tool_event"),B=T.g("tool_street_view_share"),D=T.g("tool_panoClose"),O=(T.g("air_quality_btn"),function(){M.style.top="23px"}),P=function(){M.style.top="-2000px"},V={init:function(){this.bindEvent(),this.resetWidth(),i()},bindEvent:function(){var n=this;T.on(C,"mouseenter",O),T.on(C,"mouseleave",P),T.on(h,"mouseover",a),T.on(v,"mouseover",a),T.on(S,"mouseover",a),T.on(b,"mouseover",a),T.on(x,"mouseover",a),T.on(y,"mouseover",a),T.on(I,"mouseover",a),T.on(E,"mouseover",a),T.on(L,"mouseover",a),T.on(j,"mouseover",a),T.on(k,"mouseover",a),T.on(B,"mouseover",a),T.on(D,"mouseover",a),T.on(h,"mouseout",u),T.on(v,"mouseout",u),T.on(S,"mouseout",u),T.on(b,"mouseout",u),T.on(x,"mouseout",u),T.on(y,"mouseout",u),T.on(I,"mouseout",u),T.on(E,"mouseout",u),T.on(L,"mouseout",u),T.on(j,"mouseout",u),T.on(k,"mouseout",u),T.on(B,"mouseout",u),T.on(D,"mouseout",u),T.on(h,"mousedown",r),T.on(v,"mousedown",r),T.on(S,"mousedown",r),T.on(j,"mousedown",r),T.on(k,"mousedown",r),T.on(B,"mousedown",r),T.on(D,"mousedown",r),baidu(w).on("click",function(o){d.selectCity(w,{styleSwitch:!0}),o.preventDefault()}),baidu(h).on("click",function(o){s(),o.preventDefault()}),T.on(x,"click",function(){M.style.top="-2000px",n.doMeasure(this),T.rc(T.g("tool_tollCon"),"span_focus")}),T.on(y,"click",function(){M.style.top="-2000px",n.captureMap(this),T.rc(T.g("tool_tollCon"),"span_focus")}),T.on(I,"click",function(){M.style.top="-2000px",addStat("http://webmap0.map.bdstatic.com/newmap/static/common/pkg/indextool.toolbar.mark"),g("mapSign"),T.rc(T.g("tool_tollCon"),"span_focus")}),T.on(E,"click",function(){addStat("indextool.toolbar.toolbarshare"),M.style.top="-2000px",m.open(this),T.rc(T.g("tool_tollCon"),"span_focus")}),T.on(L,"click",function(){_this=this,addStat("indextool.toolbar.print"),M.style.top="-2000px",T.rc(T.g("tool_tollCon"),"span_focus"),o.async("common:widget/ui/PrintMap/PrintMap.js",function(o){o.printMap(_this)})}),T.on(j,"click",function(){m.open(this)}),T.on(k,"click",function(){addStat("indextool.toolbar.accident"),T.rc(k,"span_focus"),window.pubEvent&&window.pubEvent.toggle()}),baidu(".search_box .search_input input").on("mousedown",function(){n.closeMeasure()}),baidu("form.tool_form").on("submit",function(o){n.submit(),o.preventDefault()}),baidu("input.tools_search_submit").on("click",function(o){n.submit(),o.preventDefault()})},resetWidth:function(){var o=T.g("tool_container"),n=T.g("tool_container_con"),t=n?e():[],i=0;o.style.width="auto";for(var s=0;s<t.length;s++)t[s]&&(i+=t[s].offsetWidth+4);o.style.width=i+3+"px"},submit:function(){if(""==T.g("ToolPoiSearch").value)return void T.g("ToolPoiSearch").focus();window.PanoMap&&window.PanoMap.isOpen&&PanoMap.hide();var o=T.g("ToolPoiSearch").value,n=f.cityCode||1;p.go("s&wd="+encodeURIComponent(o)+"&c="+n+"&src=0",{cinfo:{}})},doMeasure:function(o){this.endCaptureMap(),g.exituserSign();var n=this;if(!n.distanceControl){BMap.PolylineTItem=BMap.DistanceTool;var t=new BMap.PolylineTItem(map,{styleCodes:{lnCode:l.OVERLAY_STYLE.DIS_LINE,spCode:l.OVERLAY_STYLE.DIS_DOT,slCode:l.OVERLAY_STYLE.DIS_LBL,tlCode:l.OVERLAY_STYLE.DIS_T_LBL}});n.distanceControl=t}this.doMeasure._initialized||(n.distanceControl&&n.distanceControl.addEventListener("drawend",function(){T.rc(o,"span_focus")}),this.doMeasure._initialized=!0),n.distanceControl&&(n.distanceControl._isOpen?this.closeMeasure():(n.distanceControl.open(),T.ac(o,"span_focus"),addStat("indextool.toolbar.ruler")))},closeMeasure:function(){var o=this;o.distanceControl&&o.distanceControl.close(),T.rc(T.g("measure"),"span_focus")},captureMap:function(){var n=this;this.closeMeasure(),g.exituserSign(),o.async("common:widget/com/Capture/Capture.js",function(o){n.startCaptureMap(o)})},startCaptureMap:function(o){o._initialized||(o.initialize(map),o._initialized=!0),o._inUse?(o.endCapture(),T.rc(T.g("capwrap"),"span_focus")):(o.beginCapture(),T.ac(T.g("capwrap"),"span_focus"),addStat("indextool.toolbar.capture"))},endCaptureMap:function(){window.captureCtrl&&window.captureCtrl._initialized&&window.captureCtrl.endCapture()},closeOtherOps:function(){this.closeMeasure(),this.endCaptureMap(),g.exituserSign()}};t.exports=V});
;define("common:widget/ui/BoxContainer/BoxContainer.js",function(n,e,o){var t=n("common:widget/ui/areaCfg/areaCfg.js"),i=n("common:widget/ui/Special/Special.js"),a=n("common:widget/com/componentManager.js"),l=(n("common:widget/ui/mapInfo/mapInfo.js"),n("common:widget/ui/tools/tools.js")),r=n("common:widget/ui/config/config.js"),c=r.modelConfig,s=(r.mapConfig,{scrollBar:null,container:T.g("ToolsCon"),titleDom:T.g("ToolsTitle"),contentDom:T.g("toolsContent"),closeBtn:T.g("ToolsCloseBtn"),_opened:!1,curSpecial:null,curCity:null,modelList:{PoiSearch:1,BusTrans:1,LinesQuery:1,BusLines:1,NavTrans:1,CBusTrans:1,Detail:1,SearchInView:1},init:function(){var n=this;return n.bindEvent(),this},initScrollBar:function(){var n=this;n.scrollBar=new baidu.ui.ScrollPanel({container:n.contentDom,overflow:"overflow-y",margin:[0,0,0,5]}),n.scrollBar.render(n.contentDom)},show:function(n){n=n||{};var e=this,o=n.title||"",t=n.content||"";e.setTitle(o),e.setContent(t),e.bindCloseEvent(),e.container.style.display="block",e.scrollBar?e.scrollBar.update():e.initScrollBar()},hidden:function(){var n=this;n.container&&(n.container.style.display="none"),n._opened=!1},resetStatus:function(){var n=baidu.g("btn_home"),e=baidu.g("btn_return");n&&(n.style.display="block"),e&&(e.style.display="none")},setTitle:function(n){var e=this;e.titleDom.innerHTML=n},setContent:function(n){var e=this;e.contentDom.innerHTML=n,e.scrollBar&&e.scrollBar.update()},bindCloseEvent:function(){var n=this;n.closeBtn.onclick=function(){n.exit()}},exit:function(){var n=this;n.hidden()},bindEvent:function(){var e=this,o=(T.g("subWayBtn"),T.g("btn_home")),t=T.g("favBtn"),i=function(n){return e._opened?void e.exit():(e._opened=!0,s.show(),l.closeOtherOps(),addStat("indextool.toolbar.favourites"),window.FavInst?window.FavInst.render():T.browser.ie<7?setTimeout(function(){a.load("Fav",{dom:"passive_com_box"})},0):a.load("Fav",{dom:"passive_com_box"}),void n.preventDefault())};T.on(t,"click",i),T.on(o,"click",function(o){var t=n("common:widget/ui/toolShare/ToolShare.js"),i="other",l=window.currentComponent._className,r=t.getMInfo(),s=e.modelList;e._opened?i="fav":s[l]&&r.className==l&&(i=r.text?l:"nores"),("SearchInView"==i||"LinesQuery"==i||"BusLines"==i)&&(i="PoiSearch"),"CBusTrans"==i&&(i="BusTrans"),window.place&&place.resetArea&&place.resetArea(),a.go("cur&wd="+encodeURIComponent(c.cityName),{cinfo:{from:"home_btn"}}),addStat("indextool.toolbar.homebtn"),o.preventDefault()})},showSpecial:function(n){n=n||{};var e=this,o=T.g("specialBtn"),a=T.g("specInner"),l=c.cityName,r=[c.cityName],s=n.type||"",u=n.sCity||"",d=n.eCity||"",m=0;if(l=l.replace(/市$/,""),s?e.curCity=null:m=1,e.curCity&&(l=e.curCity),u&&d){r=[u,d];for(var p=0;p<r.length;p++){var f=r[p].replace(/市$/,"");if(i.data[s][f]){l=f,e.curCity=f;break}}}if(s=s||e.curSpecial,!s||!i.data[s][l])return void(m?e.hiddenSpecial({noClear:!0}):e.hiddenSpecial());var v=i.data[s];a.innerHTML=v.spTitle.replace(/#cityName#/g,l),o.className=o.className+" toolBtn--img--"+s,o.style.display="block",o.onclick="subway"!=s?function(){i.searchWord(v.spTitle,{type:s,codeStr:"SPEC"})}:function(){var n=t[l]||131;window.open(v.url+v[l]+"&ccode="+n)},e.curSpecial=s},hiddenSpecial:function(n){n=n||{};var e=this,o=T.g("specialBtn"),t=T.g("specInner");t.innerHTML="",o.className="toolBtn toolBtn--link toolBtn--img",o.style.display="none",o.onclick=null,n.noClear||(e.curSpecial=null),e.curCity=null}});o.exports=s.init()});
;define("common:widget/ui/Special/Special.js",function(a,n,e){var t=a("common:widget/ui/areaCfg/areaCfg.js"),i=a("common:widget/ui/config/config.js"),c=a("common:widget/com/componentManager.js"),i=a("common:widget/ui/config/config.js"),o=i.modelConfig,m=(i.mapConfig,{sectionDiscount:Math.floor((new Date-Date.parse("01/01/2012"))/864e5)+",+",data:{preferential:{title:"优惠券",maxTitle:"优惠券",wd:"餐饮",des:"提供北京市的餐饮类优惠券分布图","北京":"beijing"},tuan:{title:"团购",maxTitle:"团购",des:"提供北京市的美食、娱乐、生活服务、酒店旅游团购分布图",url:"http://www.nuomi.com/?cid=map_pc_icon",sup:0},subway:{title:"地铁",maxTitle:"地铁专题",spTitle:"#cityName#地铁路线图",des:"共有北京，上海，广州，深圳，香港、南京、成都、重庆、天津、沈阳、杭州、武汉、苏州、大连、长春、西安、昆明、佛山、哈尔滨、郑州、宁波、无锡等二十多个城市的地铁路线图",url:"http://"+window.location.host+"/subways/index.html?c=","北京":"beijing","上海":"shanghai","广州":"guangzhou","深圳":"shenzhen","香港特别行政区":"hongkong","南京":"nanjing","成都":"chengdu","重庆":"chongqing","天津":"tianjin","沈阳":"shenyang","杭州":"hangzhou","武汉":"wuhan","苏州":"suzhou","大连":"dalian","长春":"changchun","西安":"xian","昆明":"kunming","佛山":"foshan","哈尔滨":"harbin","郑州":"zhengzhou","杭州":"hangzhou","长沙":"changsha","宁波":"ningbo","无锡":"wuxi","台北":"taibei","高雄":"gaoxiong"},weather:{},gas:{},park:{},train:{}},cityDataList:[{name:"repast",cnName:"餐饮"},{name:"viewpoint",cnName:"景点"},{name:"bank",cnName:"银行"},{name:"fillingstation",cnName:"加油站"},{name:"hotelbar",cnName:"酒吧"},{name:"hospital",cnName:"医院"},{name:"school",cnName:"学校"},{name:"internet",cnName:"网吧"},{name:"carpark",cnName:"停车场"},{name:"market",cnName:"超市"},{name:"ktv",cnName:"KTV"},{name:"shopping",cnName:"购物"},{name:"bath",cnName:"洗浴"},{name:"beauty",cnName:"丽人"},{name:"atm",cnName:"ATM"},{name:"coffee",cnName:"咖啡厅"}],getHtml:function(a){a=a||{};var n=a.cityName||o.cityName,e=a.showDescript,i=a.liEvent||"",c=a.from,s="",l="",u=a.dataName;if(1&a.sup){{encodeURIComponent(n)}m.data.tuan.des="提供"+n+"的美食、娱乐、生活服务、酒店旅游团购分布图",m.data.tuan.url="http://www.nuomi.com/?cid=map_pc_icon",m.data.tuan.sup=1}else m.data.tuan.sup=0;n=n.replace(/市$/,"");var d=m.data[u],r="",p="",g=d.title,h=d.maxTitle,w="INDEX",f="",b=d.wd,y=Number(/^优惠券$/.test(g));if("box"==c&&(g=d.maxTitle,w="BOX"),d.url&&n){"weather"!=u&&d[n]&&(f=d[n]);var N=d.url+f,_="";if("subway"==u){var x=t[n]||131;N=N+"&ccode="+x,_="addStat('citylistbtn', null, {'da_trd':'地铁'});"}else"tuan"==u&&(_="addStat('citylistbtn', null, {'da_trd':'团购频道'});");p="onclick = \"window.open('"+N+"')\""}else p="onclick = \"Special.searchWord('"+(b?b:h)+"',{type:'"+u+"',codeStr:'"+w+"'"+(y?",discount:"+y:"")+'});return false;"';return e&&(l="<p>"+d.des+"</p>"),("weather"==u||"lunch"==u||d[n]||"tuan"==u&&m.data.tuan.sup)&&(s+="preferential"==u||"tuan"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/==u&&m.data.tuan.sup?"tuan"http://webmap0.map.bdstatic.com/newmap/static/common/pkg/==u&&m.data.tuan.sup?"<li "+i+p+' class="city-tuan"><a ><img src="'+o.timg+'" width="48" height="49" /></a><a >团购频道</a></li>':"<li "+i+p+' class="li_'+u+'"><a >('+a.dataCount+")</a></li>":"<li"+i+' class="li_'+u+'"><a '+r+p+'><img src="../images/transparent.gif"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/transparent.gif*/ class="'+u+'" /><b>'+g+"</b>"+l+"</a></li>"),s=s.replace(/#cityName#/g,n),{html:s}},getSubwayHtml:function(a){a=a||{};var n=a.cityName.replace(/市$/,""),e=a.cityCode||131,t=m.data.subway,i=t[n],c="http://"+window.location.host+"/subways/index.html?c="+i+"&ccode="+e,o="onclick = \"window.open('"+c+"')\"",s='<li class="li_subway" data-name="地铁"><a '+o+'><img src="../images/transparent.gif"/*tpa=http://webmap0.map.bdstatic.com/newmap/static/common/images/transparent.gif*/ class="subway" /><b>地铁</b></a></li>';return s},searchWord:function(a,n){n=n||{};var e=(n.type,n.codeStr,n.discount);if(!(a.length<1)){var t=o.cityCode||1,i="",m=0,s=map.getBounds();c.go("s&wd="+encodeURIComponent(a)+"&c="+t+"&src=0&wd2="+encodeURIComponent(i)+"&sug="+m+"&l="+map.zoomLevel+"&b=("+s.minX+","+s.minY+";"+s.maxX+","+s.maxY+")"+(e?"&pl_discount2_section="+encodeURIComponent(this.sectionDiscount)+"&pl_data_type=cater&pl_sub_type="+encodeURIComponent(a):""))}}});e.exports=window.Special=m});
;define("common:widget/ui/Weather/Weather.js",function(e,t,i){var n=e("common:widget/ui/config/config.js"),a=n.modelConfig,o={active:!1,add:function(e){var t=T.g("btn_weather"),i=T.g("txt_weather"),n=null;try{if(n="string"==typeof e?baidu.json.parse(e):e,!n||1==a.cityType||0==a.cityType)return void(t.style.display="none");var o=n.temp0||n.temp1||"",r=n.weather0||n.weather1||"";o&&r?(t.style.display="",i.innerHTML=r+" "+o):t.style.display="none"}catch(s){}}};i.exports=o});
;define("common:widget/ui/Pc2Mobile/Pc2Mobile.js",function(e,o,i){var t=(e("common:widget/ui/stat/CodeStat.js"),e("common:widget/ui/util/util.js")),n=2,d={box:null,init:function(){var e=this;this.box=T.dom.create("div",{id:"pc2mobile_cover"}),this._innerFun=function(){e.resize()},T.on(window,"resize",this._innerFun)},show:function(){var e=this.box;document.body.appendChild(e),this.resize()},hide:function(){var e=this;e.box&&document.body.removeChild(e.box),e.clear()},resize:function(){if(this.box){var e=this.box,o=t.getClientSize();6==T.browser.ie&&(e.style.width=o.width+"px",e.style.height=o.height+"px")}},clear:function(){this._innerFun&&(T.un(window,"resize",this._innerFun),delete this._innerFun),delete this.box}},s={popup:null,component:null,open:function(e,o,i){switch(i=i||{},o){case"城市推广安卓按钮":addStat("sendtodevice.sendtomb.citylisttodevicebyand");break;case"城市推广ios按钮":addStat("sendtodevice.sendtomb.citylisttodevicebyios");break;case"公交安卓按钮":addStat("sendtodevice.sendtomb.bltodevicebyandroid");break;case"公交ios按钮":addStat("sendtodevice.sendtomb.bltodevicebyios");break;case"POI安卓按钮":addStat("sendtodevice.sendtomb.poitodevicebyandroid");break;case"POIios按钮":addStat("sendtodevice.sendtomb.poitodevicebyios");break;case"短信窗口安卓按钮":addStat("sendtodevice.sendtomb.smstodevicebyandroid");break;case"短信窗口ios按钮":addStat("sendtodevice.sendtomb.smstodevicebyios");break;case"下载页安卓按钮":addStat("sendtodevice.sendtomb.downpagetodevicebyandroid");break;case"下载页ios按钮":addStat("sendtodevice.sendtomb.downpagetodevicebyios");break;case"收藏栏":addStat("sendtodevice.sendtomb.favouritetodevice")}if(e){e=e.toUpperCase();var t={from:e,realfrom:o};i.qudao&&(t.qudao=i.qudao),i.pref&&(t.pref=i.pref),this._open(t)}},close:function(){this.popup&&this.popup.close()},_open:function(o){this.popup&&this.popup.close(),o=o||{};var i=this,t={content:"",isTitle:!1,extClass:"mo-popup",height:409,width:674,defaultAnchor:n,clickClose:!1,closeButton:'<button class="mo-close" title="关闭"></button>',close:function(){i.clear(i.popup),i.popup=null}};e.async(["common:widget/ui/Popup/Popup.js","common:widget/com/MobileDownload/MobileDownload.js"],function(e,n){var s=i.popup=new e(t);s.render(),s.hide(),d.init();new n({dom:s.content,cinfo:o});d.show(),s.show()});var s=T.browser.ie&&T.browser.ie<=7?"keypress":"keydown";T.on(window.document,s,function(e){i._escFun=arguments.callee,27==e.keyCode&&i.popup&&i.popup.close()})},clear:function(e){if(this._escFun){var o=T.browser.ie&&T.browser.ie<=7?"keypress":"keydown";T.un(window.document,o,this._escFun),this._escFun=null}d.hide(),e=null},addTip:function(){var e=this;"2"===T.cookie.get("Maptodowntip")||window.isPrint||baidu(document.body).insertHTML("beforeend",'<div id="MaptoDown_tip" class="search-tip"><i title="关闭" class="close">关闭</i><div class="inner"><div class="lk-btn1"><a  href="javascript:void(0)">离线使用，省90%流量！</a></div></div><a  href="javascript:void(0)" class="moIndexTip"></a></div>'),baidu("#MaptoDown_tip").on("click",function(){e.open("IMG","检索框tip"),addStat("indexheader.clientdownpage.searchboxtip")}),baidu("#MaptoDown_tip i").on("click",function(o){e.removeTip(),o.stopPropagation(),o.preventDefault()})},removeTip:function(){var e=T.g("MaptoDown_tip");baidu.dom.remove(e),T.cookie.set("Maptodowntip","2",{expires:6048e5})}};i.exports=window.PcToMobile=s});
;define("common:widget/ui/moCMS/moCMS.js",function(o,n,e){function i(){r.cityCode||1;window.GRControll&&GRControll.clearGRMap();var o=r.cityCode==c["全国"]?!0:!1;return 0==r.supBus||o?(T.g("supBus").innerHTML=r.cityType<2||o?"请选择您要查询的城市":"抱歉，该城市不支持公交查询",!1):(T.g("supBus").innerHTML="",t.start_event=(new Date).getTime(),t.load("LinesQuery",{dom:baidu("#MapInfo")}),void 0)}function a(){baidu(".search_box a.mo_dl").on("click",function(n){o.async("common:widget/ui/Pc2Mobile/Pc2Mobile.js",function(o){o.open("IMG","搜索框链接")}),n.preventDefault()}),baidu("#blSearchLink").on("click",function(o){i(),o.preventDefault()})}var t=o("common:widget/com/componentManager.js"),c=o("common:widget/ui/areaCfg/areaCfg.js"),d=o("common:widget/ui/config/config.js"),r=d.modelConfig;e.exports={init:function(){var o=window._OLR?baidu.json.parse(window._OLR.index)||{}:{};if(o.mo&&o.mo.data&&o.mo.data.mo_text){var n=o.mo.data.mo_text,e=""!=o.mo.data.mo_color?'style="color:'+o.mo.data.mo_color+'"':"",i="<span>|</span>",t='<a class="mo_dl" onclick="addStat(\'indexheader.clientdownpage.searchboxlink\')" tid="mobileLink" '+e+">"+n+"</a>";""==n&&(i="",t="","2"!==T.cookie.get("Maptodowntip")&&T.cookie.set("Maptodowntip","2",{expires:94608e7})),T.G("moText").innerHTML=t,T.G("moTextBus").innerHTML=t+'<span id="blSearchLinkSpan">|</span><a  id="blSearchLink" >公交线路查询</a>',T.G("moTextDrive").innerHTML=t,a()}}}});
;define("common:widget/ui/sateCityList/SateCityList.js",function(i,t,e){var n=i("common:widget/ui/config/config.js"),o=i("common:widget/ui/areaCfg/areaCfg.js"),a=n.modelConfig,c=[],s={},r={},f={cities:["北京","上海","广州","深圳","兰州","南京","苏州","沈阳","太原","杭州","武汉","石家庄","郑州","天津","合肥","西安","重庆","长沙","济南","成都","巢湖","阜阳","贵阳","惠州","湖州","焦作","吉林市","金华","晋中","柳州","南充","南通","芜湖","邢台","漳州","南宁","汕头","唐山","大连","西宁","嘉兴","泉州","温州","洛阳","南昌","舟山","安阳","涿州","银川","信阳","濮阳","新乡","临汾","泰州","衡阳","盐城","滁州","九江","常德","聊城","珠海","黑河","蚌埠","桂林","七台河","鸡西","宜春","萍乡","吉安","佳木斯","加格达奇","本溪","牡丹江","荆门","孝感","咸宁","中山","三明","宁德","福州","酒泉","金昌","陇南","庆阳","张掖","马鞍山","黄山","六安","荆州","襄阳","十堰","齐齐哈尔","广元","西昌","保山","香格里拉县","克拉玛依","伊宁","丽江","蒙自县","楚雄","娄底","绍兴","开封","北海","衢州","通辽","扬州","镇江","葫芦岛","辽阳","自贡","阳江","喀什","库尔勒","博乐","阿勒泰","哈密","延安","巴彦淖尔","鄂尔多斯","赤峰","盘锦","营口","鄂州","泸州","攀枝花","遵义","天水","安顺","百色","奉化","伊春","溧阳","铜川","昭通","安康","张家界","曲靖","汕尾","梧州","长治","扬中","梅州","莱芜","河源","揭阳","大同","诸暨","上虞","东阳","林芝","景洪","济宁","朔州","长葛","松原","玉溪","新沂","哈尔滨","包头","青岛","即墨","张家口","启东","临沂","景德镇","佛山","乐山","香港特别行政区","龙岩","平安县","商洛","德令哈","六盘水","锦州","汉中","宣城","郴州","南平","眉山","双鸭山","平凉","周口","吕梁","丽水","广安","怀化","潮州","保定","莆田","嘉峪关","朝阳","烟台","黄冈","临安","宿迁","安庆","巴中","滨州","亳州","昌吉","长春","承德","池州","慈溪","从化","大理","大庆","大冶","德州","定西","东莞","东营","抚顺","阜新","噶尔县城","固原","贵港","海门","合作","菏泽","鹤岗","黄骅","黄石","江门","江阴","靖江","凯里","昆明","拉萨","廊坊","连云港","临沧","临海","内江","宁波","彭州","平顶山","普洱","秦皇岛","清远","三河","三亚","商丘","韶关","邵阳","中卫","石嘴山","四平","遂宁","台州","太仓","通化","铜陵","威海","渭南","乌海","乌鲁木齐","吴忠","武威","厦门","徐州","宣化","阳泉","宜宾","永州","余姚","玉林","湛江","淄博","上饶","宜兴","临夏回族自治州","宿州","德阳","淮南","随州","新余","榆林","瑞安","淮安","运城","茂名","增城","雅安","盖州","泰兴","沙河","鹤壁","南阳","泰安","常州","无锡","呼和浩特","沧州","呼伦贝尔","抚州","锡林浩特","绥化","丹东","东台","辽源","白银","三门峡","海晏县","资阳","许昌","塔城","衡水","恩施","株洲","晋城","丹阳","金坛","潍坊","日照","延吉","莱西","招远","岳阳","忻州","钦州","云浮","句容","大丰","赣州","枣庄","宜昌","绵阳","白城","宝鸡","乌兰察布","阿拉善左旗","吐鲁番","吐鲁番地区","邯郸","肇庆","海口","澳门特别行政区","鞍山","阿坝藏族羌族自治州","阿坝","湘潭","咸阳","汉中","东营","仪征"],special:{"涿州":2234,"西昌":684,"香格里拉县":1080,"伊宁":767,"蒙自县":894,"楚雄":105,"喀什":793,"库尔勒":736,"博乐":772,"阿勒泰":783,"哈密":985,"奉化":2833,"溧阳":1747,"扬中":2820,"诸暨":2708,"上虞":1467,"东阳":1472,"林芝":813,"景洪":901,"长葛":1262,"新沂":2421,"即墨":2181,"启东":1508,"平安县":578,"德令哈":992,"临安":1878,"昌吉":93,"慈溪":1879,"从化":1585,"大理":919,"大冶":1291,"噶尔县城":311,"海门":2580,"合作":386,"黄骅":2262,"江阴":2819,"靖江":1333,"凯里":2025,"临海":1460,"彭州":617,"三河":2721,"太仓":1934,"宣化":2361,"余姚":2215,"宜兴":1336,"瑞安":1882,"增城":2319,"盖州":1369,"泰兴":2894,"沙河":1667,"锡林浩特":550,"绥化":44,"东台":1739,"海晏县":571,"丹阳":1337,"金坛":2118,"延吉":495,"莱西":1836,"招远":2692,"句容":1322,"大丰":2108,"乌兰察布":168,"阿拉善左旗":2883,"吐鲁番":744,"仪征":2424,"阿坝":1070}},g=function(){c=f.cities,s=f.special;for(var i=0,t=c.length;t>i;i++){var e=c[i];o[e]?r[o[e]]=e:s[e]&&(r[s[e]]=e)}};e.exports={isSateMapSupportCity:function(i){return 0==c.length&&g(),a.cityType<2?!0:(i=parseInt(i,10),i&&r[i]?!0:!1)}}});
;define("common:widget/ui/ClearBase/ClearBase.js",function(e,a,n){function o(){var e=baidu(".smp_poi_btn"),a=baidu("#clearMapArea");e.hide(),a.show(),baidu("#clearMapArea").one("click",function(){e.show(),a.hide(),baidu("#form1 .search_input_text")[0].value="",baidu("#form2 .search_input_text")[0].value="",baidu("#form2 .search_input_text")[1].value="",baidu("#form3 .search_input_text")[0].value="",baidu("#form3 .search_input_text")[1].value="","City"!=window.currentComponent._className&&i.go("cur&wd="+encodeURIComponent(c.cityName),{cinfo:{from:"clear_btn",mapAreaChange:"no-change-map"}})})}var i=e("common:widget/com/componentManager.js"),t=e("common:widget/ui/config/config.js"),c=t.modelConfig,r={clearInit:function(){o()}};n.exports=r});
;define("common:widget/ui/Animation/Animation.js",function(t,i,n){function e(){}e.INFINITE="INFINITE",e.prototype.build=function(t){var i=this,n={duration:1e3,fps:30,delay:0,transition:s.linear,finish:function(){},onStop:function(){}};if(this._anis=[],t)for(var o in t)n[o]=t[o];return"number"==typeof n.delay?setTimeout(function(){i.start()},n.delay):n.delay!=e.INFINITE&&this.start(),this._opts=n,this},e.prototype.start=function(){this._beginTime=(new Date).getTime(),this._endTime=this._beginTime+this._opts.duration,this._launch()},e.prototype.add=function(t){this._anis.push(t)},e.prototype._launch=function(){var t=this,i=(new Date).getTime();if(i>=t._endTime){if(t._opts.render(t._opts.transition(1)),t._opts.finish(),t._anis.length>0){var n=t._anis[0];n._anis=[].concat(t._anis.slice(1)),n.start()}}else t.schedule=t._opts.transition((i-t._beginTime)/t._opts.duration),t._opts.render(t.schedule),t.terminative||(t._timer=setTimeout(function(){t._launch()},1e3/t._opts.fps))},e.prototype.stop=function(t){this.terminative=!0;for(var i=0;i<this._anis.length;i++)this._anis[i].stop(),this._anis[i]=null;this._anis.length=0,this._timer&&(clearTimeout(this._timer),this._timer=null),this._opts.onStop(this.schedule),t&&(this._endTime=this._beginTime,this._launch())},e.prototype.cancel=function(){this._timer&&clearTimeout(this._timer),this._endTime=this._beginTime,this.schedule=0},e.prototype.setFinishCallback=function(t){this._anis.length>0?this._anis[this._anis.length-1]._opts.finish=t:this._opts.finish=t};var s={linear:function(t){return t},reverse:function(t){return 1-t},easeInQuad:function(t){return t*t},easeInCubic:function(t){return Math.pow(t,3)},easeOutQuad:function(t){return-(t*(t-2))},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutQuad:function(t){return.5>t?t*t*2:-2*(t-2)*t-1},easeInOutCubic:function(t){return.5>t?4*Math.pow(t,3):4*Math.pow(t-1,3)+1},easeInOutSine:function(t){return(1-Math.cos(Math.PI*t))/2}};s["ease-in"]=s.easeInQuad,s["ease-out"]=s.easeOutQuad,n.exports={Animation:e,Transitions:s}});
;define("common:widget/ui/CMSUtil/cmsControl.js",function(require,exports,module){var config=require("common:widget/ui/config/config.js"),MapConfig=config.mapConfig,CmsControl={getPc2MoStr:function(type){var json=_OLR?baidu.json.parse(_OLR.index)||{}:{},compileStr="",imgMap={bus:"banner_bus",nav:"banner_driving",poi:"banner_poi"},cnMap={bus:"公交",nav:"驾车",poi:"POI"},imgStr=imgMap[type]?imgMap[type]:"",imgUrl="",template="",cn=cnMap[type]?cnMap[type]:"";return json.mo&&json.mo.data&&("city"==type?json.mo.data.banner_home&&(imgUrl=MapConfig.host(json.mo.data.banner_home),template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="addrBottomImg" ><a onclick="PcToMobile.open(\'IMG\', \'城市推广图片\');return false;" ><img src="',"undefined"==typeof img_url?"":img_url,'" width="323" height="100" /></a>    <a onclick="PcToMobile.open(\'BTN\', \'城市推广安卓按钮\', {qudao: \'1009177q\'});" class="pc2MoAndriod" href="http://www.baidu.com/search/error.html" target="andriodApk" title="点击将安装包下载到电脑，通过数据线安装到手机"></a>    <a onclick="PcToMobile.open(\'BTN\', \'城市推广ios按钮\');" class="pc2MoIphone" href="http://itunes.apple.com/cn/app/id452186370?ls=1&mt=8" title="点击前往苹果官方商店下载" target="_blank"></a></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],compileStr=template({img_url:imgUrl})):imgStr&&json.mo.data[imgStr]&&(imgUrl=MapConfig.host(json.mo.data[imgStr]),template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<a onclick="addStat(&#39;downloadapp.infowin.searchresultpromote&#39;);PcToMobile.open(&#39;IMG&#39;, &#39;',"undefined"==typeof log?"":log,'推广图片&#39;);" href="javascript:void(0);">    <img src="',"undefined"==typeof img_url?"":img_url,'" width="316" height="100"/></a><a class="pc2MoAndriodSearch" onclick="addStat(&#39;downloadappsucess.infowin.android&#39;);PcToMobile.open(&#39;BTN&#39;, &#39;',"undefined"==typeof log?"":log,'安卓按钮&#39;, {qudao: &#39;1009177q&#39;});" href="http://www.baidu.com/search/error.html"  target="andriodApk" title="点击将安装包下载到电脑，通过数据线安装到手机"></a><a class="pc2MoIphoneSearch" onclick="addStat(&#39;downloadappsucess.infowin.ios&#39;);PcToMobile.open(&#39;BTN&#39;, &#39;',"undefined"==typeof log?"":log,'ios按钮&#39;);" href="http://itunes.apple.com/cn/app/id452186370?ls=1&mt=8" title="点击前往苹果官方商店下载" target="_blank"></a>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],compileStr=template({img_url:imgUrl,log:cn}))),compileStr}};module.exports=CmsControl});
;define("common:widget/ui/AQIMgr/AQIMgr.js",function(n,i,o){var e=(n("common:widget/ui/util/util.js"),n("common:widget/ui/indexUtil/IndexUtil.js"),n("common:widget/ui/Weather/Weather.js"),n("common:widget/com/componentManager.js"),n("common:widget/ui/constant/Constant.js")),t=n("common:widget/ui/config/config.js"),a=t.modelConfig,c=baidu.g("air_quality_btn"),r={1:{name:"优",bgColor:"#6ec129"},2:{name:"良",bgColor:"#e0cf22"},3:{name:"轻度污染",bgColor:"#fd5b30"},4:{name:"中度污染",bgColor:"#e10724"},5:{name:"重度污染",bgColor:"#8f0c50"},6:{name:"严重污染",bgColor:"#410468"}},l={isOpen:!1,active:!1,aqiModel:null,show:function(){c.style.display="block"},hide:function(){c.innerHTML=""},setTool:function(n){var i,o=[],t='<span id="air_quality_level" style="background-color:#{0}">#{1}</span><span id="air_quality_value" >#{2}</span>';n.current_city&&n.current_city.city_type==e.CITY_TYPE_CITY?(i=r[n.current_city.level],o=[i.bgColor,i.name,n.current_city.aqi],c.innerHTML=baidu.string.format(t,o)):c.innerHTML=""},setAqi:function(n){var i=window.currentComponent,o=a.cityCode;i&&"AQIMap"==i._className&&(1==o||1!=o&&o!=i.cityCode)&&i.update(n)},set:function(n,i){window.isPrint||(n?(this.setTool(n),this.setAqi(n,i)):c.innerHTML="")},load:function(){},loadAQICmp:function(){},revert:function(){},isActive:function(){var n=window.currentComponent,i=!1;return i=n&&"AQIMap"==n._className?!0:!1}};o.exports=l});