define("common:widget/pano/module/VideoPlayer/PlayerControls.js",function(require,exports,module){var template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="close-btn"></div><div class="loading-mask"><i></i><i></i><i></i><i></i></div><div class="video-controls"><div class="left-btn play"><div class="line"></div><div class="line"></div><div class="line"></div><div class="tooltip"></div></div><div class="progress"><div class="currentTime">00:00</div><div class="maxTime">00:00</div><div class="progress-bar" style="width:0;"><div class="progress-bar-btn"><div class="progress-bar-btn-inner"></div></div></div></div><div class="right-btn"><div class="share-btn"><div class="tooltip"></div></div><div class="fullscreen-btn"><div class="tooltip"></div></div></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],getFormatedTime=function(e){e=parseInt(e);var t=parseInt(e/60),n=e%60;return 9>=t&&(t="0"+t),9>=n&&(n="0"+n),t+":"+n},PlayerControls=function(e){var t="left-btn play",n="left-btn pause",i=this,a=0,s=0,r=0,o=0,l=!1,c=0;e.innerHTML=template();var d=e.querySelector(".video-controls"),u=e.querySelector(".loading-mask"),v=e.querySelector(".close-btn"),m=d.querySelector("http://webmap0.map.bdstatic.com/newmap/static/common/widget/pano/module/VideoPlayer/.left-btn.play"),p=d.querySelector(".progress"),f=d.querySelector(".right-btn"),h=d.querySelector(".currentTime"),g=d.querySelector(".maxTime"),y=d.querySelector(".progress-bar"),_=d.querySelector(".progress-bar-btn");e.appendChild(d),this.onProgressChange=function(){},this.onProgressChangeBefore=function(){},this.onProgressChangeAfter=function(){},this.onBtnClick=function(){};var T=function(){var e=r/a;y.style.width=r+"px",h.innerText=getFormatedTime(c*e)},b=function(e){0>e&&(e=0),e>a&&(e=a),e!==r&&(r=e,u.innerText=parseInt(r/a*100)+"%",i.onProgressChange(r/a),T())};this.play=function(){m.className=n,i.onBtnClick("play"),i.displayLoading(!1)},this.pause=function(){m.className=t,i.onBtnClick("pause"),i.displayLoading(!0,"pause")},this.replay=function(){i.onBtnClick("repeat")},this.setProgressPercent=function(e){r=e*a,T()},this.setMaxTime=function(e){c=e,g.innerText=getFormatedTime(e)},this.showControls=function(){d.style.bottom="0px",v.style.top="0px"},this.hideControls=function(){d.style.bottom="",v.style.top=""},this.unactiveShareBtn=function(){d.querySelector(".share-btn").className="share-btn"},this.displayLoading=function(e,t){if(u.className=e?"loading-mask":"loading-mask hide",e&&t)switch(t){case"pause":u.innerHTML='<div class="play"><div class="line"></div></div>';break;case"finish":u.innerHTML='<div class="repeat"></div><div class="share"></div>';break;case"loading":u.innerHTML="<i></i><i></i><i></i><i></i>";break;default:u.innerHTML=""}},this.resize=function(){u.style.lineHeight=u.clientHeight+"px",a=p.clientWidth};var A=function(e){var t=s+(e.pageX-o);b(t)},S=function(e){l||(l=!0,document.body.addEventListener("mousemove",A,!1),document.body.addEventListener("mouseup",C,!1),o=e.pageX,s=y.clientWidth,i.displayLoading(!0),i.onProgressChangeBefore())},C=function(){l=!1,document.body.removeEventListener("mousemove",A,!1),document.body.removeEventListener("mouseup",C,!1),i.displayLoading(!0,"loading"),i.onProgressChangeAfter(r/a)};_.addEventListener("mousedown",function(e){S(e)}),v.addEventListener("click",function(){i.onBtnClick("close"),addStat(STAT_CODE.STAT_PANORAMA,{item:"video.action.close"})}),p.addEventListener("click",function(e){"progress-bar-btn"!==e.target.className&&(i.displayLoading(!0),i.onProgressChangeBefore(),b(e.layerX),i.onProgressChangeAfter(r/a))}),m.addEventListener("click",function(){this.className===t?(i.play(),addStat(STAT_CODE.STAT_PANORAMA,{item:"http://webmap0.map.bdstatic.com/newmap/static/common/widget/pano/module/VideoPlayer/video.action.play"})):this.className===n&&(i.pause(),addStat(STAT_CODE.STAT_PANORAMA,{item:"video.action.pause"}))}),f.addEventListener("click",function(e){var t=e.target.className;"share-btn"===t?(i.onBtnClick("share"),e.target.className="share-btn active",addStat(STAT_CODE.STAT_PANORAMA,{item:"video.action.share"})):"fullscreen-btn"===t&&(i.onBtnClick("fullscreen"),addStat(STAT_CODE.STAT_PANORAMA,{item:"video.action.fullscreen"}))}),u.addEventListener("click",function(e){var t=e.target.className;"play"===t?i.play():"repeat"===t?i.replay():"share"===t&&(i.onBtnClick("share"),d.querySelector(".share-btn").className="share-btn active",addStat(STAT_CODE.STAT_PANORAMA,{item:"video.action.share"}))}),this.destory=function(){e.innerHTML="",d=null,u=null,v=null,m=null,p=null,f=null,h=null,g=null,y=null,_=null}};module.exports=PlayerControls});