define("common:widget/pano/module/VideoPlayer/Player.js",function(e){var a=e("common:widget/pano/module/VideoPlayer/PlayerControls.js"),n={loading:0,playing:1,pause:2,stop:3},r=function(e,r){var i=this;this.duration=0,this.time=0;var t=n.loading,s=this.frame=document.createElement("div");s.className="player-frame";var l=function(){document.webkitIsFullScreen?(s.className="player-frame fullscreen",o.resize()):(s.className="player-frame",o.resize())};document.addEventListener("webkitfullscreenchange",l);var o=new a(s),d=0;o.onProgressChangeBefore=function(){clearInterval(d),c.pause()},o.onProgressChangeAfter=function(e){c.currentTime=i.duration*e,t===n.playing||o.displayLoading(!0,"pause")},o.onBtnClick=function(a){switch(a){case"play":c.play(),o.displayLoading(!1),clearInterval(d),d=setInterval(function(){o.setProgressPercent(c.currentTime/c.duration)},16),t=n.playing;break;case"pause":clearInterval(d),c.pause(),t=n.pause;break;case"repeat":c.currentTime=0,this.play();break;case"share":i.fire("share",[s]);break;case"fullscreen":document.webkitIsFullScreen?document.webkitCancelFullScreen():s.parentNode.webkitRequestFullScreen();break;case"close":clearInterval(d),c.pause(),t=n.stop,document.removeEventListener("webkitfullscreenchange",l),document.webkitIsFullScreen&&document.webkitCancelFullScreen(),o.destory(),e.removeChild(s),i.frame=null,i.video=null,i.fire("close")}};var c=this.video=document.createElement("video");c.className="video-player",s.appendChild(c),e.appendChild(s),c.addEventListener("durationchange",function(){i.fire("ready"),i.duration=this.duration,o.setMaxTime(this.duration),o.showControls(),o.resize()}),c.addEventListener("ended",function(){o.displayLoading(!0,"finish")}),c.addEventListener("loadstart",function(){o.displayLoading(!0)}),c.addEventListener("loadeddata",function(){o.displayLoading(!0)}),c.addEventListener("canplay",function(){t===n.playing?(o.displayLoading(!1),c.play()):t===n.pause?o.displayLoading(!0,"pause"):t===n.loading&&o.displayLoading(!0,"pause")}),c.controls=!1,c.preload=!0,c.src=r.src,this.onShareClose=function(){o.unactiveShareBtn()}};return T.lang.inherits(r,T.lang.Class),r});