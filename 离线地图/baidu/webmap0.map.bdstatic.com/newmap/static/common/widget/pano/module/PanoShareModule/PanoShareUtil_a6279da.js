define("common:widget/pano/module/PanoShareModule/PanoShareUtil.js",function(e,n,t){var o=e("common:widget/ui/config/config.js"),a=o.urlConfig,r={SHARE_PROC_URL:"http://j.map.baidu.com/",getShareKeyList:function(){return{tsina:{title:"分享到新浪微博",code:1307,cbkcode:1317},tqq:{title:"分享到腾讯微博",code:1308,cbkcode:1318},qzone:{title:"分享到QQ空间",code:1306,cbkcode:1316},renren:{title:"分享到人人网",code:1309,cbkcode:1319},baidu:{title:"分享到百度搜藏",code:1310,cbkcode:1320},kaixin001:{title:"分享到开心网",code:1311,cbkcode:1321},hi:{title:"分享到百度空间",code:1312,cbkcode:1322},douban:{title:"分享到豆瓣网",code:1313,cbkcode:1323},tsohu:{title:"分享到搜狐微博",code:1314,cbkcode:1324},msn:{title:"分享到Myspace",code:1315,cbkcode:1325},fx:{title:"分享到飞信",code:1326,cbkcode:1327}}},getLink:function(e,n){var t=[];for(var o in e)null!=e[o]&&t.push(o+"="+e[o]);var a="http://map.baidu.com/?newmap=1&shareurl=1&"+t.join("&"),r=this.SHARE_PROC_URL+"?url="+encodeURIComponent(a)+"&web=true",i=!1;T.jsonp(r,function(e){i=!0,n(e&&e.url||a)}),setTimeout(function(){0==i&&n(a)},3e3)},get2DCode:function(e){var n=a.PANO_URL+"?qt=qrcode&width=66&url=";return n+encodeURIComponent(e)},creatShare:function(e,n){var t=this,o=this.getShareKeyList(),a=['<div id="pano_bdshare" class="bds_tools"><span class="bds_more">分享到：</span>'];for(var r in o){var i=o[r].title;a.push('<a _key="'+r+'" class="bds_'+r+'" title="'+i+'"></a>')}a.push('</div><span class="bds_btn_arr" id="pano_bds_btn_arr" title="更多网站"></span>'),e.innerHTML=a.join("");{var c=T.G("pano_bdshare"),d=T.G("pano_bds_btn_arr");c.getElementsByTagName("a")}d.onclick=function(){var e=178,n=120,o=15,a=0;!function r(){o>a&&(a++,c.style.width=Math.ceil(t._tween(a,e,n,o))+"px",setTimeout(r,10))}(),d.style.display="none"},T.on(c,"click",function(e){var o=e.target||e.srcElement,a=o.getAttribute("_key");o&&a&&t._openLink(window.open("about:blank"),a,n)})},_tween:function(e,n,t,o){return t*((e=e/o-1)*e*e+1)+n},_openLink:function(e,n,t){if(e){var o=t(),a=this._getShareInfo(o.roadName,o.link),r=a.text,i=(a.point,o.link+"#bshare-"+n);"fx"==n&&(i=i);var c="";("qzone"==n||"tsohu"==n)&&(imgSrc="../../../../../../../../map.baidu.com/image/logo-map.png"/*tpa=http://map.baidu.com/image/logo-map.png*/),imgSrc=this.getPanoShare3DImageUrl(o.data),c=r;var d={to:n,url:i,pic:imgSrc,title:r,type:"text",desc:c,comment:" ",key:""};"tsina"==n&&(d.key="3694297746"),"tqq"==n&&(d.key="801199301");var p="http://share.baidu.com/s?"+this._jsonToQuery(d,encodeURIComponent);"renren"==n&&(d={resourceUrl:i,pic:imgSrc,title:r,description:c,charset:"UTF-8"},p="http://widget.renren.com/dialog/share?"+this._jsonToQuery(d,encodeURIComponent));try{e.location.href=p,e.focus()}catch(s){}}},_getShareInfo:function(e,n){{var t=e||"",o="【百度全景】";this.cinfo}return{text:t+" "+n+" "+o}},_jsonToQuery:function(e,n){var t=[];n=n||function(e){return e};for(var o in e){var a=e[o];""!=a&&null!=a&&"undefined"!=typeof a&&t.push(o+"="+n(a))}return t.join("&")},getPanoShare3DImageUrl:function(e){var n=a.PANO_URL+"?qt=share",t={panoid:e.panoId,heading:e.panoHeading,pitch:e.panoPitch,fovy:75,width:460,height:250,watermark:"baidumap",quality:80};for(var o in t)n=n+"&"+o+"="+t[o];return n},prepareShareParam:function(e){var n=e.data,t=n.panoMCPoint,o=(100*t.x+","+100*t.y,e.iid),a="";a="inter"===n.panoType?o:n.panoId;var r={panoid:a,panotype:n.panoType,heading:n.panoHeading,pitch:n.panoPitch,l:e.level,tn:"B_NORMAL_MAP",sc:0,newmap:1,shareurl:1};"inter"==n.panoType?(r.pid=n.panoId,r.iid=o):r.pid=n.panoId;var i={},c=!1;if(e.shareParam){for(var d in e.shareParam)(void 0!==e.shareParam[d]||null!==e.shareParam[d])&&(c=!0,i[d]=e.shareParam[d]);c&&(r.psp=encodeURIComponent(T.json.stringify(i)))}if(i.TrafficModule&&window.currentComponent&&("NavTrans"==currentComponent.name||"BusTrans"==currentComponent.name||"NavWalk"==currentComponent.name)){var p=window.currentComponent,s=p.modelQuery.replace(/&b=\((-?\d+)(\.\d+),(-?\d+)(\.\d+);(-?\d+)(\.\d+),(-?\d+)(\.\d+)\)/gi,"");r.s=encodeURIComponent(decodeURIComponent(s))}return r}};t.exports=r});