define("common:widget/ui/genericRequest/GenericRequest.js",function(require,exports,module){function GenRequest(){T.lang.Class.call(this),this.json=null,this.gInfo={},this.qWord="",this.qCity=-1,this.listeners={},this.isGRequest=!1,this.isableGenUIRequest=!0,this.isableGRequestByMapChanged=!0,this.genDataLst={},this.spotId="",this.genDataIdLis=[],this.isableGenMDRequest=!1,this.curTileMapId="",this.mouseOnTileTime=null,this.spotOnId="",this.gssSubmitId="",this.mdLabel1=null,this.mdMarker1=null,this.mdLabel2=null,this.mdMarker2=null,this.toolAreaId="GR_Select",this.GRMapId="",this.areaCity="",this.areaDistrict="",this.GRCircleRadius=1e3,this.isGRCircleShow=!0,this.spotOverUid="",this.isClearBeforeSend=!0,this.queryStr="",this.uiPermit=1e3,this.openedMarker=null,this.curSearchCPt=null,this.types={36:{t:1},37:{t:2},38:{t:1},39:{t:1},40:{t:2}},this.ifShowCustonTip=!1,this.disabledGR=!1,this.initialize()}var util=require("common:widget/ui/util/util.js"),config=require("common:widget/ui/config/config.js"),constant=require("common:widget/ui/constant/Constant.js"),mapInfo=require("common:widget/ui/mapInfo/mapInfo.js"),comMgr=require("common:widget/com/componentManager.js"),fullScreenCtrl=require("common:widget/ui/fullScreen/fullScreen.js"),place=require("common:widget/ui/place/place.js"),indexUtil=require("common:widget/ui/indexUtil/IndexUtil.js"),searchData=require("common:widget/ui/searchData/searchData.js"),Share=require("common:widget/ui/mapShare/MapShare.js"),PanoUtil=require("common:widget/ui/PanoUtil/PanoUtil.js"),modelConfig=config.modelConfig,MapConfig=config.MapConfig,GR_ICON=new BMap.Icon(constant.A_J_MARKER_IMG,new BMap.Size(15,17),{offset:new BMap.Size(7,20),imageOffset:new BMap.Size(-152,-176),infoWindowOffset:new BMap.Size(7,2)});T.extend(GenRequest.prototype,{initialize:function(e){try{for(var t in e)"undefined"!=typeof e[t]&&(this[t]=e[t]);this.clearCache()}catch(n){"undefined"!=typeof alog&&alog("http://webmap0.map.bdstatic.com/newmap/static/common/widget/ui/genericRequest/exception.fire","catch",{msg:n.message||n.description,path:"common:widget/ui/genericRequest/GenericRequest.js",ln:138})}},setGRData:function(e,t){return this.disabledGR?(this.clearCache(),void this.clearGRMap()):void(e&&(this.json=e,this.gInfo=t||{},this.clearListener(),this.resetStatus()))},resetStatus:function(){var e=this.json.result.type.toString();this.types[e]&&(this.isGRequest=!0,1==this.types[e].t?(this.addGRMap(),this.addMDRequest(),this.addTip()):2==this.types[e].t&&(this.clearGRMap(),this.clearListener()),this.addMDEvent(),this.curSearchCPt=map.centerPoint)},addTip:function(){if(this.ifShowCustonTip){var e=util.getClientSize().width;"open"==mapInfo.status&&(e-=310),this.ifShowCustonTip=!1}},clearBeforeSendAtBase:function(){this.isClearBeforeSend?this.clearListener():this.isClearBeforeSend=!0},clearAfterGetAtBase:function(e){var t={36:"poiSearch",38:"circleSearch",39:"searchInView"},n={18:"busLine",6:"busLineStop",27:"rightClick"},i=e.result.type;if((2!=i||!e.content||0!=e.content.error)&&i&&!t[i]){if(n[i])return;var a=e.result.return_query||"",r=e.result.wd2||"";(this.qWord!=a+"_"+r||this.qCity!=modelConfig.cityCode)&&(this.genDataLst={},this.genDataIdLis=[]),this.qWord="",this.qCity=-1,this.clearGRMap(),this.openedMarker=null}},clearCache:function(){var e=this;e.isableGenUIRequest=!0,e.isableGRequestByMapChanged=!0,e.isGRequest=!1,e.genDataLst={},e.genDataIdLis=[],e.isableGenMDRequest=!1,e.curTileMapId="",e.mouseOnTileTime=null,e.spotOnId="",e.gssSubmitId="",e.spotOverUid="",e.mdLabel1&&e.mdLabel1.hide(),e.mdLabel2&&e.mdLabel2.hide(),e.mdMarker1&&e.mdMarker1.hide(),e.mdMarker2&&e.mdMarker2.hide(),e.clearListener(),""!=e.spotId&&(map.removeSpots(e.spotId),e.spotId="")},checkEventBind:function(e,t,n,i){return e?t[n]&&t[n]==i?!1:(t[n]=i,!0):t[n]&&t[n]==i?(t[n]="",delete t[n],!0):!1},clearListener:function(e){var t=this;e&&"md"!=e||(t.checkEventBind(!1,t.listeners,"map_mousemove","addMouseOnMDEvent")&&setTimeout(function(){map.removeEventListener("mousemove",t.addMouseOnMDEvent)},0),t.checkEventBind(!1,t.listeners,"map_spotmouseover","spotMouseOverMD")&&setTimeout(function(){map.removeEventListener("spotmouseover",t.spotMouseOverMD)},5),t.checkEventBind(!1,t.listeners,"map_spotmouseout","spotMouseOutMD2")&&setTimeout(function(){map.removeEventListener("spotmouseout",t.spotMouseOutMD2)},10)),e&&"ui"!=e||(t.checkEventBind(!1,t.listeners,"map_load","bindGenResLoad")&&map.removeEventListener("load",t.bindGenResLoad),t.checkEventBind(!1,t.listeners,"map_moveend","bindGenResMove")&&map.removeEventListener("moveend",t.bindGenResMove),t.checkEventBind(!1,t.listeners,"map_zoomend","bindGenResZoom")&&map.removeEventListener("zoomend",t.bindGenResZoom),t.checkEventBind(!1,t.listeners,"map_mapcontainerresize","bindGenResResize")&&map.removeEventListener("mapcontainerresize",t.bindGenResResize))},clearGRMap:function(){if(""!=this.GRMapId){var e=map.getTileLayer(this.GRMapId);e&&(map.removeTileLayer(e),this.GRMapId="",this.qWord="",this.qCity=-1,this.genDataLst={},this.genDataIdLis=[])}},addGRMap:function(){var e=this;if(e.json){var t=e.json.result.return_query||"",n=e.json.result.wd2||"";if(e._getPlaceParam||(e._getPlaceParam=function(t){var n=t.place_info,i=!1;if(n)for(var a in n)/_section$/.test(a)&&n[a]!=e._getPlaceParam[a]&&(e._getPlaceParam[a]=n[a],i=!0);return i}),e.qWord!=t+"_"+n||e.qCity!=modelConfig.cityCode||window.place&&place.result&&e._getPlaceParam(e.json)){if(e.clearGRMap(),38==e.json.result.type&&map.zoomLevel<11)return;e.qWord=t+"_"+n,e.qCity=modelConfig.cityCode;var i=new BMap.Bounds(-21364736,-10616832,23855104,15859712),a=new BMap.Copyright(i),r=!1,o=new BMap.TileLayer({copyright:a,transparentPng:r,requestMonitor:!0,monitorOpts:{seed:.02,name:"md"}});o.zIndex=1,o.getTilesUrl=function(t,n){var i=BMap.MapType[this.getMapType()];if("object"!=typeof i)return null;var a=i.baseUnits*Math.pow(2,18-n),o=parseInt(t.lng/a),s=parseInt(t.lat/a),d="",m=["http://gss0.map.baidu.com/","http://gss1.map.baidu.com/","http://gss2.map.baidu.com/","http://gss3.map.baidu.com/"],l=Math.abs(o+s)%m.length;d=modelConfig.DATA_URL+"bkg_png&c="+modelConfig.cityCode+"&ie=utf-8",window.place&&(d+=place.urlArr?"&wd="+encodeURIComponent(e.json.result.return_query)+place.urlArr:"&wd="+encodeURIComponent(e.json.result.return_query)),e.json.result.wd2&&(d+="&wd_h="+encodeURIComponent(e.json.result.wd2));var u=map.getBounds(),p=Math.min(u.minX,u.maxX),c=Math.max(u.minX,u.maxX),h=Math.min(u.minY,u.maxY),f=Math.max(u.minY,u.maxY),M=escape("(")+p+","+h+";"+c+","+f+escape(")");return d+="&l="+n+"&xy="+o+"_"+s+"&b="+M+"&t="+(new Date).getTime(),r&&T.browser.ie>5&&T.browser.ie<7&&(d=encodeURIComponent(d)),d=m[l]+d},map.addTileLayer(o),e.GRMapId=o.getMapType()}}},addMDRequest:function(){var me=this;me.addMouseOnMDEvent||(me.addMouseOnMDEvent=function(e){var t=map.getTileId(e.point,map.getZoom());if(t.row&&t.column&&t.level){var n=t.level+"_"+t.row+"_"+t.column;if(me.curTileMapId=n,me.genDataLst[n]){if(me.spotOnId!=n){""!=me.spotId&&map.removeSpots(me.spotId),me.spotId=map.addSpots(me.genDataLst[n]),me.spotOnId=n;for(var i=-1,a=0,r=me.genDataIdLis.length;r>a;a++)if(n==me.genDataIdLis[a]){i=a;break}i>=0&&(me.genDataIdLis.splice(i,i),me.genDataIdLis.push(n))}}else if(me.json.result.return_query&&me.gssSubmitId!=t.level+"_"+t.row+"_"+t.column){me.gssSubmitId=t.level+"_"+t.row+"_"+t.column;var o=[];o.push("http://gss3.map.baidu.com/"+modelConfig.DATA_URL),window.place&&o.push(place.urlArr?"bkg_data&c="+modelConfig.cityCode+"&ie=utf-8&wd="+encodeURIComponent(me.json.result.return_query)+place.urlArr:"bkg_data&c="+modelConfig.cityCode+"&ie=utf-8&wd="+encodeURIComponent(me.json.result.return_query)),me.json.result.wd2&&o.push("&wd_h="+encodeURIComponent(me.json.result.wd2));var s=map.getBounds(),d="("+s.minX+","+s.minY+";"+s.maxX+","+s.maxY+")";o.push("&l="+map.zoomLevel+"&xy="+t.row+"_"+t.column+"&b="+d),T.jsonp(o.join(""),function(e,t){e&&(t.slow?ErrorMonitor("md_data","req_slow"+t.slow,o,.02,{xhr:t,url:o,type:"slow"}):ErrorMonitor("md_data","succ",o,.02,{xhr:t,url:o,type:"succ"}),window.GRControll.getGRData(e))},{error:function(e){ErrorMonitor("md_data","req_fail","",.02,{type:"fail",url:o,xhr:e})}}),ErrorMonitor("md_data","BASE","",.02)}}}),me.spotMouseOverMD||(me.spotMouseOverMD=function(e){if(!PanoUtil.isPanoStatus()){var spotArr=e.spots;if(spotArr&&!(spotArr.length<1)&&spotArr[0].tag&&"GR_DATA"==spotArr[0].tag){if(me.json&&me.json.content)for(var i=0,n=me.json.content.length;n>i;i++)for(var j=0,nn=spotArr.length;nn>j;j++)if(spotArr[j].userdata.uid==me.json.content[i].uid)return;var tempMarker=null,tempLabel=null,mindex=0;me.onMarker&&me.onMarker===me.mdMarker1?(tempMarker=me.mdMarker2,tempLabel=me.mdLabel2,mindex=2):(tempMarker=me.mdMarker1,tempLabel=me.mdLabel1,mindex=1),tempMarker&&tempMarker.map?(tempMarker.hide(),tempMarker.setPoint(spotArr[0].pt),tempMarker.show(),me.spotOverUid=spotArr[0].userdata.uid):(tempMarker=new BMap.Marker(spotArr[0].pt,{icon:GR_ICON,zIndexFixed:!0,baseZIndex:3e6}),me.spotOverUid=spotArr[0].userdata.uid,map.addOverlay(tempMarker),eval("me.mdMarker"+mindex+" = tempMarker"),tempMarker.addEventListener("click",me.spotClickMD),tempMarker.addEventListener("mouseout",me.spotMouseOutMD));for(var laStr=[],i=0,n=spotArr.length;n>i;i++)laStr.push(spotArr[i].userdata.name);tempLabel&&tempLabel.map?(tempMarker.getLabel()||tempMarker.setLabel(tempLabel),tempLabel.hide(),tempLabel.setContent(laStr.join("<br />")),tempLabel.show()):(tempLabel=new BMap.Label(laStr.join("<br />"),{offset:new BMap.Size(10,-24)}),tempMarker.setLabel(tempLabel),eval("me.mdLabel"+mindex+" = tempLabel"),tempLabel.setStyle({backgroundColor:"#FFFFD5",borderColor:"#808080"}))}}}),me.spotMouseOutMD||(me.spotMouseOutMD=function(){if(!PanoUtil.isPanoStatus()&&(me.mdLabel1&&me.mdLabel1.hide(),me.mdLabel2&&me.mdLabel2.hide(),me.onMarker!==this))if(map.temp.infoWin&&1==map.temp.infoWin.isOpen()){if(map.temp.infoWin.overlay===this)return;this.hide()}else this.hide(),me.spotOverUid=""}),me.spotMouseOutMD2||(me.spotMouseOutMD2=function(){if(!PanoUtil.isPanoStatus()){var e=me.mdMarker2;if(e&&e.map&&(!map.temp.infoWin||0==map.temp.infoWin.isOpen()||map.temp.infoWin.overlay!==e)){if(me.onMarker&&me.onMarker===e)return;e.hide()}if(e=me.mdMarker1,e&&e.map&&(!map.temp.infoWin||0==map.temp.infoWin.isOpen()||map.temp.infoWin.overlay!==e)){if(me.onMarker&&me.onMarker===e)return;e.hide()}}}),me.spotClickMD||(me.spotClickMD=function(){PanoUtil.isPanoStatus()||""!=me.spotOverUid&&(map.temp.infoWin&&map.temp.infoWin.close(),me.onMarker=this,util.loadSearchInfo(function(e){me.sendInfoRequest(me.spotOverUid,e)}),addStat(STAT_CODE.STAT_GR_MARKER_CLICK,{uid:me.spotOverUid,ct:"spot"}))}),setTimeout(function(){me.checkEventBind(!0,me.listeners,"map_mousemove","addMouseOnMDEvent")&&map.addEventListener("mousemove",me.addMouseOnMDEvent)},10),setTimeout(function(){me.checkEventBind(!0,me.listeners,"map_spotmouseover","spotMouseOverMD")&&map.addEventListener("spotmouseover",me.spotMouseOverMD)},20),setTimeout(function(){me.checkEventBind(!0,me.listeners,"map_spotmouseout","spotMouseOutMD2")&&map.addEventListener("spotmouseout",me.spotMouseOutMD2)},30)},sendInfoRequest:function(e,t){if(e){var n=this;Share.listIndex="uid,"+e;var i="inf&uid="+e+"&ie=utf-8&t="+(new Date).getTime();searchData.fetch(i,function(e){var i=e.content,a=util.getPointByStr(util.parseGeo(i.geo).points);if(!r)var r={};var o=i.addr;(i.poiType==constant.POI_TYPE_BUSSTOP||i.poiType==constant.POI_TYPE_SUBSTOP)&&(o=T.array.unique(o.split(";")).join("; "));var s=i.tel;s&&(s=s.replace(/,/g,", "));var d=n._getCateInfo(i.cla),m={};i.ext&&i.ext.detail_info&&i.ext.detail_info.origin_id&&(m=i.ext.detail_info.origin_id);var l=t.createSearchInfoWnd({title:i.name,addr:o,tel:s,uid:i.uid,cate:d,ext_type:i.ext_type,detail:i.detail,poiType:i.poiType,hasDetail:i.detail&&i.ty==constant.GEO_TYPE_POINT||i.poiType==constant.POI_TYPE_BUSLINE||i.poiType==constant.POI_TYPE_SUBLINE,ext:i.ext,cp:i.cp,cla:i.cla,origin_id:m,pano:i.pano||0,indoor_pano:i.indoor_pano||0,catId:i.new_catalog_id},{cityCode:n.sCityCode,x:a.lng,y:a.lat});if(l){if(n.openedMarker={uid:i.uid,geo:i.geo,name:i.name},l.addEventListener("open",function(){window.spotInfoWnd=!0,n.setGRequestFlg(1500),l.closeButton&&T.on(l.closeButton,"click",function(){map.temp.infoWin.overlay&&map.temp.infoWin.overlay.hide(),n.onMarker=null,n.openedMarker=null,T.un(l.closeButton,"click",arguments.callee)}),l.removeEventListener("open",arguments.callee)}),l.addEventListener("close",function(){window.spotInfoWnd=!1,n.mdLabel1&&n.mdLabel1.hide(),n.mdLabel2&&n.mdLabel2.hide(),map.temp.infoWin.overlay&&map.temp.infoWin.overlay.hide(),Share.listIndex="",n.onMarker=null,n.openedMarker=null,l.removeEventListener("close",arguments.callee)}),n.onMarker)r.from="gr",t.openSearchInfoWnd(l,n.onMarker,r);else if(!n.mdMarker1){var u=util.getPointByStr(util.parseGeo(i.geo).points);n.mdMarker1=new BMap.Marker(u,{icon:GR_ICON,zIndexFixed:!0}),map.addOverlay(n.mdMarker1),n.mdMarker1.addEventListener("click",n.spotClickMD),n.mdMarker1.addEventListener("mouseout",n.spotMouseOutMD),t.openSearchInfoWnd(l,n.mdMarker1,r)}n.mdLabel1&&n.mdLabel1.hide(),n.mdLabel2&&n.mdLabel2.hide()}})}},setGRequestFlg:function(e){var t=this;t.isableGRequestByMapChanged=!1,setTimeout(function(){t.isableGRequestByMapChanged=!0},e)},ifChangeMap:function(){if(!this.json)return{f:0};if(1==this.json.result.op_gel){var e=new BMap.Point(this.json.result.res_x,this.json.result.res_y);return{f:1,p:e,l:this.json.result.res_l}}return{f:2}},getGRData:function(e){if(e&&!(e.err_no<0)){for(var t=[],n=0,i=e.uids.length;i>n;n++)t.push({pt:new BMap.Point(e.uids[n].x,e.uids[n].y),bd:[-7,0,7,17],userdata:{name:e.uids[n].name,uid:e.uids[n].uid},tag:"GR_DATA"});var a=e.tileid;if(this.genDataLst[a]=t,this.genDataIdLis.push(a),this.genDataIdLis.length>30){var r=this.genDataIdLis.shift();delete this.genDataLst[r],delete r}this.spotOnId!=this.curTileMapId&&(""!=this.spotId&&map.removeSpots(this.spotId),this.genDataLst[this.curTileMapId]&&(this.spotId=map.addSpots(this.genDataLst[this.curTileMapId]),this.spotOnId=this.curTileMapId))}},hideMarkerByIW:function(){var e=this,t=!1;t=map.temp.infoWin&&1==map.temp.infoWin.isOpen(),t&&map.temp.infoWin.overlay===e.mdMarker1?(e.mdLabel2&&e.mdLabel2.hide(),e.mdMarker2&&e.mdMarker2.hide()):t&&map.temp.infoWin.overlay===e.mdMarker2?(e.mdLabel1&&e.mdLabel1.hide(),e.mdMarker1&&e.mdMarker1.hide()):(e.mdLabel1&&e.mdLabel1.hide(),e.mdLabel2&&e.mdLabel2.hide(),e.mdMarker1&&e.mdMarker1.hide(),e.mdMarker2&&e.mdMarker2.hide())},checkMove:function(){var e=this;if(!e.curSearchCPt||mapInfo&&mapInfo.isGoing||fullScreenCtrl&&fullScreenCtrl.isGoing)return!1;var t=map.pointToPixel(e.curSearchCPt),n=map.pointToPixel(map.centerPoint),i=Math.abs(t.x-n.x),a=Math.abs(t.y-n.y);return i>=.2*map.width||a>=.2*map.height?!0:!1},addMDEvent:function(){var e=this;e.clearListener(),e.bindGenResLoad||(e.bindGenResLoad=function(){e.hideMarkerByIW(),e.sendGenRequest()}),e.bindGenResDrag||(e.bindGenResDrag=function(){1==e.checkMove()&&e.sendGenRequest("&gr=2")}),e.bindGenResMove||(e.bindGenResMove=function(){1==e.checkMove()&&e.sendGenRequest("&gr=2")}),e.bindGenResZoom||(e.bindGenResZoom=function(){e.hideMarkerByIW(),e.sendGenRequest("&gr=1")}),e.bindGenResResize||(e.bindGenResResize=function(){e.mdLabel&&e.mdLabel.hide(),e.mdMarker&&e.mdMarker.hide(),e.sendGenRequest()}),e.checkEventBind(!0,e.listeners,"map_load","bindGenResLoad")&&map.addEventListener("load",e.bindGenResLoad),e.checkEventBind(!0,e.listeners,"map_moveend","bindGenResMove")&&map.addEventListener("moveend",e.bindGenResMove),e.checkEventBind(!0,e.listeners,"map_zoomend","bindGenResZoom")&&map.addEventListener("zoomend",e.bindGenResZoom),e.checkEventBind(!0,e.listeners,"map_mapcontainerresize","bindGenResResize")&&map.addEventListener("mapcontainerresize",e.bindGenResResize)},sendGenRequest:function(e){var t=this,n=window;if(t.curSearchCPt=map.centerPoint,t.json){if(38==t.json.result.type&&map.zoomLevel<11)return t.clearListener("md"),t.clearGRMap(),void(n.PoiSearchInst&&(n.PoiSearchInst.clearMarkersInPoi("a"),n.PoiSearchInst.clearArea()));if(t.isableGenUIRequest&&t.isableGRequestByMapChanged){t.mdLabel&&t.mdLabel.hide(),t.mdMarker&&t.mdMarker.hide();t.clearListener(),e||(e="");var i=t.json.result.return_query,a="&c="+modelConfig.cityCode+"&wd="+encodeURIComponent(i)+"&da_src=pcmappg.map&on_gel=1&l="+map.zoomLevel+e;t.json.result.wd2&&(a+="&wd2="+t.json.result.wd2);var r=map.getBounds();switch(a+="&b=("+r.minX+","+r.minY+";"+r.maxX+","+r.maxY+")",t.isableGenUIRequest=!1,t.json.result.type){case 36:n.PoiSearchInst&&(n.PoiSearchInst.clearMarkersInPoi(),n.PoiSearchInst.clearArea()),setTimeout(function(){t.isableGenUIRequest=!0},t.uiPermit),n.place&&(t.queryStr=place.urlArr?"s"+a+place.urlArr:"s"+a),n.currentComponent.modelQuery=t.queryStr,comMgr.go(t.queryStr,{dom:T.G("MapInfo"),cinfo:{genRequestKey:e},isMainRequest:"no"});break;case 37:n.clearClarify&&clearClarify(),setTimeout(function(){t.isableGenUIRequest=!0},t.uiPermit),t.queryStr="s"+a,comMgr.go(t.queryStr,{dom:T.G("MapInfo"),isMainRequest:"no"});break;case 38:var o="";if(n.PoiSearchInst&&(n.PoiSearchInst.clearMarkersInPoi(),n.PoiSearchInst.clearArea()),t.json.center&&t.json.center.poi){o+="&uid="+t.json.center.poi[0].uid;var s=util.getPointByStr(util.parseGeo(t.json.center.poi[0].geo).points);o+="&nb_x="+s.lng,o+="&nb_y="+s.lat}else t.gInfo.cinfo.centerPoint&&(o+="&nb_x="+t.gInfo.cinfo.centerPoint.lng,o+="&nb_y="+t.gInfo.cinfo.centerPoint.lat);t.GRCircleRadius&&(o+="&gr_radius="+t.GRCircleRadius),setTimeout(function(){t.isableGenUIRequest=!0},t.uiPermit),n.currentComponent.modelQuery="nb"+a+o,place.urlArr?t.gInfo.cinfo?comMgr.go("nb"+a+place.urlArr+o,{dom:T.G("MapInfo"),cinfo:t.gInfo.cinfo,isMainRequest:"no"}):comMgr.go("nb"+a+place.urlArr+o,{dom:T.G("MapInfo"),isMainRequest:"no"}):t.gInfo.cinfo?comMgr.go("nb"+a+o,{dom:T.G("MapInfo"),cinfo:t.gInfo.cinfo,isMainRequest:"no"}):comMgr.go("nb"+a+o,{dom:T.G("MapInfo"),isMainRequest:"no"});break;case 39:n.SearchInViewInst&&n.SearchInViewInst.clearMarkersInSiv(),setTimeout(function(){t.isableGenUIRequest=!0},t.uiPermit),n.currentComponent.modelQuery="bd"+a,place.urlArr?comMgr.go("bd"+a+place.urlArr,{dom:T.G("MapInfo"),cinfo:{genRequestKey:e},isMainRequest:"no"}):comMgr.go("bd"+a,{dom:T.G("MapInfo"),cinfo:{genRequestKey:e},isMainRequest:"no"});break;case 40:n.searchInViewCtrl&&n.searchInViewCtrl.clear(),setTimeout(function(){t.isableGenUIRequest=!0},t.uiPermit),comMgr.go("bd"+a,{dom:T.G("MapInfo"),isMainRequest:"no"})}}}},_getCateInfo:function(e){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n][1]),i-1>n&&t.push(", ");return t.join("")},getDataForSnap:function(){if(this.isGRequest&&this.json){var e=this.json.result.return_query||"",t=this.json.result.wd2||"",n="bkg_png",i=modelConfig.cityCode;return{wd:e,wd2:t,qt:n,c:i}}return!1}}),module.exports=GenRequest});